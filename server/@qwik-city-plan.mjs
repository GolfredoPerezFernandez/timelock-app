import{c as V,i as g,u as v,b as ye,d as f,e,f as i,S as Be,g as C,h as b,r as Y,j as z,k as bl,l as s,L as fe,m as we,n as R,o as A,p as B,F as H,z as Q,q as Ce,s as hl,t as xe}from"./q-BbaayOrg.js";import{createClient as Ge}from"@libsql/client";import vl from"path";import dl from"fs";import{readFile as Tt,mkdir as wl,writeFile as We}from"node:fs/promises";import De,{join as Ne}from"node:path";import{randomBytes as kl}from"node:crypto";import{z as y}from"zod";import{DateTime as Et}from"luxon";import{createPublicClient as St,http as Lt}from"viem";import{base as cl}from"viem/chains";const Rt=()=>{const l=v(!1);return ye(f("s_kMIkvtDqkEU",[l])),e("div",null,{class:"min-h-screen flex flex-col items-center justify-center transition-colors duration-300 bg-transparent",style:{paddingTop:"calc(env(safe-area-inset-top))"}},[e("div",null,{class:"fixed inset-0 pointer-events-none overflow-hidden opacity-40"},[e("div",null,{class:"w-20 h-20 bg-teal-500/20 rounded-full absolute top-[10%] left-[15%] animate-[float_15s_infinite]"},null,3,null),e("div",null,{class:"w-32 h-32 bg-slate-500/20 rounded-full absolute top-[30%] left-[65%] animate-[float_18s_infinite]",style:"animation-delay: 0.5s;"},null,3,null),e("div",null,{class:"w-16 h-16 bg-amber-400/20 rounded-full absolute top-[70%] left-[25%] animate-[float_12s_infinite]",style:"animation-delay: 1s;"},null,3,null)],3,null),e("div",null,{class:"pt-safe"},i(Be,null,3,"GY_0"),1,null),e("style",null,null,`
        @keyframes float {
          0% { transform: translate(0, 0); }
          25% { transform: translate(5px, -15px); }
          50% { transform: translate(10px, 0); }
          75% { transform: translate(5px, 15px); }
          100% { transform: translate(0, 0); }
        }
        @keyframes pulse {
          0%, 100% { opacity: 0.5; transform: scale(1); }
          50% { opacity: 1; transform: scale(1.05); }
        }
      `,3,null)],1,"GY_1")},Ct=V(g(Rt,"s_9ToU0mvTu94")),At=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),$=async l=>{var o,u;const t=(o=l.cookie.get("auth_token"))==null?void 0:o.value,a=(u=l.cookie.get("user_type"))==null?void 0:u.value;if(!t||!a)return{isAuthenticated:!1,userId:null,role:null,is_admin:!1};let n=!1,r=a;try{const m=await Ge({url:l.env.get("PRIVATE_TURSO_DATABASE_URL"),authToken:l.env.get("PRIVATE_TURSO_AUTH_TOKEN")}).execute({sql:"SELECT email, type FROM users WHERE id = ?",args:[t]});if(m.rows.length===0)return Xe(l),{isAuthenticated:!1,userId:null,role:null,is_admin:!1};m.rows[0].email==="admin@gmail.com"?(n=!0,r="admin"):(n=!1,(a==="admin"||a==="super_admin")&&(r="freelancer"))}catch(d){return console.error("Session validation DB error:",d),{isAuthenticated:!1,userId:null,role:null,is_admin:!1}}return{isAuthenticated:!0,userId:t,role:r,is_admin:n}};function yl(l){return new TextEncoder().encode(l).buffer}function Te(l){return Array.from(new Uint8Array(l)).map(t=>t.toString(16).padStart(2,"0")).join("")}async function It(l){const t=yl(l),a=crypto.getRandomValues(new Uint8Array(16)),n=await crypto.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]),r=await crypto.subtle.deriveBits({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},n,256),o=new Uint8Array(a.length+32);o.set(a),o.set(new Uint8Array(r),a.length);const u=Te(o.buffer);return console.log("[hashPassword] password:",l),console.log("[hashPassword] salt:",Te(a.buffer)),console.log("[hashPassword] derivedKey:",Te(r)),console.log("[hashPassword] combined hex:",u),u}async function Nt(l,t){const a=new Uint8Array(t.match(/.{1,2}/g).map(h=>parseInt(h,16))),n=a.slice(0,16),r=a.slice(16),o=yl(l),u=await crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits"]),d=await crypto.subtle.deriveBits({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},u,256),m=Te(d),p=Te(r.buffer);return console.log("[verifyPassword] password:",l),console.log("[verifyPassword] salt:",Te(n.buffer)),console.log("[verifyPassword] derivedKey:",m),console.log("[verifyPassword] storedKey:",p),m===p}const _l=(l,t,a)=>{const n=String(t),r={path:"/",httpOnly:!0,sameSite:"strict",secure:l.url.protocol==="https:",maxAge:2592e3};l.cookie.set("auth_token",n,r),l.cookie.set("user_type",a,r)},Xe=l=>{const t={path:"/"};l.cookie.delete("auth_token",t),l.cookie.delete("user_type",t)},Tl=l=>C("svg",{...l,children:[e("circle",null,{cx:"12",cy:"12",r:"10"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"8",y2:"12"},null,3,null),e("line",null,{x1:"12",x2:"12.01",y1:"16",y2:"16"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Ui_0"),se=l=>C("svg",{...l,children:[e("path",null,{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"},null,3,null),e("path",null,{d:"M12 9v4"},null,3,null),e("path",null,{d:"M12 17h.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"zY_0"),ml=l=>C("svg",{...l,children:[e("path",null,{d:"m12 19-7-7 7-7"},null,3,null),e("path",null,{d:"M19 12H5"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"VY_0"),Ae=l=>C("svg",{...l,children:[e("rect",null,{height:"14",rx:"2",ry:"2",width:"20",x:"2",y:"7"},null,3,null),e("path",null,{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"sZ_0"),Mt=l=>C("svg",{...l,children:[e("rect",null,{height:"20",rx:"2",ry:"2",width:"16",x:"4",y:"2"},null,3,null),e("path",null,{d:"M9 22v-4h6v4"},null,3,null),e("path",null,{d:"M8 6h.01"},null,3,null),e("path",null,{d:"M16 6h.01"},null,3,null),e("path",null,{d:"M12 6h.01"},null,3,null),e("path",null,{d:"M12 10h.01"},null,3,null),e("path",null,{d:"M12 14h.01"},null,3,null),e("path",null,{d:"M16 10h.01"},null,3,null),e("path",null,{d:"M16 14h.01"},null,3,null),e("path",null,{d:"M8 10h.01"},null,3,null),e("path",null,{d:"M8 14h.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"t9_0"),Pe=l=>C("svg",{...l,children:[e("rect",null,{height:"18",rx:"2",ry:"2",width:"18",x:"3",y:"4"},null,3,null),e("line",null,{x1:"16",x2:"16",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"8",x2:"8",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"3",x2:"21",y1:"10",y2:"10"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"34_0"),_e=l=>C("svg",{...l,children:[e("path",null,{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,3,null),e("polyline",null,{points:"22 4 12 14.01 9 11.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Jy_0"),Ke=l=>C("svg",{...l,children:e("path",null,{d:"m15 18-6-6 6-6"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"5O_0"),Ve=l=>C("svg",{...l,children:e("path",null,{d:"m9 18 6-6-6-6"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Rc_0"),re=l=>C("svg",{...l,children:[e("circle",null,{cx:"12",cy:"12",r:"10"},null,3,null),e("polyline",null,{points:"12 6 12 12 16 14"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"PM_0"),Dt=l=>C("svg",{...l,children:[e("rect",null,{height:"14",rx:"2",width:"20",x:"2",y:"5"},null,3,null),e("line",null,{x1:"2",x2:"22",y1:"10",y2:"10"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"UR_0"),Ot=l=>C("svg",{...l,children:[e("line",null,{x1:"12",x2:"12",y1:"2",y2:"22"},null,3,null),e("path",null,{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"0T_0"),El=l=>C("svg",{...l,children:[e("path",null,{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},null,3,null),e("polyline",null,{points:"7 10 12 15 17 10"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"15",y2:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"f4_0"),Sl=l=>C("svg",{...l,children:[e("path",null,{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},null,3,null),e("polyline",null,{points:"15 3 21 3 21 9"},null,3,null),e("line",null,{x1:"10",x2:"21",y1:"14",y2:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Oq_0"),Ie=l=>C("svg",{...l,children:[e("path",null,{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"},null,3,null),e("circle",null,{cx:"12",cy:"12",r:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"jA_0"),me=l=>C("svg",{...l,children:[e("path",null,{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},null,3,null),e("polyline",null,{points:"14 2 14 8 20 8"},null,3,null),e("line",null,{x1:"16",x2:"8",y1:"13",y2:"13"},null,3,null),e("line",null,{x1:"16",x2:"8",y1:"17",y2:"17"},null,3,null),e("line",null,{x1:"10",x2:"8",y1:"9",y2:"9"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"gd_0"),Ll=l=>C("svg",{...l,children:[e("path",null,{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},null,3,null),e("polyline",null,{points:"14 2 14 8 20 8"},null,3,null),e("path",null,{d:"M12 12v6"},null,3,null),e("path",null,{d:"m15 15-3-3-3 3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Wk_0"),Qe=l=>C("svg",{...l,children:e("polygon",null,{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"bo_0"),pl=l=>C("svg",{...l,children:[e("circle",null,{cx:"12",cy:"12",r:"10"},null,3,null),e("path",null,{d:"M12 16v-4"},null,3,null),e("path",null,{d:"M12 8h.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"d1_0"),fl=l=>C("svg",{...l,children:[e("circle",null,{cx:"7.5",cy:"15.5",r:"5.5"},null,3,null),e("path",null,{d:"m21 2-9.6 9.6"},null,3,null),e("path",null,{d:"m15.5 7.5 3 3L22 7l-3-3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Wf_0"),ee=l=>C("svg",{...l,children:e("path",null,{d:"M21 12a9 9 0 1 1-6.219-8.56"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"nT_0"),Oe=l=>C("svg",{...l,children:[e("line",null,{x1:"12",x2:"12",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"18",y2:"22"},null,3,null),e("line",null,{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76"},null,3,null),e("line",null,{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07"},null,3,null),e("line",null,{x1:"2",x2:"6",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"18",x2:"22",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24"},null,3,null),e("line",null,{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"kT_0"),ue=l=>C("svg",{...l,children:[e("rect",null,{height:"11",rx:"2",ry:"2",width:"18",x:"3",y:"11"},null,3,null),e("path",null,{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"WS_0"),Rl=l=>C("svg",{...l,children:[e("path",null,{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},null,3,null),e("polyline",null,{points:"16 17 21 12 16 7"},null,3,null),e("line",null,{x1:"21",x2:"9",y1:"12",y2:"12"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"0h_0"),Ut=l=>C("svg",{...l,children:[e("rect",null,{height:"16",rx:"2",width:"20",x:"2",y:"4"},null,3,null),e("path",null,{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"n4_0"),Pt=l=>C("svg",{...l,children:[e("line",null,{x1:"4",x2:"20",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"4",x2:"20",y1:"6",y2:"6"},null,3,null),e("line",null,{x1:"4",x2:"20",y1:"18",y2:"18"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"f1_0"),jt=l=>C("svg",{...l,children:e("path",null,{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Oe_0"),$t=l=>C("svg",{...l,children:[e("circle",null,{cx:"13.5",cy:"6.5",r:".5"},null,3,null),e("circle",null,{cx:"17.5",cy:"10.5",r:".5"},null,3,null),e("circle",null,{cx:"8.5",cy:"7.5",r:".5"},null,3,null),e("circle",null,{cx:"6.5",cy:"12.5",r:".5"},null,3,null),e("path",null,{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"60_0"),je=l=>C("svg",{...l,children:[e("path",null,{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"},null,3,null),e("path",null,{d:"m15 5 4 4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"eG_0"),Ft=l=>C("svg",{...l,children:[e("path",null,{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},null,3,null),e("path",null,{d:"M22 12A10 10 0 0 0 12 2v10z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"HH_0"),Ee=l=>C("svg",{...l,children:[e("path",null,{d:"M5 12h14"},null,3,null),e("path",null,{d:"M12 5v14"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Z7_0"),qt=l=>C("svg",{...l,children:[e("path",null,{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"},null,3,null),e("path",null,{d:"M3 3v5h5"},null,3,null),e("path",null,{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"},null,3,null),e("path",null,{d:"M16 16h5v5"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"CE_0"),pe=l=>C("svg",{...l,children:[e("path",null,{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,3,null),e("polyline",null,{points:"17 21 17 13 7 13 7 21"},null,3,null),e("polyline",null,{points:"7 3 7 8 15 8"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Jw_0"),Ze=l=>C("svg",{...l,children:[e("circle",null,{cx:"11",cy:"11",r:"8"},null,3,null),e("path",null,{d:"m21 21-4.3-4.3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"OE_0"),Cl=l=>C("svg",{...l,children:[e("path",null,{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"},null,3,null),e("circle",null,{cx:"12",cy:"12",r:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"xG_0"),Bt=l=>C("svg",{...l,children:[e("path",null,{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"},null,3,null),e("path",null,{d:"m9 12 2 2 4-4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"oN_0"),Ht=l=>C("svg",{...l,children:[e("path",null,{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2"},null,3,null),e("path",null,{d:"m2 2 20 20"},null,3,null),e("path",null,{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Ij_0"),Yt=l=>C("svg",{...l,children:[e("circle",null,{cx:"12",cy:"12",r:"4"},null,3,null),e("path",null,{d:"M12 2v2"},null,3,null),e("path",null,{d:"M12 20v2"},null,3,null),e("path",null,{d:"m4.93 4.93 1.41 1.41"},null,3,null),e("path",null,{d:"m17.66 17.66 1.41 1.41"},null,3,null),e("path",null,{d:"M2 12h2"},null,3,null),e("path",null,{d:"M20 12h2"},null,3,null),e("path",null,{d:"m6.34 17.66-1.41 1.41"},null,3,null),e("path",null,{d:"m19.07 4.93-1.41 1.41"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Qm_0"),Al=l=>C("svg",{...l,children:[e("path",null,{d:"M3 6h18"},null,3,null),e("path",null,{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},null,3,null),e("path",null,{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},null,3,null),e("line",null,{x1:"10",x2:"10",y1:"11",y2:"17"},null,3,null),e("line",null,{x1:"14",x2:"14",y1:"11",y2:"17"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Eb_0"),de=l=>C("svg",{...l,children:[e("path",null,{d:"M3 6h18"},null,3,null),e("path",null,{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},null,3,null),e("path",null,{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"St_0"),zt=l=>C("svg",{...l,children:[e("path",null,{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"},null,3,null),e("circle",null,{cx:"12",cy:"7",r:"4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"sX_0"),ge=l=>C("svg",{...l,children:[e("path",null,{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},null,3,null),e("circle",null,{cx:"9",cy:"7",r:"4"},null,3,null),e("path",null,{d:"M22 21v-2a4 4 0 0 0-3-3.87"},null,3,null),e("path",null,{d:"M16 3.13a4 4 0 0 1 0 7.75"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"pI_0"),ke=l=>C("svg",{...l,children:[e("path",null,{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"},null,3,null),e("path",null,{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"},null,3,null),e("path",null,{d:"M18 12a2 2 0 0 0 0 4h4v-4Z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"lt_0"),oe=l=>C("svg",{...l,children:[e("path",null,{d:"M18 6 6 18"},null,3,null),e("path",null,{d:"m6 6 12 12"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"CN_0"),Gt=l=>{const t={xs:{width:24,height:24,text:"text-sm",subtext:"text-xs"},sm:{width:32,height:32,text:"text-lg",subtext:"text-xs"},md:{width:40,height:40,text:"text-xl",subtext:"text-sm"},lg:{width:56,height:56,text:"text-2xl",subtext:"text-base"}},a=l.responsive??!1?{width:"w-6 sm:w-8 md:w-10",height:"h-6 sm:h-8 md:h-10",text:"text-sm sm:text-lg md:text-xl",subtext:"text-xs sm:text-xs md:text-sm"}:null,{width:n,height:r,text:o,subtext:u}=l.responsive??!1?a:t[l.size??"md"];return e("div",null,{class:b(d=>`inline-flex items-center ${d.className??""}`,[l],'`inline-flex items-center ${p0.className??""}`')},[e("div",{style:{width:n,height:r}},null,e("svg",null,{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",class:"w-full h-full"},[e("defs",null,null,e("linearGradient",null,{id:"logoGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",null,{offset:"0%",style:{stopColor:"#0f766e",stopOpacity:1}},null,3,null),e("stop",null,{offset:"50%",style:{stopColor:"#14b8a6",stopOpacity:1}},null,3,null),e("stop",null,{offset:"100%",style:{stopColor:"#5eead4",stopOpacity:1}},null,3,null)],3,null),3,null),e("circle",null,{cx:"50",cy:"50",r:"42",fill:"url(#logoGradient)",stroke:"#0f766e","stroke-width":"2"},null,3,null),e("text",null,{x:"50%",y:"50%","dominant-baseline":"central","text-anchor":"middle","font-family":"'Poppins', sans-serif","font-size":"28","font-weight":"bold",fill:"#ffffff","letter-spacing":"-1"},"STL",3,null)],3,null),3,null),e("div",{class:`ml-2 sm:ml-3 font-bold ${l.responsive??!1?a.text:o} flex flex-col leading-none`},null,[e("span",null,{class:"text-slate-800 dark:text-slate-100"},"Saave",3,null),e("span",{class:`text-teal-600 dark:text-teal-400 ${l.responsive??!1?a.subtext:u}`},null,"TimeLock",3,null)],1,null)],1,"2o_0")},Wt=V(g(Gt,"s_jTI0vSQg3mw")),He=l=>i(Wt,{...l},0,"S3_0"),Xt=async l=>$(l),Il=Y(g(Xt,"s_kPZv5zqFaP4")),Kt=()=>{const[l]=A();l.value=!l.value,l.value?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},Vt=()=>{const[l]=A();l.value=!l.value},Qt=()=>{const[l]=A();return l.value=!1},Zt=()=>{const[l]=A();return l.value=!1},Jt=()=>{const[l]=A();return l.value=!1},es=()=>{z();const l=Il(),t=bl(),a=v(!1),n=v(!1),r=v(!0),o=[...l.value.role==="admin"||l.value.role==="super_admin"?[{name:"Dashboard",href:"/",icon:Ft,description:"Overview of key metrics"},{name:"Professionals",href:"/professionals",icon:ge,description:"Manage professional profiles"},{name:"Contracts",href:"/contracts",icon:Ae,description:"Administer service contracts"},{name:"Invoices",href:"/invoices",icon:me,description:"Track and manage invoices"},{name:"Settlements",href:"/settlements",icon:Ot,description:"Process payment settlements"},{name:"Planner",href:"/planner",icon:Pe,description:"View payment schedules"},{name:"Payment Scheduler",href:"/planner-auto",icon:re,description:"Automate payment schedules"},{name:"Settings",href:"/settings",icon:Cl,description:"Configure application settings"},...l.value.role==="super_admin"?[{name:"User Admin",href:"/user-admin",icon:ge,description:"Manage system users"}]:[]]:[{name:"Contracts",href:"/contracts",icon:Ae,description:"Administer service contracts"},{name:"Invoices",href:"/invoices",icon:me,description:"Track and manage invoices"},{name:"Payment Scheduler",href:"/planner-auto",icon:re,description:"Automate payment schedules"}]],u=l.value.isAuthenticated?{name:"Logout",href:"/auth/logout",icon:Rl,description:"Sign out of your account"}:{name:"Login",href:"/auth",icon:zt,description:"Access your account"};ye(f("s_PXmMQHEJxdA",[a]));const d=g(Kt,"s_gdjDhvPXj4E",[a]),m=g(Vt,"s_B99zaGvTXxk",[r]);return t.url.pathname==="/auth/"?e("main",null,{class:"flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto"},i(Be,null,3,"S3_1"),1,"S3_2"):e("div",null,{class:"flex h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200"},[e("aside",{class:`hidden lg:flex flex-col transition-all duration-300 ease-in-out bg-white dark:bg-slate-800/50 border-r border-slate-200 dark:border-slate-700/50
        ${r.value?"w-64":"w-20"}`},null,[e("div",null,{class:b(p=>`flex items-center h-16 px-4 ${p.value?"justify-between":"justify-center"}`,[r],'`flex items-center h-16 px-4 ${p0.value?"justify-between":"justify-center"}`')},[i(fe,{href:"/",get class(){return`flex items-center gap-2 ${!r.value&&"w-full justify-center"}`},children:[i(He,{className:"w-8 h-8 text-teal-500",[s]:{className:s}},3,"S3_3"),r.value&&e("span",null,{class:"font-bold text-lg"},"SaveeTimelock",3,"S3_4")],[s]:{href:s,class:b(p=>`flex items-center gap-2 ${!p.value&&"w-full justify-center"}`,[r],'`flex items-center gap-2 ${!p0.value&&"w-full justify-center"}`')}},1,"S3_5"),r.value&&e("button",null,{class:"p-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700",onClick$:m},i(Ke,{class:"w-5 h-5",[s]:{class:s}},3,"S3_6"),1,"S3_7")],1,null),!r.value&&e("div",null,{class:"flex justify-center my-2"},e("button",null,{class:"p-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700",onClick$:m},i(Ve,{class:"w-5 h-5",[s]:{class:s}},3,"S3_8"),1,null),1,"S3_9"),e("nav",null,{class:"flex-1 px-2 py-4 space-y-2"},l.value.isAuthenticated&&o.map(p=>{const h=t.url.pathname===p.href||p.href!=="/"&&t.url.pathname.startsWith(p.href);return i(fe,{get href(){return p.href},get title(){return p.name},class:`flex items-center gap-3 rounded-md transition-colors
                ${r.value?"px-3 py-2":"p-3 justify-center"}
                ${h?"bg-teal-500/10 text-teal-500 dark:bg-teal-400/20 dark:text-teal-400":"hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,children:[i(p.icon,{class:"w-5 h-5 shrink-0",[s]:{class:s}},3,"S3_10"),r.value&&e("span",null,{class:"text-sm font-medium"},R(p,"name"),1,"S3_11")],[s]:{href:we(p,"href"),title:we(p,"name")}},1,p.name)}),1,null),e("div",null,{class:"px-2 py-4 mt-auto"},i(fe,{get href(){return u.href},get title(){return u.name},class:`flex items-center gap-3 rounded-md transition-colors
            ${r.value?"px-3 py-2":"p-3 justify-center"}
            hover:bg-slate-100 dark:hover:bg-slate-700/50`,children:[i(u.icon,{class:"w-5 h-5 shrink-0",[s]:{class:s}},3,"S3_12"),r.value&&e("span",null,{class:"text-sm font-medium"},R(u,"name"),1,"S3_13")],[s]:{href:we(u,"href"),title:we(u,"name")}},1,"S3_14"),1,null)],1,null),e("header",null,{class:"lg:hidden fixed top-0 left-0 right-0 z-40 flex items-center justify-between h-16 px-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800"},[e("button",null,{class:"p-2",onClick$:f("s_CqXkyDmMGuc",[n])},i(Pt,{class:"w-6 h-6",[s]:{class:s}},3,"S3_15"),1,null),i(fe,{href:"/",class:"flex items-center gap-2",children:i(He,{className:"w-8 h-8 text-teal-500",[s]:{className:s}},3,"S3_16"),[s]:{href:s,class:s}},1,"S3_17"),e("button",null,{class:"p-2",onClick$:d},a.value?i(Yt,{class:"w-6 h-6",[s]:{class:s}},3,"S3_18"):i(jt,{class:"w-6 h-6",[s]:{class:s}},3,"S3_19"),1,null)],1,null),n.value&&e("div",null,{class:"lg:hidden fixed inset-0 z-50",role:"dialog","aria-modal":"true"},[e("div",null,{class:"fixed inset-0 bg-black/25 backdrop-blur-sm",onClick$:f("s_29h0Cs0YvUk",[n])},null,3,null),e("div",null,{class:"fixed inset-y-0 left-0 w-64 bg-white dark:bg-slate-800 p-4"},[e("div",null,{class:"flex items-center justify-between h-12 mb-4"},[i(fe,{href:"/",class:"flex items-center gap-2",onClick$:g(Qt,"s_Lgh2fELhsxw",[n]),children:e("span",null,{class:"font-bold text-lg"},"SaveeTimelock",3,null),[s]:{href:s,class:s,onClick$:s}},3,"S3_20"),e("button",null,{class:"p-2",onClick$:f("s_tUdpu55U93Q",[n])},i(oe,{class:"w-6 h-6",[s]:{class:s}},3,"S3_21"),1,null)],1,null),e("nav",null,{class:"flex flex-col h-full"},[e("div",null,{class:"flex-1 space-y-2"},l.value.isAuthenticated&&o.map(p=>{const h=t.url.pathname===p.href||p.href!=="/"&&t.url.pathname.startsWith(p.href);return i(fe,{get href(){return p.href},onClick$:g(Zt,"s_rHbc3bvvZ1E",[n]),class:`flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium
                      ${h?"bg-teal-500/10 text-teal-500 dark:bg-teal-400/20 dark:text-teal-400":"hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[i(p.icon,{class:"w-5 h-5",[s]:{class:s}},3,"S3_22"),R(p,"name")],[s]:{href:we(p,"href"),onClick$:s}},1,p.name)}),1,null),e("div",null,{class:"mt-auto"},i(fe,{get href(){return u.href},onClick$:g(Jt,"s_NhVnMTaOGeI",[n]),class:"flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-700",children:[i(u.icon,{class:"w-5 h-5",[s]:{class:s}},3,"S3_23"),R(u,"name")],[s]:{href:we(u,"href"),onClick$:s,class:s}},1,"S3_24"),1,null)],1,null)],1,null)],1,"S3_25"),e("main",null,{class:"flex-1 overflow-y-auto pt-16 lg:pt-0"},e("div",null,{class:"p-4 sm:p-6 lg:p-8"},i(Be,null,3,"S3_26"),1,null),1,null)],1,"S3_27")},ls=V(g(es,"s_7u8M1ps3cz0")),ts=Object.freeze(Object.defineProperty({__proto__:null,Logo:He,default:ls,useAuthSession:Il},Symbol.toStringTag,{value:"Module"}));Ge({url:process.env.PRIVATE_TURSO_DATABASE_URL||"file:./local.db",authToken:process.env.PRIVATE_TURSO_AUTH_TOKEN});function M(l){var n,r;const t=(n=l.env.get("PRIVATE_TURSO_DATABASE_URL"))==null?void 0:n.trim();if(t===void 0)throw new Error("PRIVATE_TURSO_DATABASE_URL is not defined");const a=(r=l.env.get("PRIVATE_TURSO_AUTH_TOKEN"))==null?void 0:r.trim();if(a===void 0&&!t.includes("file:"))throw new Error("PRIVATE_TURSO_AUTH_TOKEN is not defined");return Ge({url:t,authToken:a})}async function ae(l){const t=M(l),a=await t.execute("PRAGMA table_info(professionals);"),n=a.rows.find(u=>u.name==="wallet"),r=a.rows.find(u=>u.name==="user_id");(n&&n.notnull===1||r&&r.notnull===1)&&(await t.execute("BEGIN TRANSACTION;"),await t.execute(`
      CREATE TABLE IF NOT EXISTS professionals_tmp (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER,
        name TEXT NOT NULL,
        role TEXT NOT NULL,
        email TEXT,
        phone TEXT,
        wallet TEXT,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (user_id) REFERENCES users(id)
      );
    `),await t.execute(`
      INSERT INTO professionals_tmp (id, user_id, name, role, email, phone, wallet, created_at)
      SELECT id, user_id, name, role, email, phone, wallet, created_at FROM professionals;
    `),await t.execute("DROP TABLE professionals;"),await t.execute("ALTER TABLE professionals_tmp RENAME TO professionals;"),await t.execute("COMMIT;")),console.log("Running database migrations for users and trees tables..."),await t.execute(`CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    email TEXT NOT NULL UNIQUE,
    password_hash TEXT NOT NULL,
    username TEXT NOT NULL DEFAULT '',
    type TEXT DEFAULT 'normal',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    session_expires DATETIME
  );`);try{await t.execute("ALTER TABLE users ADD COLUMN email TEXT;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}try{await t.execute("ALTER TABLE users ADD COLUMN type TEXT DEFAULT 'normal';")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}try{await t.execute("ALTER TABLE users ADD COLUMN username TEXT NOT NULL DEFAULT '';")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}try{await t.execute("ALTER TABLE users ADD COLUMN session_expires DATETIME;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}await t.execute("CREATE UNIQUE INDEX IF NOT EXISTS idx_users_email ON users(email);"),await t.execute(`CREATE TABLE IF NOT EXISTS professionals (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    role TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await t.execute("ALTER TABLE professionals ADD COLUMN email TEXT;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}try{await t.execute("ALTER TABLE professionals ADD COLUMN phone TEXT;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}try{await t.execute("ALTER TABLE professionals ADD COLUMN wallet TEXT;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}await t.execute(`CREATE TABLE IF NOT EXISTS contracts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    start_date TEXT NOT NULL,
    end_date TEXT NOT NULL,
    status TEXT NOT NULL DEFAULT 'pending',
    contract_pdf_url TEXT,
    contract_url TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await t.execute("ALTER TABLE contracts ADD COLUMN contract_url TEXT;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}await t.execute(`CREATE TABLE IF NOT EXISTS invoices (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    contract_id INTEGER NOT NULL,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    issue_date TEXT NOT NULL,
    paid_date TEXT,
    amount REAL NOT NULL,
    currency TEXT NOT NULL,
    status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
    invoice_url TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (contract_id) REFERENCES contracts(id),
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`),await t.execute(`CREATE TABLE IF NOT EXISTS settlements (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    month INTEGER NOT NULL,
    year INTEGER NOT NULL,
    total_amount REAL NOT NULL,
    total_in_knrt REAL,
    currency TEXT NOT NULL,
    status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
    payment_date TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await t.execute("ALTER TABLE settlements ADD COLUMN total_in_knrt REAL;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}await t.execute(`CREATE TABLE IF NOT EXISTS payments (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      professional_id INTEGER NOT NULL,
      user_id INTEGER NOT NULL,
      invoice_id INTEGER,
      amount REAL NOT NULL,
      currency TEXT NOT NULL,
      status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
      due_date TEXT NOT NULL,
      payment_date TEXT,
      description TEXT,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (professional_id) REFERENCES professionals(id),
      FOREIGN KEY (user_id) REFERENCES users(id),
      FOREIGN KEY (invoice_id) REFERENCES invoices(id)
  );`);try{await t.execute("ALTER TABLE payments ADD COLUMN contract_id INTEGER;")}catch(u){if(!String(u.message).toLowerCase().includes("duplicate column name"))throw u}await t.execute(`CREATE TABLE IF NOT EXISTS timelocks (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      payment_id INTEGER NOT NULL,
      release_timestamp INTEGER NOT NULL,
      status TEXT NOT NULL CHECK(status IN ('pending', 'completed', 'failed')),
      tx_hash TEXT,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (payment_id) REFERENCES payments(id)
  );`),await t.execute("CREATE INDEX IF NOT EXISTS idx_timelocks_payment_id ON timelocks(payment_id);");try{console.log("Verificando la tabla timelocks..."),(await t.execute("SELECT name FROM sqlite_master WHERE type='table' AND name='timelocks';")).rows.length===0?(console.error("⚠️ La tabla timelocks no se creó correctamente. Intentando crearla de nuevo con DROP TABLE..."),await t.execute("DROP TABLE IF EXISTS timelocks;"),await t.execute(`CREATE TABLE IF NOT EXISTS timelocks (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          payment_id INTEGER NOT NULL,
          release_timestamp INTEGER NOT NULL,
          status TEXT NOT NULL CHECK(status IN ('pending', 'completed', 'failed')),
          tx_hash TEXT,
          created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
          updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
      );`),console.log("✅ Tabla timelocks creada correctamente.")):console.log("✅ Tabla timelocks verificada correctamente.")}catch(u){console.error("Error al verificar la tabla timelocks:",u)}await t.execute(`CREATE TABLE IF NOT EXISTS app_settings (
    id INTEGER PRIMARY KEY CHECK (id = 1),
    company_name TEXT NOT NULL DEFAULT 'Mi Empresa',
    company_email TEXT NOT NULL DEFAULT 'info@miempresa.com',
    company_logo_url TEXT,
    invoice_prefix TEXT NOT NULL DEFAULT 'INV-',
    default_currency TEXT NOT NULL DEFAULT 'USD',
    payment_methods TEXT NOT NULL DEFAULT '["bank_transfer","paypal","wise","crypto"]',
    notifications_enabled BOOLEAN NOT NULL DEFAULT 1,
    theme TEXT NOT NULL DEFAULT 'system',
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )`),(await t.execute("SELECT COUNT(*) as count FROM app_settings WHERE id = 1")).rows[0].count===0&&await t.execute("INSERT INTO app_settings (id) VALUES (1)")}const ss=async l=>{const t=await $(l);if(!t.isAuthenticated)throw l.redirect(302,"/auth");return t},Nl=Y(g(ss,"s_euvihm1OmHg")),as=async l=>{var a,n,r,o,u,d;await ae(l);const t=M(l);try{const m=await t.execute("SELECT COUNT(*) as count FROM professionals"),p=await t.execute("SELECT COUNT(*) as count FROM contracts WHERE status = 'active'"),h=await t.execute("SELECT COUNT(*) as count, SUM(amount) as total FROM invoices WHERE status = 'pending'"),w=await t.execute({sql:`
        SELECT COUNT(*) as count 
        FROM payments 
        WHERE status = 'scheduled' AND payment_date BETWEEN date('now') AND date('now', '+7 days')
      `,args:[]}),E=await t.execute("SELECT SUM(total_in_knrt) as total FROM settlements WHERE status = 'paid'"),T=await t.execute({sql:`
        SELECT id, name, role, created_at 
        FROM professionals 
        ORDER BY created_at DESC 
        LIMIT 5
      `,args:[]}),k=await t.execute({sql:`
        SELECT 
          i.id, 
          i.amount, 
          i.currency, 
          i.status, 
          i.issue_date, 
          p.name as professional_name 
        FROM invoices i
        JOIN professionals p ON i.professional_id = p.id
        ORDER BY i.created_at DESC 
        LIMIT 5
      `,args:[]});return{professionals:((a=m.rows[0])==null?void 0:a.count)||0,activeContracts:((n=p.rows[0])==null?void 0:n.count)||0,pendingInvoices:{count:((r=h.rows[0])==null?void 0:r.count)||0,total:((o=h.rows[0])==null?void 0:o.total)||0},upcomingPayments:((u=w.rows[0])==null?void 0:u.count)||0,totalSettled:((d=E.rows[0])==null?void 0:d.total)||0,recentProfessionals:T.rows||[],recentInvoices:k.rows||[]}}catch(m){return console.error("Dashboard data loading error:",m),{professionals:0,activeContracts:0,pendingInvoices:{count:0,total:0},upcomingPayments:0,totalSettled:0,recentProfessionals:[],recentInvoices:[]}}},Ml=Y(g(as,"s_FQa6Zhzh4t0")),ns=(l,t="USD")=>{const a=t==="KNRT",n=a?"USD":t,r=new Intl.NumberFormat("en-US",{style:"currency",currency:n,minimumFractionDigits:2,maximumFractionDigits:2}).format(l);return a?`${r} KNRT`:r},rs=()=>{var r,o;z(),Nl();const l=Ml();bl();const t=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),a=g(ns,"s_W1w5p9RjLGU"),n={totalProfessionals:Number(l.value.professionals)||0,activeContracts:Number(l.value.activeContracts)||0,pendingInvoices:Number((r=l.value.pendingInvoices)==null?void 0:r.count)||0,upcomingPayments:Number(l.value.upcomingPayments)||0,totalSettled:Number(l.value.totalSettled)||0,pendingAmount:Number((o=l.value.pendingInvoices)==null?void 0:o.total)||0};return e("div",null,{class:"min-h-screen bg-white dark:bg-slate-900 flex flex-col"},e("div",null,{class:"container mx-auto px-4 py-8 flex-1 flex flex-col"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},[e("h1",null,{class:"text-2xl md:text-3xl font-bold mb-2 text-slate-800 dark:text-slate-100"},"Dashboard",3,null),e("p",null,{class:"text-sm md:text-base text-slate-500 dark:text-slate-400"},t,1,null)],1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Professionals",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},R(n,"totalProfessionals"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center text-slate-700 dark:text-slate-300 shadow-sm"},i(ge,{class:"w-6 h-6",[s]:{class:s}},3,"Pz_0"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Active Contracts",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},R(n,"activeContracts"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-teal-100 to-teal-200 dark:from-teal-800/30 dark:to-teal-700/30 flex items-center justify-center text-teal-600 dark:text-teal-400 shadow-sm"},i(Ae,{class:"w-6 h-6",[s]:{class:s}},3,"Pz_1"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Invoices",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},R(n,"pendingInvoices"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-100 to-amber-200 dark:from-amber-800/30 dark:to-amber-700/30 flex items-center justify-center text-amber-600 dark:text-amber-400 shadow-sm"},i(me,{class:"w-6 h-6",[s]:{class:s}},3,"Pz_2"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Upcoming Payments",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},R(n,"upcomingPayments"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-100 to-indigo-200 dark:from-indigo-800/30 dark:to-indigo-700/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400 shadow-sm"},i(re,{class:"w-6 h-6",[s]:{class:s}},3,"Pz_3"),1,null)],1,null),1,null)],1,null),e("div",null,{class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"flex justify-between items-center mb-4"},e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Financial Summary",3,null),3,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Settled",3,null),e("div",null,{class:"flex items-center mt-2"},e("span",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-100"},a(n.totalSettled,"KNRT"),1,null),1,null)],1,null),e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Amount",3,null),e("div",null,{class:"flex items-center mt-2"},e("span",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-100"},a(n.pendingAmount,"KNRT"),1,null),1,null)],1,null)],1,null),e("div",null,{class:"mt-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700/50 dark:to-slate-800/50 rounded-lg h-48 flex items-center justify-center shadow-elegant-sm"},e("p",null,{class:"text-slate-500 dark:text-slate-400 text-sm font-medium"},"Monthly payments chart",3,null),3,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"flex justify-between items-center mb-4"},e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Recent Professionals",3,null),3,null),e("div",null,{class:"space-y-4"},l.value.recentProfessionals.length>0?l.value.recentProfessionals.map(u=>e("div",null,{class:"flex items-center p-2 hover:bg-slate-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors"},[e("div",null,{class:"w-10 h-10 rounded-full bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center text-slate-700 dark:text-slate-300 shadow-sm"},u.name.charAt(0).toUpperCase(),1,null),e("div",null,{class:"ml-3"},[e("p",null,{class:"font-medium text-sm text-slate-800 dark:text-slate-200"},R(u,"name"),1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400"},R(u,"role"),1,null)],1,null)],1,u.id)):e("div",null,{class:"text-center py-6 text-slate-500 dark:text-slate-400"},[e("div",null,{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-3"},i(ge,{class:"w-6 h-6 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"Pz_4"),1,null),e("p",null,null,"No professionals registered",3,null)],1,"Pz_5"),1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant border border-slate-100 dark:border-slate-700 overflow-hidden"},[e("div",null,{class:"p-6"},e("h2",null,{class:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-100"},"Recent Invoices",3,null),3,null),e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"w-full"},[e("thead",null,null,e("tr",null,{class:"text-left bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800"},[e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Date",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Amount",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null)],3,null),3,null),e("tbody",null,{class:"divide-y divide-gray-200 dark:divide-gray-700"},l.value.recentInvoices.length>0?l.value.recentInvoices.map(u=>e("tr",null,null,[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},R(u,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},new Date(u.issue_date).toLocaleDateString(),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm"},[new Intl.NumberFormat("es-ES",{style:"currency",currency:u.currency==="KNRT"?"USD":u.currency}).format(u.amount)," ",u.currency==="KNRT"?"KNRT":""],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${u.status==="paid"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"}`},null,u.status==="paid"?"Pagado":"Pendiente",1,null),1,null)],1,u.id)):e("tr",null,null,e("td",null,{colSpan:4,class:"px-6 py-8 text-center text-sm text-slate-500 dark:text-slate-400"},[e("div",null,{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-3"},i(me,{class:"w-6 h-6 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"Pz_6"),1,null),e("p",null,null,"No recent invoices",3,null)],1,null),1,"Pz_7"),1,null)],1,null),1,null)],1,null)],1,null),1,"Pz_8")},os=V(g(rs,"s_G4PaHCacZj0")),us=Object.freeze(Object.defineProperty({__proto__:null,default:os,useAuthLoader:Nl,useDashboardDataLoader:Ml},Symbol.toStringTag,{value:"Module"})),is=vl.join(process.cwd(),"private_uploads"),ds=async l=>{const{params:t,redirect:a,headers:n,error:r}=l;if(!(await $(l)).isAuthenticated)throw a(303,"/auth");const u=t.fileName;if(!u||u.includes("..")||u.includes("/"))throw r(400,"Invalid filename");const d=vl.join(is,u);try{await dl.promises.access(d)}catch{throw r(404,"File not found")}try{const m=await dl.promises.readFile(d);n.set("Content-Type","application/pdf"),n.set("Content-Length",m.length.toString()),n.set("Content-Disposition",`inline; filename="${u}"`),l.send(new Response(m));return}catch(m){throw console.error("Failed to read file:",m),r(500,"Could not read file")}},cs=Object.freeze(Object.defineProperty({__proto__:null,onGet:ds},Symbol.toStringTag,{value:"Module"})),ms=Ne(process.cwd(),"private_uploads","invoices"),ps=async l=>{var o;const{params:t,error:a,headers:n}=l;if(!(await $(l)).isAuthenticated)throw a(401,"Unauthorized");try{const u=t.fileName;if(u.includes("..")||u.includes("/"))throw a(400,"Invalid file name");const d=Ne(ms,u),m=await Tt(d),p=(o=u.split(".").pop())==null?void 0:o.toLowerCase();let h="application/octet-stream";p==="pdf"?h="application/pdf":["png","jpg","jpeg","gif","webp"].includes(p||"")&&(h=`image/${p}`),n.set("Content-Type",h),n.set("Content-Length",m.length.toString()),n.set("Content-Disposition",`inline; filename="${u}"`);const w=new Response(new Uint8Array(m),{headers:n});l.send(w)}catch(u){throw console.error("File serving failed:",u),a(404,"File not found")}},fs=Object.freeze(Object.defineProperty({__proto__:null,onGet:ps},Symbol.toStringTag,{value:"Module"})),xs=async l=>{const{json:t,error:a}=l;if(!(await $(l)).isAuthenticated)throw a(401,"Unauthorized");try{const o=(await l.request.formData()).get("contract");if(!o)throw a(400,"No file uploaded.");if(o.type!=="application/pdf")throw a(400,"Only PDF files are allowed.");const u=kl(8).toString("hex"),d=De.extname(o.name)||".pdf",m=`${De.basename(o.name,d)}-${Date.now()}-${u}${d}`,p=De.join(process.cwd(),"private_uploads");await wl(p,{recursive:!0});const h=De.join(p,m),w=Buffer.from(await o.arrayBuffer());await We(h,w),t(200,{success:!0,fileName:m})}catch(r){throw console.error("File upload error:",r),r.status?r:a(500,"An unexpected error occurred during file upload.")}},gs=Object.freeze(Object.defineProperty({__proto__:null,onPost:xs},Symbol.toStringTag,{value:"Module"})),bs=async l=>{const a=(await l.request.formData()).get("file");if(!a||typeof a=="string"){l.json(400,{error:"No file uploaded"});return}const n=await a.arrayBuffer(),r=Buffer.from(n),o=a.type.split("/")[1]||"jpg",u=`tree-${Date.now()}-${Math.random().toString(36).slice(2,8)}.${o}`,d=Ne(process.cwd(),"public","uploads",u);await We(d,r),l.json(200,{url:`/uploads/${u}`})},hs=Object.freeze(Object.defineProperty({__proto__:null,onPost:bs},Symbol.toStringTag,{value:"Module"})),xl=Ne(process.cwd(),"private_uploads","invoices"),vs=async l=>{const{request:t,error:a,json:n}=l;if(!(await $(l)).isAuthenticated){n(401,{success:!1,error:"Unauthorized"});return}try{await wl(xl,{recursive:!0});const u=(await t.formData()).get("file");if(!u){n(400,{success:!1,error:"File not provided"});return}if(!u.type.startsWith("application/pdf")&&!u.type.startsWith("image/")){n(400,{success:!1,error:"Invalid file type. Only PDF and images are allowed."});return}if(u.size>10485760){n(400,{success:!1,error:"File is too large. Max size is 10MB."});return}const d=Buffer.from(await u.arrayBuffer()),m=`${Date.now()}-${kl(6).toString("hex")}`,p=u.name.split(".").pop()||"file",h=`invoice-${m}.${p}`,w=Ne(xl,h);await We(w,d),n(200,{success:!0,fileName:h});return}catch(o){console.error("File upload failed:",o),n(500,{success:!1,error:`Upload failed: ${o.message||"Unknown error"}`});return}},ws=Object.freeze(Object.defineProperty({__proto__:null,onPost:vs},Symbol.toStringTag,{value:"Module"})),ks=({cookie:l,redirect:t})=>{throw l.delete("auth_token",{path:"/"}),l.delete("user_type",{path:"/"}),t(302,"/auth")},ys=async(l,t)=>{try{console.log("[LOGOUT] Starting logout process"),Xe(t),await new Promise(r=>setTimeout(r,100));const a=t.cookie.get("auth_token"),n=t.cookie.get("user_type");if(a||n)throw console.error("[LOGOUT] Cookies not cleared properly:",{authToken:a,userType:n}),new Error("Failed to clear authentication cookies");return console.log("[LOGOUT] Successfully cleared all cookies"),t.redirect(302,"/auth"),{success:!0}}catch(a){return console.error("Logout error:",a),{success:!1,error:a instanceof Error?a.message:"Logout failed"}}},Dl=B(g(ys,"s_lYyU40i0tiI")),_s=()=>{var a,n;z();const l=Dl(),t=((a=l.value)==null?void 0:a.success)===!1;return e("div",null,{class:"min-h-screen w-full flex items-center justify-center transition-colors duration-300 bg-gradient-to-b from-blue-50 to-indigo-100 dark:from-gray-950 dark:to-blue-950 py-6 px-4 sm:px-6 lg:px-8 overflow-hidden relative"},[e("div",null,{class:"fixed inset-0 pointer-events-none overflow-hidden"},[e("div",null,{class:"w-20 h-20 bg-blue-500/10 rounded-full absolute top-[10%] left-[15%] animate-[float_15s_infinite]"},null,3,null),e("div",null,{class:"w-32 h-32 bg-indigo-500/10 rounded-full absolute top-[30%] left-[65%] animate-[float_18s_infinite]",style:"animation-delay: 0.5s;"},null,3,null),e("div",null,{class:"w-16 h-16 bg-teal-500/10 rounded-full absolute top-[70%] left-[25%] animate-[float_12s_infinite]",style:"animation-delay: 1s;"},null,3,null)],3,null),e("div",null,{class:"absolute top-6 left-1/2 transform -translate-x-1/2"},e("div",null,{class:"flex items-center"},[e("div",null,{class:"relative"},e("div",null,{class:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white shadow-lg"},e("svg",null,{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},e("path",null,{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9 9 10.5-3m0 6.553v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 1 1-.99-3.467l2.31-.66a2.25 2.25 0 0 0 1.632-2.163Zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 0 1-.99-3.467l2.31-.66A2.25 2.25 0 0 0 9 15.553Z"},null,3,null),3,null),3,null),3,null),e("h1",null,{class:"ml-2 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400"},"Move On Challenge",3,null)],3,null),3,null),e("div",null,{class:"max-w-md w-full z-10"},[e("div",null,{class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden backdrop-blur-sm p-8 animate-[fade-in_0.5s_ease-out]"},[e("div",null,{class:"text-center mb-8"},[e("h2",null,{class:"text-3xl font-bold mb-3 text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400"},"Log Out",3,null),e("p",null,{class:"text-gray-600 dark:text-gray-400"},"Are you sure you want to log out?",3,null)],3,null),i(H,{action:l,class:"space-y-6",spaReset:!0,get"preventdefault:submit"(){return l.isRunning},children:[e("button",null,{type:"submit",disabled:b(r=>r.isRunning,[l],"p0.isRunning"),class:"w-full flex justify-center items-center py-3 px-4 rounded-xl text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 dark:from-blue-500 dark:to-indigo-500 dark:hover:from-blue-600 dark:hover:to-indigo-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},l.isRunning?e("span",null,{class:"flex items-center"},[i(Oe,{class:"animate-spin mr-2 h-5 w-5",[s]:{class:s}},3,"6d_0"),"Logging out..."],1,"6d_1"):e("span",null,{class:"flex items-center"},[i(Rl,{class:"mr-2 h-5 w-5",[s]:{class:s}},3,"6d_2"),"Confirm Logout"],1,null),1,null),t&&e("div",null,{class:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm mt-4"},[e("p",null,null,"There was a problem logging you out. Please try again.",3,null),((n=l.value)==null?void 0:n.error)&&e("p",null,{class:"mt-1 text-xs opacity-80"},b(r=>r.value.error,[l],"p0.value.error"),3,"6d_3")],1,"6d_4"),e("a",null,{href:"/challenges",class:"block w-full text-center mt-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors duration-200"},"Cancel",3,null)],[s]:{action:s,class:s,spaReset:s,"preventdefault:submit":b(r=>r.isRunning,[l],"p0.isRunning")}},1,"6d_5")],1,null),e("div",null,{class:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400"},"Thank you for using Move On Challenge",3,null)],1,null),e("style",null,null,`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes float {
          0% { transform: translate(0, 0); }
          25% { transform: translate(5px, -15px); }
          50% { transform: translate(10px, 0); }
          75% { transform: translate(5px, 15px); }
          100% { transform: translate(0, 0); }
        }
        
        @keyframes fade-in {
          0% { opacity: 0; }
          100% { opacity: 1; }
        }
      `,3,null)],1,"6d_6")},Ts=V(g(_s,"s_zqPwfW3jn0I")),Es=Object.freeze(Object.defineProperty({__proto__:null,default:Ts,onGet:ks,useLogout:Dl},Symbol.toStringTag,{value:"Module"})),Ss=async(l,t)=>{try{return console.log("[LOGOUT] Starting logout process"),Xe(t),t.redirect(302,"/auth"),{success:!0}}catch(a){return console.error("Logout error:",a),{success:!1,error:a instanceof Error?a.message:"Logout failed"}}},Ls=B(g(Ss,"s_uyYPcWOxv4U")),Rs=async(l,t)=>{const a=M(t),{email:n}=l;try{return{success:!0,isRegistered:(await a.execute({sql:"SELECT id FROM users WHERE email = ?",args:[n]})).rows.length>0}}catch(r){return console.error("Email check error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to check email"}}},Ol=B(g(Rs,"s_DmU9OP9DRTo")),Cs=async(l,t)=>{const a=M(t),{email:n,password:r,username:o}=l;try{const u=await It(r),m=(await a.execute({sql:"SELECT COUNT(*) as count FROM users",args:[]})).rows[0].count===0,p=n==="golfredo.pf@gmail.com"||m?"admin":"freelancer";let h;if(h=(await a.execute({sql:"INSERT INTO users (email, password_hash, type, username) VALUES (?, ?, ?, ?)",args:[n,u,p,o||n.split("@")[0]]})).lastInsertRowid,!h)throw new Error("Registration failed: userId is undefined");return _l(t,h,p),t.redirect(302,"/"),{success:!0}}catch(u){return console.error("Registration error:",u),{success:!1,error:u instanceof Error?u.message:"Registration failed"}}},Ul=B(g(Cs,"s_ifiWVdoZ0cQ")),As=async l=>(await ae(l),{success:!0}),Ye=Y(g(As,"s_0gRwIEUvq0E")),Is=async(l,t)=>{const a=M(t),{email:n,password:r}=l;try{console.log("[LOGIN] Intentando login para email:",n);const o=await a.execute({sql:"SELECT * FROM users WHERE email = ?",args:[n]});console.log("[LOGIN] Resultado de búsqueda en DB:",o.rows);const u=o.rows[0];if(!u)return console.error("[LOGIN] Usuario no encontrado para email:",n),{success:!1,error:"Usuario no encontrado"};if(typeof u.password_hash!="string")return console.error("[LOGIN] password_hash inválido:",u.password_hash),{success:!1,error:"password_hash inválido"};if(!u.id)return console.error("[LOGIN] user.id inválido:",u.id),{success:!1,error:"user.id inválido"};console.log("[LOGIN] password ingresada:",r),console.log("[LOGIN] hash guardado:",u.password_hash);const d=await Nt(r,u.password_hash);if(console.log("[LOGIN] resultado de verifyPassword:",d),!d)return console.error("[LOGIN] Contraseña incorrecta para email:",n),{success:!1,error:"Contraseña incorrecta"};const m=String(u.id);try{await a.execute({sql:"UPDATE users SET session_expires = ? WHERE id = ?",args:[new Date(Date.now()+36e5),m]}),console.log("[LOGIN] session_expires actualizado para user:",m)}catch(h){console.error("[LOGIN] Error actualizando session_expires:",h)}const p=u.type==="admin"?"admin":u.type==="super_admin"?"super_admin":"freelancer";return _l(t,m,p),console.log("[LOGIN] Cookies seteadas para user:",m,p),t.redirect(302,"/"),{success:!0}}catch(o){return console.error("[LOGIN] Error general en login:",o),{success:!1,error:"Login failed"}}},Pl=B(g(Is,"s_YXIc7hgvWuM")),Ns=async()=>{var o,u;const[l,t,a,n,r]=A();n.value=!0,a.value="",await new Promise(d=>setTimeout(d,500)),(o=l.value)!=null&&o.success?(r.value=l.value.isRegistered?"password":"register",t.value=document.getElementById("email").value):a.value=((u=l.value)==null?void 0:u.error)||"Failed to check email",n.value=!1},Ms=async()=>{var n,r;const[l,t,a]=A();t.value=!0,l.value="",await new Promise(o=>setTimeout(o,500)),(n=a.value)!=null&&n.success||(l.value=((r=a.value)==null?void 0:r.error)||"Login failed"),t.value=!1},Ds=async()=>{var n,r;const[l,t,a]=A();t.value=!0,l.value="",await new Promise(o=>setTimeout(o,500)),(n=a.value)!=null&&n.success||(l.value=((r=a.value)==null?void 0:r.error)||"Registration failed"),t.value=!1},Os=()=>{var p;z(),Ye();const l=Ye(),t=Ol(),a=Ul(),n=Pl(),r=v("email"),o=v(""),u=v(""),d=v(""),m=v(!1);return(p=l.value)!=null&&p.success&&console.log("Tables initialized successfully"),e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex flex-col items-center justify-center"},[e("header",null,{class:"w-full flex flex-col items-center py-8 mb-2"},[e("h1",null,{class:"text-3xl md:text-4xl font-extrabold text-slate-700 dark:text-teal-400 mb-2 flex items-center gap-2 animate-slide-down"},[e("span",null,{role:"img","aria-label":"clock"},"⏱️",3,null)," Welcome to SaveeTimelock"],3,null),e("p",null,{class:"text-center text-lg text-slate-600 dark:text-slate-300 max-w-2xl animate-fade-in"},"Sign in or register to start tracking your time and managing your projects.",3,null)],3,null),e("section",null,{class:"w-full flex flex-col items-center"},e("div",null,{class:"w-full max-w-md rounded-3xl overflow-hidden shadow-2xl bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-2 md:p-6 animate-grow-in transition-transform duration-700"},[r.value==="email"&&i(H,{action:t,class:"space-y-6",onSubmit$:g(Ns,"s_xydvnoO3NQo",[t,o,d,m,r]),children:[e("div",null,{class:"space-y-2"},[e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Email address",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},i(Ut,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"eD_0"),1,null),e("input",null,{id:"email",name:"email",type:"email",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"your@email.com"},null,3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"},"We'll check if you already have an account",3,null)],1,null),e("button",null,{type:"submit",disabled:b(h=>h.value,[m],"p0.value"),class:"w-full flex justify-center items-center py-3 px-4 rounded-xl text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[i(Oe,{class:"animate-spin mr-2 h-5 w-5 text-white",[s]:{class:s}},3,"eD_1"),"Verifying..."],1,"eD_2"):"Continue",1,null)],[s]:{action:s,class:s,onSubmit$:s}},1,"eD_3"),r.value==="password"&&i(H,{action:n,class:"space-y-6",onSubmit$:g(Ms,"s_90k8QQrQSdk",[d,m,n]),children:[e("input",null,{type:"hidden",name:"email",value:b(h=>h.value,[o],"p0.value")},null,3,null),e("div",null,{class:"space-y-2"},[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Password",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},i(ue,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"eD_4"),1,null),e("input",null,{id:"password",name:"password",type:"password",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"••••••••"},null,3,null)],1,null)],1,null),e("div",null,{class:"flex justify-between items-center"},[e("button",null,{type:"button",class:"flex items-center px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all duration-200 text-sm",onClick$:f("s_SkMVgm4N03A",[d,u,r])},[i(ml,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"eD_5"),"Back"],1,null),e("button",null,{type:"submit",disabled:b(h=>h.value,[m],"p0.value"),class:"flex justify-center items-center py-2 px-6 rounded-lg text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[i(Oe,{class:"animate-spin mr-2 h-5 w-5 text-white",[s]:{class:s}},3,"eD_6"),"Signing in..."],1,"eD_7"):"Sign in",1,null)],1,null)],[s]:{action:s,class:s,onSubmit$:s}},1,"eD_8"),r.value==="register"&&i(H,{action:a,class:"space-y-6",onSubmit$:g(Ds,"s_3ewRqCLfpMg",[d,m,a]),children:[e("input",null,{type:"hidden",name:"email",value:b(h=>h.value,[o],"p0.value")},null,3,null),e("div",null,{class:"space-y-2"},[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Create a password",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},i(ue,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"eD_9"),1,null),e("input",null,{id:"password",name:"password",type:"password",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"••••••••",minLength:6},null,3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"},"Password must be at least 6 characters",3,null)],1,null),e("div",null,{class:"flex justify-between items-center"},[e("button",null,{type:"button",class:"flex items-center px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all duration-200 text-sm",onClick$:f("s_sFCb2F6Zv7w",[d,u,r])},[i(ml,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"eD_10"),"Back"],1,null),e("button",null,{type:"submit",disabled:b(h=>h.value,[m],"p0.value"),class:"flex justify-center items-center py-2 px-6 rounded-lg text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[i(Oe,{class:"animate-spin mr-2 h-5 w-5 text-white",[s]:{class:s}},3,"eD_11"),"Creating account..."],1,"eD_12"):"Create account",1,null)],1,null)],[s]:{action:s,class:s,onSubmit$:s}},1,"eD_13"),d.value&&e("div",null,{class:"mt-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-800 rounded-xl animate-[slide-up_0.3s_ease-out]"},e("div",null,{class:"flex items-start"},[i(Tl,{class:"h-5 w-5 text-rose-500 dark:text-rose-400 mt-0.5 mr-2 flex-shrink-0",[s]:{class:s}},3,"eD_14"),e("p",null,{class:"text-sm text-rose-600 dark:text-rose-300"},b(h=>h.value,[d],"p0.value"),3,null)],1,null),1,"eD_15")],1,null),1,null),e("div",null,{class:"mt-6 text-center text-sm text-slate-600 dark:text-slate-400"},["By continuing, you agree to our",e("a",null,{href:"#",class:"text-teal-600 hover:text-teal-500 dark:text-teal-400 dark:hover:text-teal-300 ml-1"},"Terms of Service",3,null),e("span",null,{class:"mx-1"},"and",3,null),e("a",null,{href:"#",class:"text-teal-600 hover:text-teal-500 dark:text-teal-400 dark:hover:text-teal-300"},"Privacy Policy",3,null)],3,null),e("style",null,null,`
        .animate-fade-in { animation: fadeIn 1s both; }
        .animate-slide-down { animation: slideDown 0.8s both; }
        .animate-slide-up { animation: slideUp 0.7s both; }
        .animate-grow-in { animation: growIn 1.2s both; }
        .animate-pop { animation: popIn 0.5s both; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-40px); } to { opacity: 1, transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1, transform: translateY(0); } }
        @keyframes growIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1, transform: scale(1); } }
        @keyframes popIn { 0% { transform: scale(0.7); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); } }
      `,3,null)],1,"eD_16")},Us=V(g(Os,"s_86Uj5I0HEKo")),Ps=Object.freeze(Object.defineProperty({__proto__:null,default:Us,useCheckEmail:Ol,useDbInitializer:Ye,useLogin:Pl,useLogout:Ls,useRegister:Ul},Symbol.toStringTag,{value:"Module"}));function be(l){return l?"is_admin"in l&&typeof l.is_admin=="boolean"?l.is_admin:"role"in l&&typeof l.role=="string"?l.role==="admin"||l.role==="super_admin":!1:!1}const js=async l=>{const t=await $(l);if(!t.isAuthenticated)throw l.fail(401,{error:"Unauthorized"});const a=M(l);let n=`SELECT c.id, c.professional_id, p.name as professional_name, c.start_date, c.end_date, c.status, c.contract_url 
    FROM contracts c
    JOIN professionals p ON c.professional_id = p.id`,r=[];if(!be(t)){const u=await a.execute({sql:"SELECT id FROM professionals WHERE user_id = ?",args:[t.userId]});if(!u.rows.length)throw l.fail(403,{error:"No professional profile found for this user."});const d=String(u.rows[0].id);n+=" WHERE c.professional_id = ?",r.push(d),t.professionalId=d}return(await a.execute({sql:n,args:r})).rows},jl=Y(g(js,"s_pOtMp0xpTww")),$s=async l=>(await M(l).execute("SELECT id, name, role FROM professionals")).rows,$l=Y(g($s,"s_f6iI4LuEstI")),Fs=async(l,t)=>{const a=M(t),n=await $(t);if(!n.isAuthenticated||!n.userId)throw t.redirect(303,"/auth");let r=l.professionalId;if(!be(n)){const o=await a.execute({sql:"SELECT id FROM professionals WHERE user_id = ?",args:[n.userId]});if(!o.rows.length)throw t.fail(403,{error:"No professional profile found for this user."});r=String(o.rows[0].id)}try{return await a.execute({sql:"INSERT INTO contracts (professional_id, user_id, start_date, end_date, status, contract_url) VALUES (?, ?, ?, ?, ?, ?)",args:[r||"",n.userId,l.startDate,l.endDate,"active",l.contractUrl??null]}),{success:!0}}catch(o){return console.error("Failed to create contract:",o),{success:!1,error:"Failed to create contract."}}},qs=l=>l.object({professionalId:l.string().optional(),startDate:l.string().min(1,"Start date is required."),endDate:l.string().min(1,"End date is required."),contractUrl:l.string().optional().nullable()}),Fl=B(g(Fs,"s_LIYrlyegNzI"),Q(g(qs,"s_JXXcjSD3j1E"))),Bs=({track:l})=>{const[t,a]=A();l(()=>t.value),a.value=t.value},Hs=()=>{const[l,t,a,n,r,o,u,d]=A();o.value="",u.value="",a.value="",t.value=null,l.value="",r.value=!1,d.value="",n.value&&(n.value.value="")},Ys=async l=>{const[t,a,n,r]=A(),o=l.target;if(!o.files||o.files.length===0)return;const u=o.files[0];if(u.type!=="application/pdf"){r.value="Only PDF files are allowed.";return}n.value=!0,r.value="";const d=new FormData;d.append("contract",u);try{const m=await fetch("/api/upload-contract",{method:"POST",body:d});if(!m.ok){const h=await m.json();throw new Error(h.error||"Upload failed")}const p=await m.json();a.value=p.fileName,t.value=`/api/contracts/view/${p.fileName}`}catch(m){r.value=m.message||"An unexpected error occurred.",a.value=null,t.value=""}finally{n.value=!1}},zs=()=>{const[l,t,a]=A();if(!a.value){t.value=l.value;return}const n=a.value.toLowerCase();t.value=l.value.filter(r=>r.professional_name.toLowerCase().includes(n)||r.id.toString().includes(n))},Gs=()=>{const[l,t]=A();t.value=!1,l()},Ws=()=>{var q;z();const l=jl(),t=$l(),a=Fl();typeof window<"u"||(l==null||l.session);const n=l.value.length>0&&be&&be(l.value[0]);let r=null;!n&&l.value.length>0&&(r=String(l.value[0].professional_id)),typeof window<"u"&&(console.log("[DEBUG contracts] isAdminUser:",n),console.log("[DEBUG contracts] userProfessionalId:",r),console.log("[DEBUG contracts] contracts.value:",l.value),console.log("[DEBUG contracts] professionals.value:",t.value));const o=v(""),u=v(!1),d=v(""),m=v(""),p=v(""),h=v(null),w=v(""),E=v(!1),T=v(""),k=v(),L=v([]);Ce(g(Bs,"s_vbBz20uaL9Q",[l,L]));const D=g(Hs,"s_g0LwifoYHg8",[w,h,p,k,E,d,m,T]),N=g(Ys,"s_cm8OO2jiQek",[w,h,E,T]),O=g(zs,"s_NFp6Cx4K5Yc",[l,L,o]),U=S=>{if(!S)return"N/A";const x=new Date(S),P=x.getTimezoneOffset()*6e4;return new Date(x.getTime()+P).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(Ae,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"d3_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Contracts",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage contracts with professionals",3,null)],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3"},[(n||r)&&e("button",{onClick$:f("s_3D44dgnfvmk",[n,u,r])},{class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[i(Ee,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"d3_1"),"Create Contract"],0,"d3_2"),e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[i(El,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"d3_3"),"Export"],1,null)],1,null)],1,null),1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i(Ze,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"d3_4"),1,null),e("input",null,{type:"text",value:o,class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by professional or ID...",onInput$:f("s_fr6YtxdVoQM",[o]),onInput$:O},null,3,null)],1,null),e("div",null,{class:"flex-shrink-0"},e("button",null,{class:"inline-flex items-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[i(Qe,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"d3_5"),"Filter"],1,null),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"ID",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Start Date",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"End Date",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},L.value.map(S=>z(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-700 dark:text-slate-200 group-hover:text-teal-600 dark:group-hover:text-teal-500"},["#CONT-",S.id.toString().padStart(3,"0")],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 dark:text-slate-200 font-medium"},R(S,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},U(S.start_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},U(S.end_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${S.status==="active"?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-rose-50 to-rose-100 text-rose-700 dark:from-rose-900/30 dark:to-rose-800/30 dark:text-rose-400"}`},null,S.status.charAt(0).toUpperCase()+S.status.slice(1),1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[S.contract_url?e("a",{href:`/api/contracts/view/${S.contract_url}`},{target:"_blank",rel:"noopener noreferrer",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all",title:"View Contract"},i(Ie,{class:"h-5 w-5",[s]:{class:s}},3,"d3_6"),1,"d3_7"):e("button",null,{class:"p-1.5 text-slate-400 dark:text-slate-600 rounded-full transition-all cursor-not-allowed",disabled:!0,title:"No contract uploaded"},i(Ie,{class:"h-5 w-5",[s]:{class:s}},3,"d3_8"),1,null),e("button",null,{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:text-indigo-400 dark:hover:bg-indigo-900/20 rounded-full transition-all"},i(me,{class:"h-5 w-5",[s]:{class:s}},3,"d3_9"),1,null)],1,null),1,null)],1,S.id))),1,null)],1,null),1,null),L.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},[e("div",null,{class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-4"},i(Ae,{class:"w-8 h-8 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"d3_10"),1,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No contracts found.",3,null),e("p",null,{class:"text-slate-400 dark:text-slate-500 mt-1 text-sm"},"Create a new contract to get started.",3,null)],1,"d3_11")],1,null),e("div",null,{class:"flex items-center justify-between mt-6 bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-slate-100 dark:border-slate-700"},e("div",null,{class:"text-sm text-slate-600 dark:text-slate-400"},["Showing ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(S=>S.value.length,[L],"p0.value.length"),3,null)," of ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(S=>S.value.length,[l],"p0.value.length"),3,null)," contracts"],3,null),3,null)],1,null),u.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_vbDtEMOt8dg",[u])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:a,onSubmitCompleted$:g(Gs,"s_wxLSoFiDGro",[D,u]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},e("div",null,{class:"sm:flex sm:items-start"},e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Create New Contract",3,null),e("div",null,{class:"mt-4"},e("div",null,{class:"space-y-4"},[n?e("div",null,null,[e("label",null,{for:"professional",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Professional",3,null),e("select",null,{name:"professionalId",id:"professional",value:d,class:"mt-1 block w-full pl-3 pr-10 py-3 text-base border border-slate-300 dark:border-slate-600 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 shadow-sm transition-all",required:!0,onInput$:f("s_K0awB0bLaxM",[d])},[e("option",null,{value:""},"Select a professional",3,null),t.value.map(S=>e("option",{value:R(S,"id")},null,`${S.name} - ${S.role}`,1,`prof-${S.id}`))],1,null)],1,"d3_12"):e("input",{value:r??""},{type:"hidden",name:"professionalId"},null,3,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"start-date",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Start Date",3,null),e("input",null,{type:"date",name:"startDate",id:"start-date",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:f("s_MJ0xPQa0QLc",[m])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"end-date",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"End Date",3,null),e("input",null,{type:"date",name:"endDate",id:"end-date",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:f("s_PFNm876R0OE",[p])},null,3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Contract PDF",3,null),w.value?e("div",null,{class:"mt-2"},[e("div",null,{class:"relative h-64 w-full rounded-lg border border-slate-300 dark:border-slate-600 overflow-hidden group"},[e("iframe",null,{src:b(S=>S.value,[w],"p0.value"),class:"h-full w-full",title:"Contract Preview"},null,3,null),e("a",null,{href:b(S=>S.value,[w],"p0.value"),target:"_blank",rel:"noopener noreferrer",class:"absolute top-2 right-2 p-2 bg-slate-700/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Open in new tab"},i(Sl,{class:"h-5 w-5",[s]:{class:s}},3,"d3_13"),1,null)],1,null),e("button",null,{type:"button",class:"mt-2 inline-flex items-center text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400",onClick$:f("s_QAjq0gRc9qQ",[w,h,k])},[i(Al,{class:"mr-1.5 h-4 w-4",[s]:{class:s}},3,"d3_14"),"Remove PDF"],1,null)],1,"d3_15"):e("div",null,{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 dark:border-slate-600 border-dashed rounded-lg"},e("div",null,{class:"space-y-1 text-center"},[E.value?i(ee,{class:"mx-auto h-12 w-12 text-slate-400 animate-spin",[s]:{class:s}},3,"d3_16"):i(Ll,{class:"mx-auto h-12 w-12 text-slate-400",[s]:{class:s}},3,"d3_17"),e("div",null,{class:"flex text-sm text-slate-600 dark:text-slate-400"},[e("label",null,{for:"file-upload",class:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-teal-600 dark:text-teal-500 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500"},[e("span",null,null,"Upload a file",3,null),e("input",{ref:k},{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"application/pdf",disabled:b(S=>S.value,[E],"p0.value"),onChange$:N},null,3,null)],1,null),e("p",null,{class:"pl-1"},"or drag and drop",3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-500"},"PDF up to 10MB",3,null)],1,null),1,null),T.value&&e("p",null,{class:"mt-2 text-sm text-red-600 dark:text-red-500"},b(S=>S.value,[T],"p0.value"),3,"d3_18"),e("input",null,{type:"hidden",name:"contractUrl",value:b(S=>S.value??"",[h],'p0.value??""')},null,3,null)],1,null)],1,null),1,null)],1,null),1,null),1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b((S,x)=>S.isRunning||x.value,[a,E],"p0.isRunning||p1.value"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"},[a.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"d3_19"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"d3_20"),"Save Contract"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_C788vIi2DC8",[D,u])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"d3_21"),"Cancel"],1,null)],1,null),((q=a.value)==null?void 0:q.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"d3_22"),b(S=>S.value.error,[a],"p0.value.error")],1,"d3_23")],[s]:{action:s,onSubmitCompleted$:s}},1,"d3_24"),1,null)],1,null),1,"d3_25")],1,"d3_26")},Xs=V(g(Ws,"s_bsFwD0XY188")),Ks=Object.freeze(Object.defineProperty({__proto__:null,default:Xs,useContractsLoader:jl,useCreateContract:Fl,useProfessionalsLoader:$l},Symbol.toStringTag,{value:"Module"})),Vs=async l=>{const t=await $(l);if(!(t!=null&&t.isAuthenticated))throw l.redirect(302,"/auth");return t},ql=Y(g(Vs,"s_0RlA56KjQ2c")),Qs=async l=>{const t=M(l),a=await t.execute(`
    SELECT i.id, i.professional_id, p.name as professional_name, i.contract_id, i.amount, i.currency, i.status, i.issue_date, i.paid_date, i.invoice_url 
    FROM invoices i
    JOIN professionals p ON i.professional_id = p.id
    ORDER BY i.issue_date DESC
  `),n=await t.execute("SELECT id, name, role FROM professionals ORDER BY name"),r=await t.execute(`
    SELECT c.id, c.professional_id, p.name as professional_name, c.start_date, c.end_date
    FROM contracts c
    JOIN professionals p ON c.professional_id = p.id
    WHERE c.status = 'active'
    ORDER BY p.name, c.start_date DESC
  `);return{invoices:a.rows.map(o=>({...o,amount:Number(o.amount)})),professionals:n.rows,contracts:r.rows}},Bl=Y(g(Qs,"s_ZuT2HY9zmpM")),Zs=async(l,t)=>{const a=M(t),n=await $(t);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};const r=await a.execute({sql:"SELECT professional_id FROM contracts WHERE id = ?",args:[l.contractId]});if(r.rows.length===0)return{success:!1,error:"Contract not found."};const o=r.rows[0].professional_id;try{return await a.execute({sql:"INSERT INTO invoices (contract_id, professional_id, user_id, issue_date, amount, currency, status, paid_date, invoice_url) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)",args:[l.contractId,o,n.userId,l.issueDate,l.amount,l.currency,l.status,l.status==="paid"?new Date().toISOString().split("T")[0]:null,l.invoiceUrl]}),{success:!0}}catch(u){return console.error("Failed to add invoice:",u),{success:!1,error:"Failed to add invoice."}}},Js={contractId:y.coerce.number().int().positive(),issueDate:y.string().regex(/^\d{4}-\d{2}-\d{2}$/),amount:y.coerce.number().positive(),currency:y.string(),status:y.enum(["pending","paid"]),invoiceUrl:y.string().optional().nullable()},Hl=B(g(Zs,"s_8G0MNZu2NZ0"),Q(g(Js,"s_H13o942bCtI"))),ea=async({id:l,status:t},a)=>{const n=M(a),r=t==="paid"?"pending":"paid",o=r==="paid"?new Date().toISOString().split("T")[0]:null;try{return await n.execute({sql:"UPDATE invoices SET status = ?, paid_date = ? WHERE id = ?",args:[r,o,l]}),{success:!0}}catch(u){return console.error("Failed to update invoice status:",u),{success:!1,error:"Failed to update status."}}},la={id:y.coerce.number(),status:y.enum(["pending","paid"])},Yl=B(g(ea,"s_Ti9m9weHHSs"),Q(g(la,"s_CVqZ0lQFoCg"))),ta=async({id:l},t)=>{const a=M(t);try{return await a.execute({sql:"DELETE FROM invoices WHERE id = ?",args:[l]}),{success:!0}}catch(n){return console.error("Failed to delete invoice:",n),{success:!1,error:"Failed to delete invoice."}}},sa={id:y.coerce.number()},zl=B(g(ta,"s_c4Qyl0s0PVo"),Q(g(sa,"s_4ZbqH5h4Ri4"))),aa=({track:l})=>{const[t,a,n]=A();l(()=>a.value.invoices),l(()=>n.value);const r=n.value.toLowerCase();r?t.value=a.value.invoices.filter(o=>o.professional_name.toLowerCase().includes(r)):t.value=a.value.invoices},na=({track:l})=>{const[t,a,n]=A();l(()=>t.value.invoices),n.value=t.value.invoices.filter(r=>r.status==="pending").reduce((r,o)=>r+o.amount,0),a.value=t.value.invoices.filter(r=>r.status==="paid").reduce((r,o)=>r+o.amount,0)},ra=()=>{const[l,t,a,n,r,o,u,d,m,p]=A();t.value="",d.value=new Date().toISOString().split("T")[0],l.value="",a.value="USD",m.value="pending",o.value=null,r.value="",u.value=!1,p.value="",n.value&&(n.value.value="")},oa=async l=>{const[t,a,n,r,o]=A(),u=l.target;if(!u.files||u.files.length===0)return;const d=u.files[0];r.value=!0,o.value="";const m=new FormData;m.append("file",d);try{const p=await fetch("/api/upload-invoice",{method:"POST",body:m});if(!p.ok){const w=await p.json();throw new Error(w.error||`HTTP error! ${p.status}`)}const h=await p.json();if(h.success)n.value=h.fileName,a.value=URL.createObjectURL(d);else throw new Error(h.error||"Upload failed")}catch(p){o.value=p.message||"An unknown error occurred during upload.",t.value&&(t.value.value="")}finally{r.value=!1}},ua=()=>{var n;const[l,t,a]=A();(n=l.value)!=null&&n.success&&(a.value=!1,t())},ia=()=>{var P,G,K,W,Z,te,ne;z(),ql();const l=Bl(),t=Hl(),a=Yl(),n=zl(),r=v(!1),o=v(""),u=v(""),d=v(new Date().toISOString().split("T")[0]),m=v(""),p=v("USD"),h=v("pending"),w=v(null),E=v(""),T=v(!1),k=v(""),L=v(),D=v([]);Ce(g(aa,"s_09zgfJk3cKE",[D,l,o]));const N=v(0),O=v(0);Ce(g(na,"s_Gb41b109yVk",[l,O,N]));const U=g(ra,"s_GwAboejWJWc",[m,u,p,L,E,w,T,d,h,k]),q=g(oa,"s_gJ13e1jvr0M",[L,E,w,T,k]),S=_=>{if(!_)return"-";const J=new Date(_),ie=J.getTimezoneOffset()*6e4;return new Date(J.getTime()+ie).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},x=(_,J)=>new Intl.NumberFormat("en-US",{style:"currency",currency:J}).format(_);return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(me,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"T3_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Invoices",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Track and manage all payments",3,null)],3,null)],1,null),e("button",null,{class:"mt-4 sm:mt-0 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:f("s_Xh7yKGgpt0Y",[r])},[i(Ee,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"T3_1"),"Add Invoice"],1,null)],1,null),1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Invoices",3,null),e("p",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-200"},b(_=>_.value.invoices.length,[l],"p0.value.invoices.length"),3,null)],3,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Payment",3,null),e("p",null,{class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},x(N.value,"USD"),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Paid",3,null),e("p",null,{class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},x(O.value,"USD"),1,null)],1,null)],1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i(Ze,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"T3_2"),1,null),e("input",null,{type:"text",value:o,class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by professional...",onInput$:f("s_tpWw3z3lXmM",[o])},null,3,null)],1,null),1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Issue Date",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Amount",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},D.value.map(_=>z(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800 dark:text-slate-100"},R(_,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},S(_.issue_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-800 dark:text-slate-100 font-semibold"},x(_.amount,_.currency),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${_.status==="paid"?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 dark:from-amber-900/30 dark:to-amber-800/30 dark:text-amber-400"}`},null,_.status.charAt(0).toUpperCase()+_.status.slice(1),1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[_.invoice_url?e("a",{href:`/api/invoices/view/${_.invoice_url}`},{target:"_blank",rel:"noopener noreferrer",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all",title:"View Invoice"},i(Ie,{class:"h-5 w-5",[s]:{class:s}},3,"T3_3"),1,"T3_4"):e("button",null,{class:"p-1.5 text-slate-400 dark:text-slate-600 rounded-full transition-all cursor-not-allowed",disabled:!0,title:"No invoice uploaded"},i(Ie,{class:"h-5 w-5",[s]:{class:s}},3,"T3_5"),1,null),i(H,{action:a,children:[e("input",{value:R(_,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:R(_,"status")},{type:"hidden",name:"status"},null,3,null),e("button",{title:_.status==="paid"?"Mark as Pending":"Mark as Paid"},{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all"},_.status==="paid"?i(re,{class:"h-5 w-5",[s]:{class:s}},3,"T3_6"):i(_e,{class:"h-5 w-5",[s]:{class:s}},3,"T3_7"),1,null)],[s]:{action:s}},1,"T3_8"),i(H,{action:n,children:[e("input",{value:R(_,"id")},{type:"hidden",name:"id"},null,3,null),e("button",null,{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Delete Invoice"},i(de,{class:"h-5 w-5",[s]:{class:s}},3,"T3_9"),1,null)],[s]:{action:s}},1,"T3_10")],1,null),1,null)],1,_.id))),1,null)],1,null),1,null),D.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No invoices found.",3,null),3,"T3_11")],1,null)],1,null),r.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_uGSf4oJ6SJQ",[r])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:t,onSubmitCompleted$:g(ua,"s_EU50MZy0BNs",[t,U,r]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Add New Invoice",3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,null,[e("label",null,{for:"contractId",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Contract",3,null),e("select",null,{name:"contractId",id:"contractId",value:u,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_gV4M91Oagjs",[u])},[e("option",null,{value:""},"Select a contract",3,null),l.value.contracts.map(_=>e("option",{value:R(_,"id")},null,`${_.professional_name} (${S(_.start_date)})`,1,_.id))],1,null),((G=(P=t.value)==null?void 0:P.fieldErrors)==null?void 0:G.contractId)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.contractId[0],[t],"p0.value.fieldErrors.contractId[0]"),3,"T3_12")],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"issueDate",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Issue Date",3,null),e("input",null,{type:"date",name:"issueDate",id:"issueDate",value:d,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_ae1ZGRqvTnM",[d])},null,3,null),((W=(K=t.value)==null?void 0:K.fieldErrors)==null?void 0:W.issueDate)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.issueDate[0],[t],"p0.value.fieldErrors.issueDate[0]"),3,"T3_13")],1,null),e("div",null,null,[e("label",null,{for:"amount",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Amount",3,null),e("input",null,{type:"number",name:"amount",id:"amount",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_oqM2x05LSOg",[m])},null,3,null),((te=(Z=t.value)==null?void 0:Z.fieldErrors)==null?void 0:te.amount)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.amount[0],[t],"p0.value.fieldErrors.amount[0]"),3,"T3_14")],1,null)],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Currency",3,null),e("select",null,{name:"currency",id:"currency",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_5or9uINNTRc",[p])},[e("option",null,null,"USD",3,null),e("option",null,null,"EUR",3,null),e("option",null,null,"KNRT",3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{for:"status",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Status",3,null),e("select",null,{name:"status",id:"status",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_6e4iQEdCYJU",[h])},[e("option",null,{value:"pending"},"Pending",3,null),e("option",null,{value:"paid"},"Paid",3,null)],3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Invoice Document (PDF/Image)",3,null),E.value?e("div",null,{class:"mt-2"},[e("div",null,{class:"relative h-64 w-full rounded-lg border border-slate-300 dark:border-slate-600 overflow-hidden group"},[E.value.startsWith("blob:http")&&e("iframe",null,{src:b(_=>_.value,[E],"p0.value"),class:"h-full w-full",title:"Invoice Preview"},null,3,"T3_15"),e("a",null,{href:b(_=>_.value,[E],"p0.value"),target:"_blank",rel:"noopener noreferrer",class:"absolute top-2 right-2 p-2 bg-slate-700/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Open in new tab"},i(Sl,{class:"h-5 w-5",[s]:{class:s}},3,"T3_16"),1,null)],1,null),e("button",null,{type:"button",class:"mt-2 inline-flex items-center text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400",onClick$:f("s_fM3VT6rrliw",[L,E,w])},[i(Al,{class:"mr-1.5 h-4 w-4",[s]:{class:s}},3,"T3_17"),"Remove Document"],1,null)],1,"T3_18"):e("div",null,{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 dark:border-slate-600 border-dashed rounded-lg"},e("div",null,{class:"space-y-1 text-center"},[T.value?i(ee,{class:"mx-auto h-12 w-12 text-slate-400 animate-spin",[s]:{class:s}},3,"T3_19"):i(Ll,{class:"mx-auto h-12 w-12 text-slate-400",[s]:{class:s}},3,"T3_20"),e("div",null,{class:"flex text-sm text-slate-600 dark:text-slate-400"},[e("label",null,{for:"file-upload",class:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-teal-600 dark:text-teal-500 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500"},[e("span",null,null,"Upload a file",3,null),e("input",{ref:L},{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"application/pdf,image/*",disabled:b(_=>_.value,[T],"p0.value"),onChange$:q},null,3,null)],1,null),e("p",null,{class:"pl-1"},"or drag and drop",3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-500"},"PDF, PNG, JPG up to 10MB",3,null)],1,null),1,null),k.value&&e("p",null,{class:"mt-2 text-sm text-red-600 dark:text-red-500"},b(_=>_.value,[k],"p0.value"),3,"T3_21"),e("input",null,{type:"hidden",name:"invoiceUrl",value:b(_=>_.value??"",[w],'p0.value??""')},null,3,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b((_,J)=>_.isRunning||J.value,[t,T],"p0.isRunning||p1.value"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"T3_22"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"T3_23"),"Save Invoice"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_SUoZcR3RUO0",[U,r])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"T3_24"),"Cancel"],1,null)],1,null),((ne=t.value)==null?void 0:ne.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"T3_25"),b(_=>_.value.error,[t],"p0.value.error")],1,"T3_26")],[s]:{action:s,onSubmitCompleted$:s}},1,"T3_27"),1,null)],1,null),1,"T3_28")],1,"T3_29")},da=V(g(ia,"s_a5XSqTax3Rc")),ca=Object.freeze(Object.defineProperty({__proto__:null,default:da,useAddInvoice:Hl,useAuthLoader:ql,useDeleteInvoice:zl,useInvoicesLoader:Bl,useUpdateInvoiceStatus:Yl},Symbol.toStringTag,{value:"Module"}));function ce(l,t){const n=new Intl.NumberFormat("es-ES",{style:"currency",currency:t==="KNRT"?"EUR":t,minimumFractionDigits:2}).format(l);return t==="KNRT"?n.replace("€","KNRT"):n}function ma(l,t){return t==="AM"?l===12?0:l:l===12?12:l+12}const pa=["UTC","America/Mexico_City","America/Caracas","America/Bogota","America/Argentina/Buenos_Aires","America/Santiago","America/Lima","America/New_York","America/Los_Angeles","Europe/Madrid","Europe/London","Europe/Berlin","Europe/Paris","Asia/Tokyo","Asia/Shanghai","Asia/Kolkata","Australia/Sydney"],fa=[{inputs:[{internalType:"address",name:"_registry",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{inputs:[],name:"ReentrancyGuardReentrantCall",type:"error"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"SafeERC20FailedOperation",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lockId",type:"uint256"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"releaseTime",type:"uint256"},{indexed:!1,internalType:"address[]",name:"recipients",type:"address[]"},{indexed:!1,internalType:"uint256[]",name:"amounts",type:"uint256[]"}],name:"LockCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lockId",type:"uint256"}],name:"LockReleased",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"cancelUpkeepAndWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"checkUpkeep",outputs:[{internalType:"bool",name:"upkeepNeeded",type:"bool"},{internalType:"bytes",name:"performData",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"totalAmount",type:"uint256"},{internalType:"address[]",name:"recipients",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"uint256",name:"releaseTime",type:"uint256"}],name:"createLock",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"emergencyWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"forwarder",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllLocks",outputs:[{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"address[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"uint256[]",name:"releaseTimes",type:"uint256[]"},{internalType:"bool[]",name:"released",type:"bool[]"},{internalType:"address[][]",name:"recipients",type:"address[][]"},{internalType:"uint256[][]",name:"recipientAmounts",type:"uint256[][]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"locks",outputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"releaseTime",type:"uint256"},{internalType:"bool",name:"released",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextLockId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"performUpkeep",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"registry",outputs:[{internalType:"contract AutomationRegistryInterface",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_forwarder",type:"address"}],name:"setForwarderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"setUpkeepId",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"upkeepId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"withdrawAllLink",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdrawLink",outputs:[],stateMutability:"nonpayable",type:"function"}],xa=async()=>{const[l,t,a]=A();return t.value="MetaMask solo se puede usar en el navegador.",!1},ga=async(l,t,a,n,r)=>{const[o,u,d,m,p]=A();m.value="Esta acción solo se puede realizar en el navegador."},ba=async()=>{const[l,t,a,n]=A();a.value=!0,t.value="",console.log("[TimeLock] Iniciando carga de locks...");try{const r=St({chain:cl,transport:Lt(cl.rpcUrls.default.http[0])});console.log("[TimeLock] Llamando a getAllLocks en el contrato:",l);const o=await r.readContract({address:l,abi:fa,functionName:"getAllLocks"});if(console.log("[TimeLock] Resultado de getAllLocks:",o),!o||!Array.isArray(o)||o.length<7){t.value="El contrato no devolvió el formato esperado de locks.",console.error("[TimeLock] Formato inesperado:",o),n.value=[],a.value=!1;return}const[u,d,m,p,h,w,E]=o,T=(u||[]).map((k,L)=>({id:k,token:d[L],totalAmount:m[L],releaseTime:p[L],released:h[L],recipients:w[L],amounts:E[L]}));n.value=T,console.log("[TimeLock] Locks parseados:",T)}catch(r){t.value=r.message||"Error al leer locks",console.error("[TimeLock] Error al leer locks:",r)}a.value=!1},ha=async()=>{const[l,t,a,n,r]=A();a.value="Esta acción solo se puede realizar en el navegador."};function va(){const l=v(null),t=v(""),a=v(""),n=v([]),r=v(!1),o=g(xa,"s_81MCpzm7a6o",[l,a,t]),u="0x3FaD005Daf5DBc6Bb2E7645932557EBC1776Ef3e",d=g(ga,"s_Nk78oOdFUOs",[u,l,o,a,t]),m=g(ba,"s_nugdMjWhp0M",[u,a,r,n]);return{address:l,status:t,error:a,locks:n,loadingLocks:r,connect:o,createLock:d,loadLocks:m,performUpkeep:g(ha,"s_03RWAw0emAM",[u,l,a,m,t])}}const wa=async l=>{console.log("[planner-auto] loader: requestEvent",{url:l.request.url}),await ae(l);const t=await $(l);if(!t.isAuthenticated)throw l.fail(401,{error:"Unauthorized"});const a=M(l),n=new URL(l.request.url),r=n.searchParams.get("month")||(new Date().getMonth()+1).toString(),o=n.searchParams.get("year")||new Date().getFullYear().toString(),u=`${o}-${String(r).padStart(2,"0")}-01`,m=new Date(Number(o),Number(r),0).getDate(),p=`${o}-${String(r).padStart(2,"0")}-${String(m).padStart(2,"0")}`;let h=`
      SELECT p.id, p.professional_id, prof.name as professional_name, prof.wallet as professional_wallet,
             p.amount, p.currency, p.status, p.due_date, p.description, p.contract_id, c.id as contract_id, c.start_date, c.end_date, c.status as contract_status, c.contract_url
      FROM payments p
      JOIN professionals prof ON p.professional_id = prof.id
      LEFT JOIN contracts c ON p.contract_id = c.id
      WHERE p.due_date BETWEEN ? AND ?`;const w=[u,p];be(t)||(h+=" AND p.professional_id = ?",w.push(t.userId)),h+=`
      ORDER BY p.due_date ASC`;const E=await a.execute({sql:h,args:w}),T=await a.execute("SELECT id, name, wallet FROM professionals ORDER BY name"),k=await a.execute(`
    SELECT c.id, c.professional_id, c.start_date, c.end_date, c.status, c.contract_url
    FROM contracts c
    WHERE c.status = 'active'
    ORDER BY c.start_date DESC
  `),L={payments:E.rows.map(D=>({...D,amount:Number(D.amount)})),professionals:T.rows,contracts:k.rows,currentMonth:Number(r),currentYear:Number(o)};return console.log("[planner-auto] loader result",JSON.stringify(L,null,2)),L},Gl=Y(g(wa,"s_s6FoNBLF0yg")),ka=async(l,t)=>{const a=await $(t);if(!a.isAuthenticated||!a.userId)return{success:!1,error:"Unauthorized"};await ae(t);const n=M(t),{id:r,professional_id:o,amount:u,currency:d,due_date:m,description:p,contract_id:h,autoSchedulePayment:w,autoScheduleTime:E,customDate:T,customHour:k,customMinute:L,timezone:D}=l;try{if(w==="true")try{const N=await n.execute({sql:"SELECT wallet, name FROM professionals WHERE id = ?",args:[o]});if(N.rows.length===0)return{success:!1,error:`No se pudo encontrar la información del profesional con ID ${o}`};const O=N.rows[0].wallet,U=N.rows[0].name;if(!O)return{success:!1,error:`El profesional ${U} no tiene una dirección de wallet configurada`};Date.now();let q,S;const x=m.split("-").map(Number);let P=typeof k=="string"?parseInt(k,10):0;const G=typeof L=="string"?parseInt(L,10):0;let K=l.amPm||null;K&&(P=ma(P,K));const W=Et.fromObject({year:x[0],month:x[1],day:x[2],hour:P,minute:G,second:0,millisecond:0},{zone:D||"UTC"});switch(q=Math.floor(W.toUTC().toSeconds()),S=`fecha de vencimiento (${W.toFormat("yyyy-MM-dd HH:mm")} [${D||"UTC"}] | UTC: ${W.toUTC().toFormat("yyyy-MM-dd HH:mm")})`,E){case"duedate":case"custom":case"30min":case"1h":case"1d":case"1w":break;default:console.log("Usando la fecha de vencimiento con la hora seleccionada por defecto")}const Z=$e(d);if(!Z)return{success:!1,error:`No se ha configurado el token para ${d}`};const te=await n.execute({sql:`INSERT INTO payments (user_id, professional_id, contract_id, amount, currency, status, description, due_date, created_at, updated_at)
                   VALUES (?, ?, ?, ?, ?, 'pending', ?, ?, datetime('now'), datetime('now'))`,args:[a.userId,o,h||null,u,d,p||null,m]});return{success:!0,needsBlockchainAction:!0,autoSchedule:!0,payment_id:Number(te.lastInsertRowid),professional_wallet:O,professional_name:U,amount:Number(u),currency:d,tokenAddress:Z,releaseTimestamp:q,releaseDescription:S,paymentData:{professional_id:o,user_id:a.userId,amount:u,currency:d,due_date:m,description:p||null,releaseTimestamp:q}}}catch(N){return console.error("Error en la automatización del pago:",N),{success:!1,error:`Error en la automatización del pago: ${N instanceof Error?N.message:String(N)}`}}else return r?await n.execute({sql:"UPDATE payments SET professional_id = ?, amount = ?, currency = ?, due_date = ?, description = ?, contract_id = ? WHERE id = ?",args:[o,u,d,m,p||null,h||null,r]}):await n.execute({sql:"INSERT INTO payments (professional_id, user_id, amount, currency, status, due_date, description, contract_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)",args:[o,a.userId,u,d,"pending",m,p||null,h||null]}),{success:!0}}catch(N){return console.error(N),{success:!1,error:`Failed to save payment: ${N instanceof Error?N.message:String(N)}`}}},ya={id:y.coerce.number().optional(),professional_id:y.coerce.number(),amount:y.coerce.number().positive(),currency:y.string(),due_date:y.string(),description:y.string().optional(),contract_id:y.coerce.number().optional().nullable(),autoSchedulePayment:y.string().optional(),autoScheduleTime:y.string().optional(),customDate:y.string().optional(),customHour:y.string().optional(),customMinute:y.string().optional(),amPm:y.string().optional(),timezone:y.string().optional()},Wl=B(g(ka,"s_XgvIlAoR1Uc"),Q(g(ya,"s_5hhdmTOQc4Y"))),_a=async({id:l,status:t},a)=>{await ae(a);const n=M(a),r=t==="paid"?"pending":"paid",o=r==="paid"?new Date().toISOString().split("T")[0]:null;try{return await n.execute({sql:"UPDATE payments SET status = ?, payment_date = ? WHERE id = ?",args:[r,o,l]}),{success:!0}}catch{return{success:!1,error:"Failed to process payment."}}},Ta={id:y.coerce.number(),status:y.enum(["pending","paid"])},Xl=B(g(_a,"s_VNsZdI3vMNs"),Q(g(Ta,"s_R1OHWHmN4Pg"))),Ea=async({payment_id:l,tx_hash:t,status:a},n)=>{await ae(n);const r=M(n);try{return l===null||isNaN(Number(l))?{success:!1,error:"ID de pago no válido"}:((await r.execute({sql:"SELECT id FROM timelocks WHERE payment_id = ?",args:[l]})).rows.length===0&&await r.execute({sql:"INSERT INTO timelocks (payment_id, release_timestamp, status, tx_hash) VALUES (?, ?, ?, ?)",args:[l,Math.floor(Date.now()/1e3),a,t]}),await r.execute({sql:"UPDATE timelocks SET tx_hash = ?, status = ?, updated_at = CURRENT_TIMESTAMP WHERE payment_id = ?",args:[t,a,l]}),a==="completed"&&await r.execute({sql:"UPDATE payments SET status = ?, payment_date = ? WHERE id = ?",args:["paid",new Date().toISOString().split("T")[0],l]}),{success:!0})}catch(o){return console.error(o),{success:!1,error:"Failed to update timelock transaction."}}},Sa={payment_id:y.coerce.number().nullable(),tx_hash:y.string(),status:y.enum(["pending","completed","failed"])},Kl=B(g(Ea,"s_uXbM6qK1poc"),Q(g(Sa,"s_Lk1CrG3oTpc"))),La=async({id:l},t)=>{await ae(t);const a=M(t);try{return await a.execute({sql:"DELETE FROM payments WHERE id = ?",args:[l]}),{success:!0}}catch{return{success:!1,error:"Failed to delete payment."}}},Ra={id:y.coerce.number()},Vl=B(g(La,"s_gYtsTIZGnjo"),Q(g(Ra,"s_76eZ6aCV60M")));function $e(l){switch(l){case"USD":case"USDC":return"0x5FbDB2315678afecb367f032d93F642f64180aa3";case"ETH":return"0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512";case"DAI":return"0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0";case"USDT":return"0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9";case"KNRT":return"0x54de10fadf4ea2fbad10ebfc96979d0885dd36fa";case"EUR":return"0x5FbDB2315678afecb367f032d93F642f64180aa3";default:return"0x5FbDB2315678afecb367f032d93F642f64180aa3"}}const Ca=async l=>{const t=await $(l);if(!t)throw l.redirect(302,"/auth");return t},Ql=Y(g(Ca,"s_qV4UV4XmyfA")),Aa=({track:l})=>{const[t,a,n]=A()},Ia=l=>{const[t,a]=A();let n=t.value+l,r=a.value;n>12?(n=1,r++):n<1&&(n=12,r--);const o=new URL(window.location.href);o.searchParams.set("month",n.toString()),o.searchParams.set("year",r.toString()),window.location.href=o.toString()},Na=(l,t=null)=>{const[a,n,r,o,u,d,m,p,h,w,E,T,k,L,D,N]=A();if(t)T.value=t.id,k.value=String(t.professional_id),L.value=t.professional_wallet,m.value=String(t.amount),h.value=t.currency,E.value=t.due_date,w.value=t.description||"",p.value=t.contract_id?String(t.contract_id):"",a.value=!0;else if(l){const O=new Date(r.value,n.value-1,l);T.value=void 0,k.value="",L.value=null,m.value="",h.value="USD",E.value=O.toISOString().split("T")[0],w.value="",p.value="",a.value=!0}u.value=10,d.value=0,o.value=E.value,D.processed=!1,N.value=!0},Ma=l=>{const t=new Date(l);return Math.floor(t.getTime()/1e3)},Da=async l=>{const[t,a,n]=A();if(!n.address.value){n.connect();return}t.value=l,a.value=!0},Oa=async l=>{const[t,a,n,r,o,u]=A();if(!l||!l.professional_wallet){u.error.value="No se puede crear un timelock sin un profesional con wallet.";return}const d=$e(l.currency);if(!d){u.error.value=`No se ha configurado el token para ${l.currency}`;return}let m;const h=Math.floor(Date.now()/1e3)+1800;t.value?m=t.value:m=await n(l.due_date),m<h&&(m=h,a.value="30 minutos desde ahora (ajustado automáticamente)"),console.log("[planner-auto] Llamando a timelock.createLock con:",{token:d,amount:l.amount.toString(),recipient:l.professional_wallet,releaseTime:m.toString()}),u.createLock(d,l.amount.toString(),l.professional_wallet,l.amount.toString(),m.toString()),r.value=!1,o.value=!0},Ua=async()=>{const[l,t,a,n,r]=A();try{if(!r.address.value&&(console.log("No hay conexión con MetaMask. Intentando conectar..."),!await r.connect())){console.error("No se pudo conectar a MetaMask"),r.error.value="Conecta MetaMask primero para crear timelocks",n.value=!0;return}const o=a.value.payments.filter(d=>d.status==="pending");if(o.length===0){r.error.value="No hay pagos pendientes para crear timelocks",n.value=!0;return}console.log(`Procesando ${o.length} pagos pendientes para timelocks`);const u={};o.forEach(d=>{const m=`${d.professional_id}_${d.due_date}_${d.currency}`;u[m]||(u[m]=[]),u[m].push(d)}),console.log(`Pagos agrupados en ${Object.keys(u).length} grupos para timelocks`),n.value=!0,r.status.value="Procesando timelocks en lote...";for(const d of Object.values(u))if(d.length>0){const m=d[0],p=$e(m.currency);if(!p){r.error.value=`No se ha configurado el token para ${m.currency}`;continue}const h=d.reduce((E,T)=>E+T.amount,0).toString(),w=(await t(m.due_date)).toString();if(!m.professional_wallet){r.error.value=`El profesional ${m.professional_name} no tiene una wallet configurada.`;continue}l.value=m,console.log(`Creando timelock para ${m.professional_name} por ${h} ${m.currency}`),await r.createLock(p,h,m.professional_wallet,h,w),await new Promise(E=>setTimeout(E,1e3))}r.status.value="Proceso de timelocks en lote completado"}catch(o){console.error("Error al crear timelocks en lote:",o),r.error.value=o instanceof Error?`Error al crear timelocks en lote: ${o.message}`:"Error desconocido al crear timelocks en lote",n.value=!0}},Pa=(l,t)=>{const[a,n,r]=A(),o=Math.floor(Date.now()/1e3);a.value=o+l,n.value=t,r.value=!1},ja=()=>{const[l,t,a,n,r]=A(),o=new Date(l.value);o.setHours(t.value,a.value,0,0);const u=Date.now()+18e5;if(o.getTime()<u){const h=new Date(u);l.value=h.toISOString().split("T")[0],t.value=h.getHours(),a.value=h.getMinutes(),o.setTime(h.getTime())}const d=Math.floor(o.getTime()/1e3);n.value=d;const m=o.toLocaleDateString(),p=o.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});r.value=`${m} a las ${p}`},$a=l=>{const t=l.target,a=t.due_date.value,n=parseInt(t.customHour.value,10),r=parseInt(t.customMinute.value,10),o=new Date(a);o.setHours(n,r,0,0),o.getTime()<=Date.now()&&(l.preventDefault(),alert("La fecha y hora seleccionadas deben ser futuras."))},Fa=()=>{var a;const[l,t]=A();(a=l.value)!=null&&a.success&&(t.value=!1)},qa=()=>{var tl,sl,al,nl,rl,ol,ul;z(),Ql();const l=Gl(),t=Wl(),a=Xl(),n=Vl(),r=Kl(),o=va();ye(f("s_9p09Nr0kbzs",[o]));const u=v(!1),d=v(null);v(""),v("USDC");const m=v(!1),p=v(null),h=v(""),w=v(!1),E=v(new Date().toISOString().split("T")[0]),T=v(0),k=v(30),L=v(!1),D=v("UTC"),N=v(new Date),O=v(null),U=v(null);ye(f("s_YC4N9b6tipo",[N,O,U]));const q=Intl.DateTimeFormat().resolvedOptions().timeZone,S=hl({pending:!1,processed:!1,payment_id:0,professional_wallet:"",amount:0,currency:"",tokenAddress:"",releaseTimestamp:0}),x=v("24h"),P=v("AM");ye(f("s_01js8sB333k",[S,t,m,o])),Ce(g(Aa,"s_0ecAu7zE5FE",[S,o,r])),ye(f("s_IoIyYaE2GKk",[u,o]));const G=v(!1),K=v(),W=v(""),Z=v(null),te=v(""),ne=v("USD"),_=v(""),J=v(""),ie=v(""),le=v(!0),I=v("duedate"),Se=v(l.value.currentMonth),Le=v(l.value.currentYear),bt=new Date(Le.value,Se.value,0).getDate(),ht=new Date(Le.value,Se.value-1,1).getDay(),vt=[...Array.from({length:ht},()=>null),...Array.from({length:bt},(c,F)=>F+1)],Je=g(Ia,"s_TUznumlWyPE",[Se,Le]),el=g(Na,"s_0pP60mX9xb8",[le,Se,Le,E,T,k,te,ie,ne,J,_,K,W,Z,S,G]),wt=(c,F)=>new Date(F,c-1).toLocaleString("default",{month:"long",year:"numeric"}),ll=g(Ma,"s_ve7BpfRVPxE"),kt=g(Da,"s_G6m7BxH9ncw",[d,w,o]),yt=g(Oa,"s_2dQUFHNUygk",[p,h,ll,w,m,o]),_t=g(Ua,"s_BArC0LO0WQE",[d,ll,l,m,o]),Me=c=>{const F=new Date(Number(c)*1e3);return F.toLocaleDateString()+" "+F.toLocaleTimeString()},Re=g(Pa,"s_xVlh02hMGCI",[p,h,L]),Fe=g(ja,"s_Xe5EIvafePU",[E,T,k,p,h]);return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(Pe,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"Lq_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Payment Scheduler",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Plan and manage future payments",3,null)],3,null)],1,null),e("div",null,{class:"flex items-center mt-4 sm:mt-0 space-x-4"},[e("div",null,null,e("button",null,{class:"inline-flex items-center px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-medium text-sm shadow-md hover:from-indigo-600 hover:to-purple-600 transition-all",onClick$:f("s_cAYREhDW9X4",[u,o])},o.address.value?i(xe,{children:[i(fl,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_1")," ",b(c=>c.value?"Ocultar Timelocks":"Ver Timelocks",[u],'p0.value?"Ocultar Timelocks":"Ver Timelocks"')]},1,"Lq_2"):i(xe,{children:[i(ke,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_3")," Conectar Wallet"]},1,"Lq_4"),1,null),1,null),e("div",null,{class:"flex items-center"},[e("button",null,{class:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600 transition-all",onClick$:f("s_KKrChNx80lI",[Je])},i(Ke,{class:"h-6 w-6 text-slate-600 dark:text-slate-300",[s]:{class:s}},3,"Lq_5"),1,null),e("h2",null,{class:"w-48 text-center text-lg font-semibold text-slate-700 dark:text-slate-200"},wt(Se.value,Le.value),1,null),e("button",null,{class:"p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600 transition-all",onClick$:f("s_mLWCT0ELoNg",[Je])},i(Ve,{class:"h-6 w-6 text-slate-600 dark:text-slate-300",[s]:{class:s}},3,"Lq_6"),1,null)],1,null)],1,null)],1,null),1,null),o.address.value&&u.value&&e("div",null,{class:"mb-8 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-xl shadow-md p-6 border border-indigo-100 dark:border-indigo-800/50"},[e("div",null,{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4"},[e("div",null,null,[e("div",null,{class:"flex items-center"},[i(ue,{class:"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-2",[s]:{class:s}},3,"Lq_7"),e("h2",null,{class:"text-xl font-bold text-slate-800 dark:text-slate-200"},"TimeLock Smart Contract",3,null)],1,null),e("p",null,{class:"text-sm text-slate-600 dark:text-slate-400 mt-1"},["Wallet: ",b(c=>c.address.value,[o],"p0.address.value")],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 space-x-2"},[e("button",{onClick$:o.loadLocks},{class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-indigo-100 hover:bg-indigo-200 dark:bg-indigo-900/50 dark:hover:bg-indigo-800/70 text-indigo-700 dark:text-indigo-300 text-sm transition-all"},[i(qt,{get class(){return`h-4 w-4 mr-1.5 ${o.loadingLocks.value?"animate-spin":""}`},[s]:{class:b(c=>`h-4 w-4 mr-1.5 ${c.loadingLocks.value?"animate-spin":""}`,[o],'`h-4 w-4 mr-1.5 ${p0.loadingLocks.value?"animate-spin":""}`')}},3,"Lq_8")," Refrescar"],0,null),e("button",null,{class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-purple-100 hover:bg-purple-200 dark:bg-purple-900/50 dark:hover:bg-purple-800/70 text-purple-700 dark:text-purple-300 text-sm transition-all",onClick$:_t},[i(ue,{class:"h-4 w-4 mr-1.5",[s]:{class:s}},3,"Lq_9")," Crear Timelocks en Lote"],1,null),e("button",{onClick$:o.performUpkeep},{class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-emerald-100 hover:bg-emerald-200 dark:bg-emerald-900/50 dark:hover:bg-emerald-800/70 text-emerald-700 dark:text-emerald-300 text-sm transition-all"},[i(fl,{class:"h-4 w-4 mr-1.5",[s]:{class:s}},3,"Lq_10")," Ejecutar Pagos"],0,null)],1,null)],1,null),o.error.value&&e("div",null,{class:"mt-2 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg text-sm"},[i(se,{class:"inline-block h-4 w-4 mr-1",[s]:{class:s}},3,"Lq_11")," ",b(c=>c.error.value,[o],"p0.error.value")],1,"Lq_12"),o.status.value&&e("div",null,{class:"mt-2 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg text-sm"},[i(_e,{class:"inline-block h-4 w-4 mr-1",[s]:{class:s}},3,"Lq_13")," ",b(c=>c.status.value,[o],"p0.status.value")],1,"Lq_14"),e("div",null,{class:"mt-4 overflow-auto rounded-lg border border-slate-200 dark:border-slate-700/50"},e("table",null,{class:"w-full bg-white dark:bg-slate-800/50 text-left text-sm"},[e("thead",null,{class:"bg-slate-50 dark:bg-slate-700/50"},e("tr",null,null,[e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"ID",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Token",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Monto",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Fecha Liberación",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Time Remaining",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Estado",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Destinatarios",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Profesional",3,null)],3,null),3,null),e("tbody",null,{class:"divide-y divide-slate-200 dark:divide-slate-700/50"},o.loadingLocks.value?e("tr",null,null,e("td",null,{colSpan:7,class:"px-4 py-6 text-center text-slate-500 dark:text-slate-400"},[i(ee,{class:"animate-spin h-6 w-6 mx-auto mb-2",[s]:{class:s}},3,"Lq_15"),"Cargando locks..."],1,null),1,"Lq_16"):o.locks.value.length===0?e("tr",null,null,e("td",null,{colSpan:7,class:"px-4 py-6 text-center text-slate-500 dark:text-slate-400"},"No hay locks creados aún.",3,null),3,"Lq_17"):o.locks.value.map(c=>e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/30"},[e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},R(c,"id"),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},[c.token.slice(0,6),"...",c.token.slice(-4)],1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},c.totalAmount.toString(),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},Me(c.releaseTime),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},(()=>{const F=Math.floor(Date.now()/1e3),j=Number(c.releaseTime)-F;if(c.released)return e("span",null,{class:"text-emerald-600 dark:text-emerald-300"},"-",3,"Lq_18");if(j<=0)return e("span",null,{class:"text-amber-600 dark:text-amber-300"},"Ready",3,"Lq_19");const he=Math.floor(j/86400),ve=Math.floor(j%86400/3600),qe=Math.floor(j%3600/60),il=j%60;return e("span",null,null,[he>0&&`${he}d `,ve>0&&`${ve}h `,qe>0&&`${qe}m `,il>0&&he===0&&ve===0&&qe===0?`${il}s`:""],1,"Lq_20")})(),1,null),e("td",null,{class:"px-4 py-3"},e("span",{class:`px-2 py-1 rounded-full text-xs font-medium ${c.released?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300"}`},null,c.released?"Liberado":"Pendiente",1,null),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},c.recipients.map((F,j)=>e("div",null,{class:"text-xs"},[F.slice(0,6),"...",F.slice(-4)," (",c.amounts[j].toString(),")"],1,j)),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},Array.isArray(c.recipients)&&c.recipients.length>0?c.recipients.map((F,j)=>{const he=l.value.professionals.find(ve=>ve.wallet&&ve.wallet.toLowerCase()===F.toLowerCase());return e("div",null,{class:"text-xs"},he?he.name:"-",1,j)}):"-",1,null)],1,c.id)),1,null)],1,null),1,null)],1,"Lq_21"),e("div",null,{class:"grid grid-cols-7 gap-px bg-slate-200 dark:bg-slate-700 border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden shadow-lg"},[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(c=>e("div",null,{class:"text-center py-2 bg-slate-100 dark:bg-slate-800 text-xs font-bold text-slate-600 dark:text-slate-300 uppercase"},c,1,c)),vt.map((c,F)=>z(e("div",{class:`relative min-h-[120px] bg-white dark:bg-slate-800/50 p-2 ${c?"hover:bg-slate-50 dark:hover:bg-slate-700/50":"bg-slate-50 dark:bg-slate-800/80"}`},null,c&&i(xe,{children:[e("span",null,{class:"text-sm font-semibold text-slate-700 dark:text-slate-300"},c,1,null),e("button",{onClick$:f("s_sMGwuizzM3E",[c,el])},{class:"absolute top-1 right-1 h-6 w-6 flex items-center justify-center rounded-full text-slate-400 hover:bg-teal-100 hover:text-teal-600 dark:hover:bg-teal-900/50 dark:hover:text-teal-400 transition-all"},i(Ee,{class:"h-4 w-4",[s]:{class:s}},3,"Lq_22"),0,null),e("div",null,{class:"mt-2 space-y-1"},l.value.payments.filter(j=>new Date(j.due_date+"T00:00:00").getDate()===c).map(j=>z(e("div",{class:`p-1.5 rounded-lg text-xs cursor-pointer group ${j.status==="paid"?"bg-emerald-50 dark:bg-emerald-900/30":"bg-amber-50 dark:bg-amber-900/30"}`},null,[e("p",{class:`font-semibold truncate ${j.status==="paid"?"text-emerald-800 dark:text-emerald-300":"text-amber-800 dark:text-amber-300"}`},null,R(j,"professional_name"),1,null),e("p",{class:`truncate ${j.status==="paid"?"text-emerald-600 dark:text-emerald-400":"text-amber-600 dark:text-amber-400"}`},null,ce(j.amount,j.currency),1,null),e("div",null,{class:"hidden group-hover:flex items-center justify-end space-x-1 mt-1"},[e("button",{onClick$:f("s_YzyyCDyxLTY",[c,el,j])},{class:"p-1 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600"},i(je,{class:"h-3 w-3 text-slate-600 dark:text-slate-300",[s]:{class:s}},3,"Lq_23"),0,null),o.address.value&&j.status==="pending"&&e("button",{onClick$:f("s_UzPKQ2Q5D58",[kt,j])},{class:"p-1 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600"},i(ue,{class:"h-3 w-3 text-indigo-600 dark:text-indigo-400",[s]:{class:s}},3,"Lq_24"),0,"Lq_25"),i(H,{action:a,children:[e("input",{value:R(j,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:R(j,"status")},{type:"hidden",name:"status"},null,3,null),e("button",null,{type:"submit",class:"p-1 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600"},j.status==="paid"?i(re,{class:"h-3 w-3 text-yellow-600",[s]:{class:s}},3,"Lq_26"):i(_e,{class:"h-3 w-3 text-green-600",[s]:{class:s}},3,"Lq_27"),1,null)],[s]:{action:s}},1,"Lq_28")],1,null)],1,j.id))),1,null)]},1,"Lq_29"),1,F)))],1,null)],1,null),G.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_MseIsWMHryY",[G])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:t,onSubmit$:g($a,"s_UcBhReDSW9s"),onSubmitCompleted$:g(Fa,"s_ytGGNMtamRo",[t,G]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100"},[b(c=>c.value?"Edit":"Schedule",[K],'p0.value?"Edit":"Schedule"')," Payment"],3,null),e("input",null,{type:"hidden",name:"id",value:b(c=>c.value,[K],"p0.value")},null,3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,null,[e("label",null,{for:"timezone",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Zona horaria",3,null),e("select",null,{id:"timezone",name:"timezone",value:D,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_xyRXkU0XAu4",[D])},pa.map(c=>e("option",{value:c},null,c,1,c)),1,null)],1,null),e("div",null,null,[e("label",null,{for:"professional_id",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Professional",3,null),e("select",null,{name:"professional_id",id:"professional_id",value:W,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_ss4Qhg76mw4",[W]),onChange$:f("s_w9l5RZL7yaE",[Z,l])},[e("option",null,{value:""},"Select Professional",3,null),l.value.professionals.map(c=>e("option",{value:R(c,"id")},null,c.name,1,c.id))],1,null),Z.value&&e("div",null,{class:"mt-2 flex items-center p-2 rounded-md bg-slate-50 dark:bg-slate-700/30 border border-slate-200 dark:border-slate-600/30"},[i(ke,{class:"h-4 w-4 text-indigo-500 dark:text-indigo-400 mr-2 flex-shrink-0",[s]:{class:s}},3,"Lq_30"),e("span",null,{class:"text-xs font-mono text-slate-600 dark:text-slate-300 truncate"},b(c=>c.value,[Z],"p0.value"),3,null)],1,"Lq_31")],1,null),e("div",null,null,[e("label",null,{for:"contract_id",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Contrato",3,null),e("select",null,{name:"contract_id",id:"contract_id",value:ie,disabled:b(c=>!c.value,[W],"!p0.value"),class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_nnXBr5SWKME",[ie])},[e("option",null,{value:""},"Selecciona un contrato",3,null),l.value.contracts.filter(c=>String(c.professional_id)===W.value).map(c=>e("option",{value:R(c,"id")},null,c.contract_url?`#${c.id} (${c.start_date} - ${c.end_date||"actual"})`:`#${c.id} (${c.start_date})`,1,c.id))],1,null),!W.value&&e("p",null,{class:"text-xs text-slate-400 mt-1"},"Selecciona primero un profesional para ver sus contratos.",3,"Lq_32")],1,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"amount",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Amount",3,null),e("input",null,{type:"number",name:"amount",id:"amount",value:te,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_dYqD2EO6CuI",[te])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Currency",3,null),e("select",null,{name:"currency",id:"currency",value:ne,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_N07FfyRUgFE",[ne])},[e("option",null,null,"USD",3,null),e("option",null,null,"EUR",3,null),e("option",null,null,"KNRT",3,null)],3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{for:"due_date",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Due Date y Hora",3,null),e("div",null,{class:"flex flex-col space-y-2"},[e("div",null,{class:"flex items-center gap-2 mb-2"},[i(re,{class:"h-4 w-4 text-indigo-500",[s]:{class:s}},3,"Lq_33"),e("span",null,{class:"text-xs text-slate-600 dark:text-slate-300 font-mono"},["Ahora: ",N.value.toLocaleString()," (",q,")"],1,null)],1,null),e("input",null,{type:"date",name:"due_date",id:"due_date",value:_,min:new Date().toISOString().split("T")[0],class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_Nse7RV5Epok",[_]),onChange$:f("s_KjHb5bfChxQ",[P,E,T,k,O,x,U])},null,3,null),e("div",null,{class:"flex items-center space-x-2"},[e("div",null,{class:"flex-1"},[e("label",null,{for:"payment_hour",class:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1"},"Hora",3,null),e("select",null,{id:"payment_hour",name:"customHour",value:b(c=>c.value.toString(),[T],"p0.value.toString()"),class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-2 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm","aria-label":"Hour",onChange$:f("s_0kgL8PRtKsQ",[P,T,k,_,O,x,U])},x.value==="24h"?Array.from({length:24},(c,F)=>F).map(c=>e("option",{value:c},null,c.toString().padStart(2,"0"),1,c)):Array.from({length:12},(c,F)=>F+1).map(c=>e("option",{value:c},null,c.toString().padStart(2,"0"),1,c)),1,null)],1,null),x.value==="12h"&&e("div",null,{class:"flex-1"},[e("label",null,{class:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1"},"AM/PM",3,null),e("select",null,{name:"amPm",value:b(c=>c.value,[P],"p0.value"),class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-2 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm","aria-label":"AM/PM",onChange$:f("s_3bfuLUOUpOg",[P,T,k,_,O,U])},[e("option",null,{value:"AM"},"AM",3,null),e("option",null,{value:"PM"},"PM",3,null)],3,null)],3,"Lq_34"),e("div",null,{class:"flex-1"},[e("label",null,{for:"payment_minute",class:"block text-xs font-medium text-slate-600 dark:text-slate-400 mb-1"},"Minutos",3,null),e("select",null,{id:"payment_minute",name:"customMinute",value:b(c=>c.value.toString(),[k],"p0.value.toString()"),class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-2 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm","aria-label":"Minute",onChange$:f("s_kwwhw0cdHZI",[P,T,k,_,O,x,U])},[e("option",null,{value:"0"},"00",3,null),e("option",null,{value:"15"},"15",3,null),e("option",null,{value:"30"},"30",3,null),e("option",null,{value:"45"},"45",3,null)],3,null)],3,null)],1,null),e("div",null,{class:"flex items-center mt-2"},[e("input",null,{id:"toggle-time-format",type:"checkbox",checked:b(c=>c.value==="12h",[x],'p0.value==="12h"'),class:"h-4 w-4 text-teal-500 focus:ring-teal-400 border-gray-300 rounded",onChange$:f("s_3eK2J7tIt04",[P,T,x])},null,3,null),e("label",null,{for:"toggle-time-format",class:"ml-2 text-xs text-slate-600 dark:text-slate-400 select-none"},"Usar formato 12h (AM/PM)",3,null)],3,null)],1,null),e("p",null,{class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},["Selecciona la fecha y hora exacta para el pago o automatización.",e("br",null,null,null,3,null),e("b",null,null,"Zona horaria local:",3,null)," ",q," | ",e("b",null,null,"UTC:",3,null)," ",O.value?O.value.toUTCString():"-"],1,null),U.value&&e("div",null,{class:"mt-1 text-xs text-red-600 dark:text-red-400 font-semibold"},b(c=>c.value,[U],"p0.value"),3,"Lq_35")],1,null),e("div",null,{class:"pt-2 pb-1"},[e("div",null,{class:"flex items-center"},[e("input",null,{type:"checkbox",id:"autoSchedule",checked:b(c=>c.value,[le],"p0.value"),class:"h-4 w-4 text-teal-500 focus:ring-teal-400 border-gray-300 rounded",onChange$:f("s_Lb57FX9QzEM",[le])},null,3,null),e("label",null,{for:"autoSchedule",class:"ml-2 block text-sm font-medium text-slate-700 dark:text-slate-300"},"Automatizar pago con TimeLock",3,null)],3,null),e("p",null,{class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},"Al habilitar esta opción, el pago se programará automáticamente en la blockchain",3,null)],3,null),le.value&&e("div",null,{class:"p-3 bg-teal-50 dark:bg-teal-900/20 rounded-lg border border-teal-100 dark:border-teal-800/30"},[e("div",null,{class:"p-2 flex items-center"},[i(pl,{class:"h-5 w-5 text-teal-600 dark:text-teal-400 mr-2",[s]:{class:s}},3,"Lq_36"),e("p",null,{class:"text-sm text-teal-700 dark:text-teal-300"},"El pago se programará automáticamente para la fecha de vencimiento y hora seleccionadas arriba.",3,null)],1,null),e("div",null,{class:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800/30 rounded-lg"},e("div",null,{class:"flex items-center"},[i(Pe,{class:"h-4 w-4 text-blue-600 dark:text-blue-400 mr-2",[s]:{class:s}},3,"Lq_37"),e("p",null,{class:"text-xs text-blue-700 dark:text-blue-300"},[e("span",null,{class:"font-semibold"},"Fecha de ejecución:",3,null)," ",b(c=>c.value,[_],"p0.value")," a las ",T.value.toString().padStart(2,"0"),":",k.value.toString().padStart(2,"0")],1,null)],1,null),1,null),e("input",null,{type:"hidden",name:"autoScheduleTime",value:"duedate"},null,3,null),x.value==="12h"&&e("input",null,{type:"hidden",name:"amPm",value:b(c=>c.value,[P],"p0.value")},null,3,"Lq_38")],1,"Lq_39"),e("div",null,null,[e("label",null,{for:"description",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Description",3,null),e("textarea",null,{name:"description",id:"description",rows:3,value:J,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_0g53Fas7k3k",[J])},null,3,null)],3,null),e("input",null,{type:"hidden",name:"autoSchedulePayment",value:b(c=>c.value.toString(),[le],"p0.value.toString()")},null,3,null),e("input",null,{type:"hidden",name:"autoScheduleTime",value:b(c=>c.value,[I],"p0.value")},null,3,null),e("input",null,{type:"hidden",name:"customDate",value:b(c=>c.value,[E],"p0.value")},null,3,null),e("input",null,{type:"hidden",name:"customHour",value:b(c=>c.value.toString(),[T],"p0.value.toString()")},null,3,null),x.value==="12h"&&e("input",null,{type:"hidden",name:"amPm",value:b(c=>c.value,[P],"p0.value")},null,3,"Lq_40"),e("input",null,{type:"hidden",name:"customMinute",value:b(c=>c.value.toString(),[k],"p0.value.toString()")},null,3,null),e("input",null,{type:"hidden",name:"timezone",value:b(c=>c.value,[D],"p0.value")},null,3,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 flex justify-between items-center"},[e("div",null,null,K.value&&i(H,{action:n,class:"inline-block",children:[e("input",null,{type:"hidden",name:"id",value:b(c=>c.value,[K],"p0.value")},null,3,null),e("button",null,{type:"submit",class:"inline-flex items-center text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400 font-medium text-sm"},[i(de,{class:"h-4 w-4 mr-1.5",[s]:{class:s}},3,"Lq_41")," Delete"],1,null)],[s]:{action:s,class:s}},1,"Lq_42"),1,null),e("div",null,{class:"flex items-center"},[e("button",null,{type:"button",class:"inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto sm:text-sm transition-all",onClick$:f("s_jJbiMziovcs",[G])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_43")," Cancel"],1,null),e("button",{class:`ml-3 w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 ${le.value?"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700":"bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700"} text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto sm:text-sm transition-all disabled:opacity-50`},{type:"submit",disabled:b((c,F)=>c.isRunning||!!F.value,[t,U],"p0.isRunning||!!p1.value")},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_44"):le.value?i(ue,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_45"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_46"),b((c,F)=>c.value?"Programar Pago para el "+F.value:"Guardar Pago Manual",[le,_],'p0.value?"Programar Pago para el "+p1.value:"Guardar Pago Manual"')],1,null)],1,null)],1,null),((tl=t.value)==null?void 0:tl.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_47")," ",b(c=>c.value.error,[t],"p0.value.error")],1,"Lq_48"),t.value&&"warning"in t.value&&t.value.warning?e("div",null,{class:"p-4 bg-amber-50 text-amber-700 rounded-b-lg border-t border-amber-200"},[i(Tl,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_49")," ",String(t.value.warning)],1,"Lq_50"):null],[s]:{action:s,onSubmit$:s,onSubmitCompleted$:s}},1,"Lq_51"),1,null)],1,null),1,"Lq_52"),w.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_6wIlJegccMM",[d,w])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100 flex items-center"},[i(re,{class:"inline-block h-6 w-6 mr-2 text-indigo-600 dark:text-indigo-400",[s]:{class:s}},3,"Lq_53"),"Seleccionar Tiempo de Liberación"],1,null),((sl=d.value)==null?void 0:sl.professional_wallet)&&e("div",null,{class:"mt-3 flex items-center p-3 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800/30"},[i(ke,{class:"h-5 w-5 text-indigo-500 dark:text-indigo-400 mr-2",[s]:{class:s}},3,"Lq_54"),e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet del Profesional:",3,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 font-mono"},b(c=>c.value.professional_wallet,[d],"p0.value.professional_wallet"),3,null)],3,null)],1,"Lq_55"),e("div",null,{class:"mt-4"},[e("p",null,{class:"text-sm text-slate-600 dark:text-slate-300 mb-3"},"Selecciona cuándo se liberarán los fondos al profesional:",3,null),e("div",null,{class:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-4"},[e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${h.value==="30 minutos"?"bg-indigo-100 text-indigo-700 border-2 border-indigo-400 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_Ze3QErnowb8",[Re])},"30 minutos",3,null),e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${h.value==="1 hora"?"bg-indigo-100 text-indigo-700 border-2 border-indigo-400 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_aO60VWamaUM",[Re])},"1 hora",3,null),e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${h.value==="1 día"?"bg-indigo-100 text-indigo-700 border-2 border-indigo-400 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_XFbGPComnw4",[Re])},"1 día",3,null),e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${h.value==="1 semana"?"bg-indigo-100 text-indigo-700 border-2 border-indigo-400 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_0JJ5zRN1tjs",[Re])},"1 semana",3,null),e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${h.value==="1 mes"?"bg-indigo-100 text-indigo-700 border-2 border-indigo-400 dark:bg-indigo-900/40 dark:text-indigo-300 dark:border-indigo-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_sv2bSDDT6SQ",[Re])},"1 mes",3,null),e("button",{class:`px-3 py-2 rounded-lg text-sm font-medium ${L.value?"bg-purple-100 text-purple-700 border-2 border-purple-400 dark:bg-purple-900/40 dark:text-purple-300 dark:border-purple-700":"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:text-slate-200 dark:hover:bg-slate-600"}`},{onClick$:f("s_zGKfsK0iz4Y",[E,T,k,p,L])},e("span",null,{class:"flex items-center justify-center"},[i(re,{class:"h-4 w-4 mr-1.5",[s]:{class:s}},3,"Lq_56"),"Personalizado"],1,null),1,null)],1,null),L.value&&e("div",null,{class:"mb-4 p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800/30"},[e("h4",null,{class:"font-medium text-purple-800 dark:text-purple-300 mb-3"},"Selecciona fecha y hora exactas",3,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},[e("div",null,null,[e("label",null,{class:"block text-sm text-slate-600 dark:text-slate-400 mb-1"},"Fecha",3,null),e("input",null,{type:"date",value:b(c=>c.value,[E],"p0.value"),class:"w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",min:new Date().toISOString().split("T")[0],onChange$:f("s_B7G8n2bJSvI",[E,Fe])},null,3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm text-slate-600 dark:text-slate-400 mb-1"},"Hora",3,null),e("select",null,{value:b(c=>c.value.toString(),[T],"p0.value.toString()"),class:"w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",onChange$:f("s_3NVpsdmo8yI",[T,Fe])},Array.from({length:24},(c,F)=>F).map(c=>e("option",{value:c},null,c.toString().padStart(2,"0"),1,c)),1,null)],1,null),e("div",null,null,[e("label",null,{class:"block text-sm text-slate-600 dark:text-slate-400 mb-1"},"Minutos",3,null),e("select",null,{value:b(c=>c.value.toString(),[k],"p0.value.toString()"),class:"w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",onChange$:f("s_dIHO0C9fZg8",[k,Fe])},[e("option",null,{value:"0"},"00",3,null),e("option",null,{value:"15"},"15",3,null),e("option",null,{value:"30"},"30",3,null),e("option",null,{value:"45"},"45",3,null)],3,null)],3,null)],1,null),e("div",null,{class:"mt-3 text-sm text-purple-700 dark:text-purple-300"},[e("p",null,null,["Tiempo seleccionado: ",e("span",null,{class:"font-semibold"},b(c=>c.value||"-",[h],'p0.value||"-"'),3,null)],3,null),e("p",null,{class:"text-xs text-purple-600 dark:text-purple-400 mt-1"},[i(pl,{class:"inline-block h-3.5 w-3.5 mr-1",[s]:{class:s}},3,"Lq_57"),"El tiempo mínimo para la liberación es de 30 minutos desde ahora"],1,null)],1,null)],1,"Lq_58"),e("div",null,{class:"mb-4 space-y-3"},[((al=d.value)==null?void 0:al.currency)&&e("div",null,{class:"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-lg flex items-start"},[i(ue,{class:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0",[s]:{class:s}},3,"Lq_59"),e("div",null,null,[e("p",null,{class:"font-medium"},["Token seleccionado: ",b(c=>c.value.currency,[d],"p0.value.currency")],3,null),d.value.currency==="KNRT"&&e("p",null,{class:"text-sm mt-1"},"KNRT - Konecta Real Estate Token",3,"Lq_60")],1,null)],1,"Lq_61"),((nl=t.value)==null?void 0:nl.releaseTimestamp)&&e("div",null,{class:"p-3 bg-teal-50 dark:bg-teal-900/20 text-teal-700 dark:text-teal-300 rounded-lg flex items-start"},[i(re,{class:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0",[s]:{class:s}},3,"Lq_62"),e("div",null,null,[e("p",null,{class:"font-medium"},["Tiempo de liberación: ",t.value.releaseDescription||Me(t.value.releaseTimestamp)],1,null),e("p",null,{class:"text-sm mt-1"},["El pago se desbloqueará automáticamente el: ",Me(t.value.releaseTimestamp)],1,null)],1,null)],1,"Lq_63"),!((rl=t.value)!=null&&rl.releaseTimestamp)&&p.value&&e("div",null,{class:"p-3 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 rounded-lg flex items-start"},[i(_e,{class:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0",[s]:{class:s}},3,"Lq_64"),e("div",null,null,[e("p",null,{class:"font-medium"},["Tiempo seleccionado: ",b(c=>c.value,[h],"p0.value")],3,null),e("p",null,{class:"text-sm mt-1"},["Los fondos se liberarán el: ",Me(p.value)],1,null)],1,null)],1,"Lq_65")],1,null),e("div",null,{class:"p-3 bg-slate-50 dark:bg-slate-700/30 rounded-lg flex items-start"},[e("div",null,{class:"flex items-center h-5"},e("input",null,{id:"use-due-date",type:"checkbox",checked:b(c=>c.value===null,[p],"p0.value===null"),class:"h-4 w-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500",onClick$:f("s_lcqdMwMtCTw",[p,h])},null,3,null),3,null),e("label",null,{for:"use-due-date",class:"ml-3 text-sm"},[e("span",null,{class:"font-medium text-slate-700 dark:text-slate-300"},"Usar fecha de vencimiento original",3,null),((ol=d.value)==null?void 0:ol.due_date)&&e("p",null,{class:"text-slate-500 dark:text-slate-400"},new Date(d.value.due_date).toLocaleDateString(),1,"Lq_66")],1,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 flex justify-between"},[e("button",null,{type:"button",class:"inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto sm:text-sm transition-all",onClick$:f("s_npouJnMOm4M",[d,p,h,w])},[i(oe,{class:"h-4 w-4 mr-2",[s]:{class:s}},3,"Lq_67"),"Cancelar"],1,null),e("button",null,{type:"button",class:"inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto sm:text-sm",onClick$:f("s_005kdQT1l0Q",[d,yt])},[i(ue,{class:"h-4 w-4 mr-2",[s]:{class:s}},3,"Lq_68"),"Crear TimeLock"],1,null)],1,null)],1,null)],1,null),1,"Lq_69"),m.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_taNzlwLxTYo",[d,m])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},[e("div",null,{class:"p-6"},[e("div",null,{class:"sm:flex sm:items-start"},o.error.value?i(xe,{children:[e("div",null,{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 sm:mx-0 sm:h-10 sm:w-10"},e("svg",null,{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-600 dark:text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e("path",null,{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,3,null),3,null),3,null),e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},[e("h3",null,{class:"text-lg leading-6 font-medium text-slate-900 dark:text-slate-100"},"Error al crear el TimeLock",3,null),e("div",null,{class:"mt-2"},[e("p",null,{class:"text-sm text-slate-500 dark:text-slate-400"},b(c=>c.error.value,[o],"p0.error.value"),3,null),o.error.value.includes("MetaMask")&&e("div",null,{class:"mt-3 p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg text-xs"},[e("p",null,{class:"font-medium mb-1 text-slate-700 dark:text-slate-300"},"Posibles soluciones:",3,null),e("ul",null,{class:"list-disc list-inside space-y-1 text-slate-600 dark:text-slate-400"},[e("li",null,null,"Verifica que la extensión de MetaMask está instalada en tu navegador",3,null),e("li",null,null,"Asegúrate de que tu wallet esté desbloqueada",3,null),e("li",null,null,'Intenta conectarte nuevamente haciendo clic en el botón "Conectar Wallet"',3,null),e("li",null,null,"Si el problema persiste, recarga la página e intenta de nuevo",3,null)],3,null),e("button",null,{class:"mt-2 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs flex items-center",onClick$:f("s_6JD0VeC6ZDc",[o])},[i(ke,{class:"w-3 h-3 mr-1",[s]:{class:s}},3,"Lq_70"),"Conectar Wallet"],1,null)],1,"Lq_71")],1,null)],1,null)]},1,"Lq_72"):o.status.value.includes("Lock creado")?i(xe,{children:[e("div",null,{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30 sm:mx-0 sm:h-10 sm:w-10"},e("svg",null,{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-green-600 dark:text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},e("path",null,{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,3,null),3,null),3,null),e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},[e("h3",null,{class:"text-lg leading-6 font-medium text-slate-900 dark:text-slate-100"},"TimeLock Creado Exitosamente",3,null),e("div",null,{class:"mt-2"},[e("p",null,{class:"text-sm text-slate-500 dark:text-slate-400"},"El pago ha sido programado con éxito en el contrato inteligente.",3,null),d.value&&e("div",null,{class:"mt-3 p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg text-xs"},[e("div",null,null,[e("span",null,{class:"font-medium"},"Profesional:",3,null)," ",b(c=>c.value.professional_name,[d],"p0.value.professional_name")],3,null),e("div",null,null,[e("span",null,{class:"font-medium"},"Wallet:",3,null)," ",b(c=>c.value.professional_wallet,[d],"p0.value.professional_wallet")],3,null),e("div",null,null,[e("span",null,{class:"font-medium"},"Monto:",3,null)," ",b(c=>c.value.amount,[d],"p0.value.amount")," ",b(c=>c.value.currency,[d],"p0.value.currency")],3,null),e("div",null,null,[e("span",null,{class:"font-medium"},"Fecha de liberación:",3,null)," ",new Date(d.value.due_date).toLocaleDateString()],1,null)],1,"Lq_73")],1,null)],1,null)]},1,"Lq_74"):i(xe,{children:[e("div",null,{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900/30 sm:mx-0 sm:h-10 sm:w-10"},e("svg",null,{class:"animate-spin h-6 w-6 text-blue-600 dark:text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",null,{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,3,null),e("path",null,{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,3,null)],3,null),3,null),e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},[e("h3",null,{class:"text-lg leading-6 font-medium text-slate-900 dark:text-slate-100"},b(c=>c.status.value||"Creando TimeLock",[o],'p0.status.value||"Creando TimeLock"'),3,null),e("div",null,{class:"mt-2"},[e("p",null,{class:"text-sm text-slate-500 dark:text-slate-400"},"Por favor, confirma la transacción en MetaMask...",3,null),o.address.value&&e("div",null,{class:"mt-3 p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg text-xs"},[e("div",null,null,[e("span",null,{class:"font-medium"},"Wallet conectada:",3,null)," ",b(c=>c.address.value,[o],"p0.address.value")],3,null),d.value&&i(xe,{children:[e("div",null,null,[e("span",null,{class:"font-medium"},"Profesional:",3,null)," ",b(c=>c.value.professional_name,[d],"p0.value.professional_name")],3,null),e("div",null,null,[e("span",null,{class:"font-medium"},"Monto:",3,null)," ",b(c=>c.value.amount,[d],"p0.value.amount")," ",b(c=>c.value.currency,[d],"p0.value.currency")],3,null)]},3,"Lq_75")],1,"Lq_76")],1,null)],1,null)]},1,"Lq_77"),1,null),e("div",null,{class:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-base font-medium text-white hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick$:f("s_LKxc8A0Tkf0",[m,o])},"Cerrar",3,null),o.error.value&&o.error.value.includes("MetaMask")&&e("button",null,{type:"button",class:"mt-3 sm:mt-0 w-full inline-flex justify-center rounded-md border border-blue-500 px-4 py-2 bg-white text-base font-medium text-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick$:f("s_epxFlGxeDkk",[o])},[i(ke,{class:"w-4 h-4 mr-1",[s]:{class:s}},3,"Lq_78"),"Conectar MetaMask"],1,"Lq_79")],1,null)],1,null),e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100"},[i(ue,{class:"inline-block h-6 w-6 mr-2 text-indigo-600 dark:text-indigo-400",[s]:{class:s}},3,"Lq_80"),"Estado del TimeLock"],1,null),((ul=d.value)==null?void 0:ul.professional_wallet)&&e("div",null,{class:"mt-3 flex items-center p-3 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800/30"},[i(ke,{class:"h-5 w-5 text-indigo-500 dark:text-indigo-400 mr-2",[s]:{class:s}},3,"Lq_81"),e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet del Profesional:",3,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 font-mono"},b(c=>c.value.professional_wallet,[d],"p0.value.professional_wallet"),3,null)],3,null)],1,"Lq_82"),e("div",null,{class:"mt-4 p-4 rounded-lg bg-slate-50 dark:bg-slate-700/30"},o.error.value?e("div",null,{class:"text-red-600 dark:text-red-400"},[i(se,{class:"inline-block h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_83"),b(c=>c.error.value,[o],"p0.error.value")],1,"Lq_84"):o.status.value?e("div",null,{class:"text-green-600 dark:text-green-400"},[i(_e,{class:"inline-block h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_85"),b(c=>c.status.value,[o],"p0.status.value")],1,"Lq_86"):e("div",null,{class:"text-slate-600 dark:text-slate-300 flex items-center"},[i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"Lq_87"),"Procesando operación..."],1,null),1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 flex justify-end"},e("button",null,{type:"button",class:"inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto sm:text-sm transition-all",onClick$:f("s_i5m30LwI5ec",[d,m,u])},"Cerrar",3,null),3,null)],1,null)],1,null),1,"Lq_88")],1,"Lq_89")},Ba=V(g(qa,"s_Yu2aZKZZKQY")),Ha=Object.freeze(Object.defineProperty({__proto__:null,_auto_getTokenAddress:$e,default:Ba,useAuthLoader:Ql,useDeletePayment:Vl,usePaymentsLoader:Gl,useProcessPayment:Xl,useSavePayment:Wl,useUpdateTimelockTransaction:Kl},Symbol.toStringTag,{value:"Module"})),Ya=async l=>{const t=M(l),a=new URL(l.request.url),n=new Date,r=parseInt(a.searchParams.get("year")||n.getFullYear().toString()),o=parseInt(a.searchParams.get("month")||(n.getMonth()+1).toString()),u=`${r}-${String(o).padStart(2,"0")}-01`,d=new Date(r,o,0),m=`${r}-${String(o).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`,w=(await t.execute({sql:`
    SELECT 
      i.id,
      p.name as professional_name,
      i.amount,
      i.currency,
      i.status,
      i.issue_date as due_date
    FROM invoices i
    JOIN professionals p ON i.professional_id = p.id
    WHERE i.issue_date >= ? AND i.issue_date <= ?
    ORDER BY i.issue_date ASC
  `,args:[u,m]})).rows.map(L=>({...L,amount:Number(L.amount)})),E=d.getDate(),T=new Date(r,o-1,1).getDay(),k=[];for(let L=0;L<T;L++)k.push({day:null,payments:[]});for(let L=1;L<=E;L++){const D=`${r}-${String(o).padStart(2,"0")}-${String(L).padStart(2,"0")}`,N=w.filter(O=>O.due_date===D);k.push({day:L,payments:N})}return{payments:w,calendarData:k,currentMonth:o,currentYear:r}},Zl=Y(g(Ya,"s_KLgGdYv9ffA")),za=l=>{const[t]=A();let a=t.month,n=t.year;l==="prev"?(a--,a<1&&(a=12,n--)):(a++,a>12&&(a=1,n++));const r=new URL(window.location.href);r.searchParams.set("month",String(a)),r.searchParams.set("year",String(n)),window.location.href=r.toString()},Ga=()=>{const l=Zl(),t=hl({month:l.value.currentMonth,year:l.value.currentYear}),a=l.value.payments.reduce((d,m)=>d+m.amount,0),n=l.value.payments.filter(d=>d.status==="pending").reduce((d,m)=>d+m.amount,0),r=g(za,"s_SydKp69OxJo",[t]),o=d=>new Date(t.year,d-1,1).toLocaleString("en-US",{month:"long"}),u=(d,m)=>{if(d===null)return"bg-slate-50 dark:bg-slate-800/50 opacity-50";const p=new Date;p.setHours(0,0,0,0);const h=new Date(t.year,t.month-1,d);let w="bg-white dark:bg-slate-800";h.getTime()<p.getTime()&&(w="bg-slate-100 dark:bg-slate-800/70"),h.getTime()===p.getTime()&&(w="bg-teal-50 dark:bg-teal-900/30 border-teal-400 dark:border-teal-600");const E=m.some(k=>k.status==="pending"),T=m.some(k=>k.status==="paid");return E?`${w} border-l-4 border-amber-400 dark:border-amber-500`:T?`${w} border-l-4 border-emerald-400 dark:border-emerald-500`:w};return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(Pe,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"Zl_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Payment Planner",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Visualize your monthly financial commitments",3,null)],3,null)],1,null),e("div",null,{class:"flex items-center space-x-2 mt-4 sm:mt-0"},[e("div",null,{class:"inline-flex items-center space-x-1.5 text-xs"},[e("span",null,{class:"w-3 h-3 inline-block bg-amber-400 rounded-full"},null,3,null),e("span",null,{class:"text-slate-600 dark:text-slate-300"},"Pending",3,null)],3,null),e("div",null,{class:"inline-flex items-center space-x-1.5 text-xs"},[e("span",null,{class:"w-3 h-3 inline-block bg-emerald-400 rounded-full"},null,3,null),e("span",null,{class:"text-slate-600 dark:text-slate-300"},"Paid",3,null)],3,null)],3,null)],1,null),1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Payments This Month",3,null),e("p",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-200"},b(d=>d.value.payments.length,[l],"p0.value.payments.length"),3,null)],3,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Amount",3,null),e("p",null,{class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},ce(n,"USD"),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Amount",3,null),e("p",null,{class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},ce(a,"USD"),1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700"},[e("button",null,{class:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",onClick$:f("s_yEUHrZlk7e8",[r])},i(Ke,{class:"h-5 w-5 text-slate-600 dark:text-slate-300",[s]:{class:s}},3,"Zl_1"),1,null),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},[o(t.month)," ",b(d=>d.year,[t],"p0.year")],1,null),e("button",null,{class:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",onClick$:f("s_9lirksKinnQ",[r])},i(Ve,{class:"h-5 w-5 text-slate-600 dark:text-slate-300",[s]:{class:s}},3,"Zl_2"),1,null)],1,null),e("div",null,{class:"grid grid-cols-7"},[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(d=>e("div",null,{class:"p-2 text-center text-xs font-medium text-slate-500 dark:text-slate-400 border-b border-r border-slate-100 dark:border-slate-700"},d,1,d)),l.value.calendarData.map((d,m)=>e("div",{class:`p-2 border-b border-r border-slate-100 dark:border-slate-700 min-h-[120px] transition-colors duration-300 ${u(d.day,d.payments)}`},null,[d.day!==null&&e("div",null,{class:"text-sm font-semibold text-slate-700 dark:text-slate-200"},R(d,"day"),1,"Zl_3"),e("div",null,{class:"mt-1 space-y-1"},d.payments.map(p=>e("div",{class:`text-xs p-1.5 rounded-lg shadow-sm ${p.status==="paid"?"bg-emerald-50 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300":"bg-amber-50 text-amber-800 dark:bg-amber-900/50 dark:text-amber-300"}`,title:`${p.professional_name}: ${ce(p.amount,p.currency)}`},null,[e("div",null,{class:"font-bold truncate"},R(p,"professional_name"),1,null),e("div",null,{class:"font-medium"},ce(p.amount,p.currency),1,null)],1,p.id)),1,null)],1,m))],1,null)],1,null)],1,null),1,"Zl_4")},Wa=V(g(Ga,"s_SibSP8O5TQA")),Xa=Object.freeze(Object.defineProperty({__proto__:null,default:Wa,usePaymentPlannerLoader:Zl},Symbol.toStringTag,{value:"Module"})),Ka=async l=>{const t=await $(l);if(!(t!=null&&t.isAuthenticated))throw l.redirect(302,"/auth");return t},Jl=Y(g(Ka,"s_6l7uYMCB50c")),Va=async l=>(await ae(l),(await M(l).execute("SELECT id, name, role, email, phone, wallet FROM professionals ORDER BY name")).rows),et=Y(g(Va,"s_9ghkRguhPB4")),Qa=async(l,t)=>{await ae(t);const a=M(t),n=await $(t);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{return await a.execute({sql:"INSERT INTO professionals (user_id, name, role, email, phone, wallet) VALUES (?, ?, ?, ?, ?, ?)",args:[n.userId,l.name??"",l.role??"",l.email??"",l.phone??"",l.wallet??""]}),{success:!0}}catch(r){return console.error("Failed to add professional:",r),{success:!1,error:"Failed to add professional."}}},Za={name:y.string().min(3,"Name must be at least 3 characters."),role:y.string().min(3,"Role must be at least 3 characters."),email:y.string().email("Please enter a valid email.").optional().or(y.literal("")),phone:y.string().optional(),wallet:y.string().optional()},lt=B(g(Qa,"s_ewYr998vpGU"),Q(g(Za,"s_W0H0hD8VHsM"))),Ja=async(l,t)=>{var r,o;await ae(t);const a=M(t),n=await $(t);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{const u=await a.execute({sql:"SELECT user_id FROM professionals WHERE id = ?",args:[l.id]});if(u.rows.length===0)return{success:!1,error:"Professional not found."};const m=(r=(await a.execute({sql:"SELECT email FROM users WHERE id = ?",args:[n.userId]})).rows[0])==null?void 0:r.email,p=u.rows[0].user_id;if(m!=="admin@gmail.com"&&p!==n.userId)return{success:!1,error:"You do not have permission to delete this professional."};const h=await a.execute({sql:"SELECT COUNT(*) as count FROM payments WHERE professional_id = ?",args:[l.id]});return Number(((o=h.rows[0])==null?void 0:o.count)||0)>0?{success:!1,error:"Cannot delete a professional with associated payments."}:(await a.execute({sql:"DELETE FROM professionals WHERE id = ?",args:[l.id]}),{success:!0})}catch(u){return console.error("Failed to delete professional:",u),{success:!1,error:"Failed to delete professional."}}},en={id:y.coerce.number()},tt=B(g(Ja,"s_PF9CMJpbl0s"),Q(g(en,"s_T3PAvZb0J0k"))),ln=async(l,t)=>{var r;await ae(t);const a=M(t),n=await $(t);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{const o=await a.execute({sql:"SELECT user_id FROM professionals WHERE id = ?",args:[l.id]});if(o.rows.length===0)return{success:!1,error:"Professional not found."};const d=(r=(await a.execute({sql:"SELECT email FROM users WHERE id = ?",args:[n.userId]})).rows[0])==null?void 0:r.email,m=o.rows[0].user_id;return d!=="admin@gmail.com"&&m!==n.userId?{success:!1,error:"You do not have permission to edit this professional."}:(await a.execute({sql:"UPDATE professionals SET name = ?, role = ?, email = ?, phone = ?, wallet = ? WHERE id = ?",args:[l.name??"",l.role??"",l.email??"",l.phone??"",l.wallet??"",l.id]}),{success:!0})}catch(o){return console.error("Failed to edit professional:",o),{success:!1,error:"Failed to edit professional."}}},tn={id:y.coerce.number(),name:y.string().min(3,"Name must be at least 3 characters."),role:y.string().min(3,"Role must be at least 3 characters."),email:y.string().email("Please enter a valid email.").optional().or(y.literal("")),phone:y.string().optional(),wallet:y.string().optional()},st=B(g(ln,"s_dOwNrTSENvc"),Q(g(tn,"s_HBjaONcPEVA"))),sn=({track:l})=>{const[t,a]=A();l(()=>a.value),t.value=a.value},an=l=>{const[t,a,n,r,o,u,d]=A();a.value=l.id,n.value=l.name,o.value=l.role,t.value=l.email||"",r.value=l.phone||"",u.value=l.wallet||"",d.value=!0},nn=()=>{const[l,t,a]=A();if(!a.value){l.value=t.value;return}const n=a.value.toLowerCase();l.value=t.value.filter(r=>r.name.toLowerCase().includes(n)||r.role.toLowerCase().includes(n))},rn=()=>{var d;const[l,t,a,n,r,o,u]=A();(d=l.value)!=null&&d.success&&(o.value=!1,a.value="",r.value="",t.value="",n.value="",u.value="")},on=()=>{var a;const[l,t]=A();(a=l.value)!=null&&a.success&&(t.value=!1)},un=()=>{var n;const[l,t,a]=A();(n=l.value)!=null&&n.success&&(a.value=!1,t.value=null)},dn=()=>{var P,G,K,W,Z,te,ne,_,J,ie,le;z(),Jl();const l=et(),t=lt(),a=st(),n=tt(),r=v(""),o=v(!1),u=v(!1),d=v(!1),m=v(null),p=v(""),h=v(""),w=v(""),E=v(""),T=v(""),k=v(null),L=v(""),D=v(""),N=v(""),O=v(""),U=v(""),q=v(l.value);Ce(g(sn,"s_kB3Dg4UqAn0",[q,l]));const S=g(an,"s_NpfzvKQlomg",[N,k,L,O,D,U,u]),x=g(nn,"s_gzBsbP7L8is",[q,l,r]);return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(ge,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"3n_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Professionals",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Freelancer management",3,null)],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3"},[e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:f("s_eoeiqcBEHfA",[o])},[i(Ee,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"3n_1"),"Add Professional"],1,null),e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[i(El,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"3n_2"),"Export"],1,null)],1,null)],1,null),1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i(Ze,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"3n_3"),1,null),e("input",null,{type:"text",value:b(I=>I.value,[r],"p0.value"),class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by name or role...",onInput$:f("s_pQ7saR2vT2Q",[r,x])},null,3,null)],1,null),e("div",null,{class:"flex-shrink-0"},e("button",null,{class:"inline-flex items-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[i(Qe,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"3n_4"),"Filter"],1,null),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Name",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Role",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Contact",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},q.value.map(I=>e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800 dark:text-slate-100"},R(I,"name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},R(I,"role"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},[e("div",null,null,R(I,"email"),1,null),e("div",null,null,R(I,"phone"),1,null)],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[e("button",null,{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all"},i(Ie,{class:"h-5 w-5",[s]:{class:s}},3,"3n_5"),1,null),e("button",{onClick$:f("s_yNzzDuBT0os",[S,I])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all"},i(je,{class:"h-5 w-5",[s]:{class:s}},3,"3n_6"),0,null),e("button",{onClick$:f("s_76pej4xkv8c",[I,m,d])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all"},i(de,{class:"h-5 w-5",[s]:{class:s}},3,"3n_7"),0,null)],1,null),1,null)],1,I.id)),1,null)],1,null),1,null),q.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},[e("div",null,{class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-4"},i(ge,{class:"w-8 h-8 text-slate-400 dark:text-slate-500",[s]:{class:s}},3,"3n_8"),1,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No professionals found.",3,null),e("p",null,{class:"text-slate-400 dark:text-slate-500 mt-1 text-sm"},"Add a new professional to get started.",3,null)],1,"3n_9")],1,null),e("div",null,{class:"flex items-center justify-between mt-6 bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-slate-100 dark:border-slate-700"},e("div",null,{class:"text-sm text-slate-600 dark:text-slate-400"},["Showing ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(I=>I.value.length,[q],"p0.value.length"),3,null)," of ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(I=>I.value.length,[l],"p0.value.length"),3,null)," professionals"],3,null),3,null)],1,null),o.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_TmJ39fMCzuM",[o])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:t,onSubmitCompleted$:g(rn,"s_9kOa6fjVAlU",[t,w,p,E,h,o,T]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},e("div",null,{class:"sm:flex sm:items-start"},e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Add New Professional",3,null),e("div",null,{class:"mt-4"},e("div",null,{class:"space-y-4"},[e("div",null,null,[e("label",null,{for:"name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Full Name",3,null),e("input",null,{type:"text",name:"name",id:"name",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:f("s_GVdHcpX68tA",[p])},null,3,null),((G=(P=t.value)==null?void 0:P.fieldErrors)==null?void 0:G.name)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(I=>I.value.fieldErrors.name,[t],"p0.value.fieldErrors.name"),3,"3n_10")],1,null),e("div",null,null,[e("label",null,{for:"role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("input",null,{type:"text",name:"role",id:"role",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",placeholder:"e.g., Frontend Developer",required:!0,onInput$:f("s_jAxO9x2uMs4",[h])},null,3,null),((W=(K=t.value)==null?void 0:K.fieldErrors)==null?void 0:W.role)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(I=>I.value.fieldErrors.role,[t],"p0.value.fieldErrors.role"),3,"3n_11")],1,null),e("div",null,null,[e("div",null,null,[e("label",null,{for:"wallet",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet (optional)",3,null),e("input",null,{type:"text",name:"wallet",id:"wallet",value:T,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",placeholder:"Wallet address or ID",onInput$:f("s_lbSNTM5SAhM",[T])},null,3,null),((te=(Z=t.value)==null?void 0:Z.fieldErrors)==null?void 0:te.wallet)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(I=>I.value.fieldErrors.wallet,[t],"p0.value.fieldErrors.wallet"),3,"3n_12")],1,null),e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"email",value:w,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_DyU1DEK6eOo",[w])},null,3,null),((_=(ne=t.value)==null?void 0:ne.fieldErrors)==null?void 0:_.email)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(I=>I.value.fieldErrors.email,[t],"p0.value.fieldErrors.email"),3,"3n_13")],1,null),e("div",null,null,[e("label",null,{for:"phone",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Phone",3,null),e("input",null,{type:"tel",name:"phone",id:"phone",value:E,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_NWWIOlSD3Rw",[E])},null,3,null)],3,null)],1,null),1,null)],1,null),1,null),1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(I=>I.isRunning,[t],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"3n_14"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_15"),"Save Professional"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_NLbcS0Hh0oA",[o])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_16"),"Cancel"],1,null)],1,null),((J=t.value)==null?void 0:J.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"3n_17"),b(I=>I.value.error,[t],"p0.value.error")],1,"3n_18")],[s]:{action:s,onSubmitCompleted$:s}},1,"3n_19"),1,null)],1,null),1,"3n_20"),u.value&&e("div",null,{class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},[e("div",null,{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick$:f("s_Fw4HsovHP9U",[u])},null,3,null),e("div",null,{class:"relative bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 sm:mx-auto z-10 overflow-hidden"},[e("div",null,{class:"bg-gradient-to-r from-blue-500 to-blue-600 py-6 px-6"},[e("h3",null,{class:"text-xl font-semibold text-white flex items-center"},[i(je,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_21"),"Edit Professional"],1,null),e("p",null,{class:"text-blue-100 text-sm mt-1"},"Update the professional's information",3,null)],1,null),i(H,{action:a,onSubmitCompleted$:g(on,"s_mMfvy2XJjqs",[a,u]),children:[e("div",null,{class:"p-6"},e("div",null,{class:"space-y-6"},[e("input",null,{type:"hidden",name:"id",value:b(I=>I.value,[k],"p0.value")},null,3,null),e("div",null,null,[e("label",null,{for:"edit-name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Name",3,null),e("input",null,{type:"text",name:"name",id:"edit-name",value:L,required:!0,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:f("s_0ZBxof0L4gU",[L])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("input",null,{type:"text",name:"role",id:"edit-role",value:D,required:!0,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:f("s_6W3vXIVkP74",[D])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-wallet",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet Address",3,null),e("input",null,{type:"text",name:"wallet",id:"edit-wallet",value:U,placeholder:"0x...",class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all font-mono",onInput$:f("s_ZAfnG9J9o7g",[U])},null,3,null)],3,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"edit-email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"edit-email",value:N,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:f("s_kNAqpYnviD8",[N])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-phone",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Phone",3,null),e("input",null,{type:"tel",name:"phone",id:"edit-phone",value:O,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:f("s_0RnaKJYNBv8",[O])},null,3,null)],3,null)],3,null)],3,null),3,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(I=>I.isRunning,[a],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-base font-medium text-white hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[a.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"3n_22"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_23"),"Update Professional"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_274GbrB0tgE",[u])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_24"),"Cancel"],1,null)],1,null),((ie=a.value)==null?void 0:ie.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"3n_25"),b(I=>I.value.error,[a],"p0.value.error")],1,"3n_26")],[s]:{action:s,onSubmitCompleted$:s}},1,"3n_27")],1,null)],1,"3n_28"),d.value&&e("div",null,{class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},[e("div",null,{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick$:f("s_0ceVdQIKjhg",[d])},null,3,null),e("div",null,{class:"relative bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 sm:mx-auto z-10 overflow-hidden"},[e("div",null,{class:"bg-gradient-to-r from-red-500 to-red-600 py-6 px-6"},[e("h3",null,{class:"text-xl font-semibold text-white flex items-center"},[i(de,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_29"),"Confirm Deletion"],1,null),e("p",null,{class:"text-red-100 text-sm mt-1"},"This action cannot be undone",3,null)],1,null),i(H,{action:n,onSubmitCompleted$:g(un,"s_eem45vjZWkA",[n,m,d]),children:[e("div",null,{class:"p-6"},[e("input",null,{type:"hidden",name:"id",value:b(I=>I.value,[m],"p0.value")},null,3,null),e("div",null,{class:"text-center mb-6"},[e("div",null,{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30"},i(de,{class:"h-6 w-6 text-red-600 dark:text-red-500",[s]:{class:s}},3,"3n_30"),1,null),e("h3",null,{class:"mt-3 text-lg font-medium text-slate-900 dark:text-slate-100"},"Delete Professional",3,null),e("p",null,{class:"mt-2 text-sm text-slate-500 dark:text-slate-400"},"Are you sure you want to delete this professional? This action cannot be undone.",3,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(I=>I.isRunning,[n],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-red-500 to-red-600 text-base font-medium text-white hover:from-red-600 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[n.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"3n_31"):i(de,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_32"),"Delete"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_duhryAVQI0Q",[d])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3n_33"),"Cancel"],1,null)],1,null),((le=n.value)==null?void 0:le.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"3n_34"),b(I=>I.value.error,[n],"p0.value.error")],1,"3n_35")],[s]:{action:s,onSubmitCompleted$:s}},1,"3n_36")],1,null)],1,"3n_37")],1,"3n_38")},cn=V(g(dn,"s_ihBQ0teuNC8")),mn=Object.freeze(Object.defineProperty({__proto__:null,default:cn,useAddProfessional:lt,useAuthLoader:Jl,useDeleteProfessional:tt,useEditProfessional:st,useProfessionalsLoader:et},Symbol.toStringTag,{value:"Module"})),pn=async l=>{const t=await $(l);if(!(t!=null&&t.isAuthenticated)||!be(t))throw l.redirect(302,"/auth");return t},at=Y(g(pn,"s_HEMMVDaKQS8")),fn=async l=>{const t=await $(l);if(!be(t))throw l.fail(401,{error:"Unauthorized"});const r=(await M(l).execute("SELECT * FROM app_settings WHERE id = 1")).rows[0];return{...r,notifications_enabled:!!r.notifications_enabled}},nt=Y(g(fn,"s_OCPwWYs74WM")),xn=async(l,t)=>{const a=await $(t);if(!(a!=null&&a.is_admin))return{success:!1,error:"Unauthorized"};const n=M(t);try{return await n.execute({sql:`
          UPDATE app_settings SET 
            company_name = ?, company_email = ?, company_logo_url = ?, 
            invoice_prefix = ?, default_currency = ?, payment_methods = ?, 
            notifications_enabled = ?, theme = ?, updated_at = CURRENT_TIMESTAMP
          WHERE id = 1
        `,args:[l.company_name,l.company_email,l.company_logo_url||null,l.invoice_prefix,l.default_currency,JSON.stringify(l.payment_methods),l.notifications_enabled?1:0,l.theme]}),{success:!0}}catch(r){return console.error(r),{success:!1,error:"Failed to update settings."}}},gn={company_name:y.string().min(1),company_email:y.string().email(),company_logo_url:y.string().url().optional().or(y.literal("")),invoice_prefix:y.string().max(10),default_currency:y.string(),payment_methods:y.array(y.string()),notifications_enabled:y.boolean(),theme:y.enum(["light","dark","system"])},rt=B(g(xn,"s_XJ5eJM6wJS4"),Q(g(gn,"s_qOz9xR07XuY"))),bn=()=>{var T;z(),at();const l=nt(),t=rt(),a=v(l.value.company_name),n=v(l.value.company_email),r=v(l.value.company_logo_url||""),o=v(l.value.invoice_prefix),u=v(l.value.default_currency),d=v(JSON.parse(l.value.payment_methods||"[]")),m=v(!!l.value.notifications_enabled),p=v(l.value.theme),h=[{value:"bank_transfer",label:"Bank Transfer"},{value:"paypal",label:"PayPal"},{value:"wise",label:"Wise"},{value:"crypto",label:"Crypto"}],w=[{value:"USD",label:"USD - US Dollar"},{value:"EUR",label:"EUR - Euro"}],E=[{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"system",label:"System"}];return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},e("div",null,{class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex items-center"},[i(Cl,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"cI_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Application Settings",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage global application settings",3,null)],3,null)],1,null),1,null),i(H,{action:t,class:"space-y-8",children:[e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[i(Mt,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"cI_1"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Company Information",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("label",null,{for:"company_name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Company Name",3,null),e("input",null,{type:"text",name:"company_name",id:"company_name",value:a,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_ytQl2RUxF1g",[a])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"company_email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Company Email",3,null),e("input",null,{type:"email",name:"company_email",id:"company_email",value:n,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_4BpnU5fjv4o",[n])},null,3,null)],3,null),e("div",null,{class:"md:col-span-2"},[e("label",null,{for:"company_logo_url",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Logo URL",3,null),e("input",null,{type:"url",name:"company_logo_url",id:"company_logo_url",value:r,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_ENb9DsgOlVs",[r])},null,3,null)],3,null)],3,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[i(me,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"cI_2"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Invoice Settings",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("label",null,{for:"invoice_prefix",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Invoice Prefix",3,null),e("input",null,{type:"text",name:"invoice_prefix",id:"invoice_prefix",value:o,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_ca07GSOeg1o",[o])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"default_currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Default Currency",3,null),e("select",null,{name:"default_currency",id:"default_currency",value:u,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_lLUvYLnkacs",[u])},w.map(k=>e("option",{value:R(k,"value")},null,k.label,1,k.value)),1,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[i(Dt,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"cI_3"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Payment Methods",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-2 md:grid-cols-4 gap-4"},h.map(k=>e("div",null,{class:"flex items-center"},[e("input",{id:`payment-${k.value}`,value:R(k,"value"),checked:d.value.includes(k.value),onChange$:f("s_9IYanuJ7Uic",[k,d])},{type:"checkbox",name:"payment_methods",class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-slate-300 dark:border-slate-600 rounded"},null,2,null),e("label",{for:`payment-${k.value}`},{class:"ml-2 text-sm text-slate-700 dark:text-slate-300"},R(k,"label"),1,null)],1,k.value)),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[i($t,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"cI_4"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Appearance & Notifications",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6 items-center"},[e("div",null,null,[e("label",null,{for:"theme",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Theme",3,null),e("select",null,{name:"theme",id:"theme",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:f("s_6hiRG0tcDe4",[p])},E.map(k=>e("option",{value:R(k,"value")},null,k.label,1,k.value)),1,null)],1,null),e("div",null,{class:"flex items-center pt-6"},[e("input",null,{type:"checkbox",id:"notifications_enabled",name:"notifications_enabled",checked:m,class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-slate-300 dark:border-slate-600 rounded",onInput$:f("s_8iPCJdppKeA",[m])},null,3,null),e("label",null,{for:"notifications_enabled",class:"ml-2 text-sm font-medium text-slate-700 dark:text-slate-300"},"Enable Notifications",3,null)],3,null)],1,null)],1,null),e("div",null,{class:"flex justify-end items-center pt-4"},[((T=t.value)==null?void 0:T.success)===!1&&e("div",null,{class:"text-red-600 dark:text-red-400 mr-4 flex items-center"},[i(se,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"cI_5"),b(k=>k.value.error,[t],"p0.value.error")],1,"cI_6"),e("button",null,{type:"submit",disabled:b(k=>k.isRunning,[t],"p0.isRunning"),class:"inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200 disabled:opacity-50"},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"cI_7"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"cI_8"),"Save Settings"],1,null)],1,null)],[s]:{action:s,class:s}},1,"cI_9")],1,null),1,"cI_10")},hn=V(g(bn,"s_pkX8xUp3FVg")),vn=Object.freeze(Object.defineProperty({__proto__:null,default:hn,useAuthLoader:at,useSettingsLoader:nt,useUpdateSettings:rt},Symbol.toStringTag,{value:"Module"})),wn=async l=>{const t=await $(l);if(!(t!=null&&t.isAuthenticated))throw l.redirect(302,"/auth");return t},ot=Y(g(wn,"s_D9LiNjAXUhY")),kn=async l=>{const t=M(l),a=new URL(l.request.url),n=a.searchParams.get("professional"),r=a.searchParams.get("month"),o=a.searchParams.get("year");let u=`
    SELECT 
      s.id, s.professional_id, p.name as professional_name, s.month, s.year, 
      s.total_amount, s.currency, s.status, s.payment_date
    FROM settlements s
    JOIN professionals p ON s.professional_id = p.id
  `;const d=[],m=[];n&&(m.push("s.professional_id = ?"),d.push(n)),r&&(m.push("s.month = ?"),d.push(r)),o&&(m.push("s.year = ?"),d.push(o)),m.length>0&&(u+=" WHERE "+m.join(" AND ")),u+=" ORDER BY s.year DESC, s.month DESC";const p=await t.execute({sql:u,args:d}),h=await t.execute("SELECT id, name FROM professionals ORDER BY name");return{settlements:p.rows.map(w=>({...w,total_amount:Number(w.total_amount)})),professionals:h.rows,filters:{professionalId:n,month:r,year:o}}},ut=Y(g(kn,"s_YeuiPGf0MkM")),yn=async(l,t)=>{const a=await $(t);if(!a.isAuthenticated||!a.userId)return{success:!1,error:"Authentication required"};const n=M(t);try{return await n.execute({sql:"INSERT INTO settlements (professional_id, user_id, month, year, total_amount, currency, status) VALUES (?, ?, ?, ?, ?, ?, ?)",args:[l.professionalId,a.userId,l.month,l.year,l.totalAmount,l.currency,"pending"]}),{success:!0}}catch(r){return console.error(r),{success:!1,error:"Failed to create settlement."}}},_n={professionalId:y.coerce.number(),month:y.coerce.number().min(1).max(12),year:y.coerce.number().min(2e3).max(2100),totalAmount:y.coerce.number().positive(),currency:y.string().min(3)},it=B(g(yn,"s_igFdqUmxqns"),Q(g(_n,"s_QEe4M0HM2F8"))),Tn=async({id:l,status:t},a)=>{const n=M(a),r=t==="paid"?"pending":"paid",o=r==="paid"?new Date().toISOString().split("T")[0]:null;try{return await n.execute({sql:"UPDATE settlements SET status = ?, payment_date = ? WHERE id = ?",args:[String(r),o?String(o):null,String(l)]}),{success:!0}}catch{return{success:!1,error:"Failed to update status."}}},dt=B(g(Tn,"s_9x1ijvU6PpI")),En=async({id:l},t)=>{const a=M(t);try{return await a.execute({sql:"DELETE FROM settlements WHERE id = ?",args:[String(l)]}),{success:!0}}catch{return{success:!1,error:"Failed to delete settlement."}}},ct=B(g(En,"s_aH8dasVygFA")),Ue=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],ze=()=>{const l=new Date().getFullYear(),t=[];for(let a=l-3;a<=l+1;a++)t.push({value:a.toString(),label:a.toString()});return t},Sn=()=>{const[l,t,a]=A(),n=new URL(window.location.href),r={professionalId:t.value,month:l.value,year:a.value};for(const[o,u]of Object.entries(r))u?n.searchParams.set(o,u):n.searchParams.delete(o);window.location.href=n.toString()},Ln=()=>{var a;const[l,t]=A();(a=l.value)!=null&&a.success&&(t.value=!1)},Rn=()=>{var N,O,U,q,S;z(),ot();const l=ut(),t=it(),a=dt(),n=ct(),r=v(!1),o=v(l.value.filters.professionalId||""),u=v(l.value.filters.month||""),d=v(l.value.filters.year||new Date().getFullYear().toString()),m=v(""),p=v((new Date().getMonth()+1).toString()),h=v(new Date().getFullYear().toString()),w=v(""),E=v("USD"),T=g(Sn,"s_JA9lAiG4rAg",[u,o,d]),k=l.value.settlements.reduce((x,P)=>x+P.total_amount,0),L=l.value.settlements.filter(x=>x.status==="pending").reduce((x,P)=>x+P.total_amount,0),D=x=>{var P;return((P=Ue.find(G=>G.value===String(x)))==null?void 0:P.label)||""};return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(me,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"3q_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Settlements",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage monthly payment settlements",3,null)],3,null)],1,null),e("button",null,{class:"mt-4 sm:mt-0 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:f("s_gZqMXZRy0vc",[r])},[i(Ee,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"3q_1"),"Add Settlement"],1,null)],1,null),1,null),e("div",null,{class:"mb-6 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},[e("div",null,null,[e("label",null,{for:"prof-filter",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Professional",3,null),e("select",null,{id:"prof-filter",value:o,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_IBFxqRn4EYE",[o])},[e("option",null,{value:""},"All",3,null),l.value.professionals.map(x=>e("option",{value:R(x,"id")},null,x.name,1,x.id))],1,null)],1,null),e("div",null,null,[e("label",null,{for:"month-filter",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Month",3,null),e("select",null,{id:"month-filter",value:u,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_tvSnPot6oxg",[u])},[e("option",null,{value:""},"All",3,null),Ue.map(x=>e("option",{value:R(x,"value")},null,x.label,1,x.value))],1,null)],1,null),e("div",null,null,[e("label",null,{for:"year-filter",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Year",3,null),e("select",null,{id:"year-filter",value:d,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_bnOLSIFntok",[d])},[e("option",null,{value:""},"All",3,null),ze().map(x=>e("option",{value:R(x,"value")},null,x.label,1,x.value))],1,null)],1,null),e("div",null,{class:"self-end"},e("button",null,{class:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500",onClick$:T},[i(Qe,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"3q_2"),"Apply"],1,null),1,null)],1,null),1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Settlements",3,null),e("p",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-200"},b(x=>x.value.settlements.length,[l],"p0.value.settlements.length"),3,null)],3,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Amount",3,null),e("p",null,{class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},ce(L,"USD"),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Amount",3,null),e("p",null,{class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},ce(k,"USD"),1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Period",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Amount",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},l.value.settlements.map(x=>z(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800 dark:text-slate-100"},R(x,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},[D(x.month)," ",R(x,"year")],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-800 dark:text-slate-100 font-semibold"},ce(x.total_amount,x.currency),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${x.status==="paid"?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 dark:from-amber-900/30 dark:to-amber-800/30 dark:text-amber-400"}`},null,x.status.charAt(0).toUpperCase()+x.status.slice(1),1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[i(H,{action:a,children:[e("input",{value:R(x,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:R(x,"status")},{type:"hidden",name:"status"},null,3,null),e("button",{title:x.status==="paid"?"Mark as Pending":"Mark as Paid"},{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all"},x.status==="paid"?i(re,{class:"h-5 w-5",[s]:{class:s}},3,"3q_3"):i(_e,{class:"h-5 w-5",[s]:{class:s}},3,"3q_4"),1,null)],[s]:{action:s}},1,"3q_5"),i(H,{action:n,children:[e("input",{value:R(x,"id")},{type:"hidden",name:"id"},null,3,null),e("button",null,{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Delete Settlement"},i(de,{class:"h-5 w-5",[s]:{class:s}},3,"3q_6"),1,null)],[s]:{action:s}},1,"3q_7")],1,null),1,null)],1,x.id))),1,null)],1,null),1,null),l.value.settlements.length===0&&e("div",null,{class:"px-6 py-12 text-center"},e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No settlements found for the selected filters.",3,null),3,"3q_8")],1,null)],1,null),r.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_kJCDOTtfrKA",[r])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:t,onSubmitCompleted$:g(Ln,"s_rZyEMBK6ZTM",[t,r]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Add New Settlement",3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,null,[e("label",null,{for:"professionalId",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Professional",3,null),e("select",null,{name:"professionalId",id:"professionalId",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_ZRcDvRBBLdw",[m])},[e("option",null,{value:""},"Select a professional",3,null),l.value.professionals.map(x=>e("option",{value:R(x,"id")},null,x.name,1,x.id))],1,null),((O=(N=t.value)==null?void 0:N.fieldErrors)==null?void 0:O.professionalId)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.professionalId,[t],"p0.value.fieldErrors.professionalId"),3,"3q_9")],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"month",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Month",3,null),e("select",null,{name:"month",id:"month",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_8FQlk1mPi4U",[p])},Ue.map(x=>e("option",{value:R(x,"value")},null,x.label,1,x.value)),1,null)],1,null),e("div",null,null,[e("label",null,{for:"year",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Year",3,null),e("select",null,{name:"year",id:"year",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_hRuOxT6OR0M",[h])},ze().map(x=>e("option",{value:R(x,"value")},null,x.label,1,x.value)),1,null)],1,null)],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"totalAmount",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Total Amount",3,null),e("input",null,{type:"number",name:"totalAmount",id:"totalAmount",value:w,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_qsYP13BcNis",[w])},null,3,null),((q=(U=t.value)==null?void 0:U.fieldErrors)==null?void 0:q.totalAmount)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.totalAmount,[t],"p0.value.fieldErrors.totalAmount"),3,"3q_10")],1,null),e("div",null,null,[e("label",null,{for:"currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Currency",3,null),e("select",null,{name:"currency",id:"currency",value:E,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:f("s_kPyktfRIJ0U",[E])},[e("option",null,null,"USD",3,null),e("option",null,null,"EUR",3,null)],3,null)],3,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(x=>x.isRunning,[t],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"3q_11"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3q_12"),"Save Settlement"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_PbMP0mxGb8s",[r])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"3q_13"),"Cancel"],1,null)],1,null),((S=t.value)==null?void 0:S.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"3q_14"),b(x=>x.value.error,[t],"p0.value.error")],1,"3q_15")],[s]:{action:s,onSubmitCompleted$:s}},1,"3q_16"),1,null)],1,null),1,"3q_17")],1,"3q_18")},Cn=V(g(Rn,"s_0ONN1Cu1fDg")),An=Object.freeze(Object.defineProperty({__proto__:null,_auto_getYears:ze,_auto_months:Ue,default:Cn,useAddSettlement:it,useAuthLoader:ot,useDeleteSettlement:ct,useSettlementsLoader:ut,useUpdateSettlementStatus:dt},Symbol.toStringTag,{value:"Module"})),In=async l=>{const t=await $(l);if(!(t!=null&&t.isAuthenticated)&&!(t!=null&&t.is_admin))throw l.redirect(302,"/auth");return t},mt=Y(g(In,"s_BLJtw2HBn0Y")),Nn=async l=>{const t=M(l);try{return(await t.execute("SELECT id, username, name, role, email, active FROM users ORDER BY name ASC")).rows.map(n=>({...n,active:!!n.active}))}catch(a){return console.error("Error loading users:",a),[]}},pt=Y(g(Nn,"s_iX0RZbkDTAw")),Mn=async(l,t)=>{var h;const a=await $(t);if(!a.isAuthenticated||!a.is_admin)return{success:!1,error:"Unauthorized"};const n=M(t),{id:r,username:o,name:u,role:d,email:m,password:p}=l;try{if(r){const w=[{key:"username",value:o},{key:"name",value:u},{key:"role",value:d},{key:"email",value:m}];p&&w.push({key:"password_hash",value:p});const E=w.map(k=>`${k.key} = ?`).join(", "),T=w.map(k=>k.value);T.push(String(r)),await n.execute({sql:`UPDATE users SET ${E} WHERE id = ?`,args:T})}else{const w=p;await n.execute({sql:"INSERT INTO users (username, name, role, email, password_hash, active) VALUES (?, ?, ?, ?, ?, ?)",args:[o??"",u??"",d??"viewer",m??"",w??"",!0]})}return{success:!0}}catch(w){return(h=w.message)!=null&&h.includes("UNIQUE constraint failed: users.username")?{success:!1,error:"Username already exists."}:(console.error(w),{success:!1,error:"Failed to save user."})}},Dn={id:y.coerce.number().optional(),username:y.string().min(3,"Username must be at least 3 characters."),name:y.string().min(2,"Name is required."),role:y.enum(["admin","manager","viewer"]),email:y.string().email("Invalid email address."),password:y.string().min(8,"Password must be at least 8 characters.").optional().or(y.literal(""))},ft=B(g(Mn,"s_a0o72IlKDPU"),Q(g(Dn,"s_oYjGP9s7ZYM"))),On=async({id:l,active:t},a)=>{const n=await $(a);if(!(n!=null&&n.is_admin))return{success:!1,error:"Unauthorized"};const r=M(a);try{return await r.execute({sql:"UPDATE users SET active = ? WHERE id = ?",args:[!t,String(l)]}),{success:!0}}catch{return{success:!1,error:"Failed to update status."}}},xt=B(g(On,"s_6EomhBuNxNI")),Un=async({id:l},t)=>{const a=await $(t);if(!(a!=null&&a.is_admin))return{success:!1,error:"Unauthorized"};const n=M(t);try{return await n.execute({sql:"DELETE FROM users WHERE id = ?",args:[String(l)]}),{success:!0}}catch{return{success:!1,error:"Failed to delete user."}}},gt=B(g(Un,"s_1r9Y6zzr2R0")),Pn=l=>{const[t,a,n,r,o,u,d]=A();l?(a.value=l.id,n.value=l.name,u.value=l.username,t.value=l.email,o.value=l.role,r.value=""):(a.value=void 0,n.value="",u.value="",t.value="",o.value="viewer",r.value=""),d.value=!0},jn=()=>{var a;const[l,t]=A();(a=l.value)!=null&&a.success&&(t.value=!1)},$n=()=>{var T,k,L,D,N,O,U,q,S;z(),mt();const l=pt(),t=ft(),a=xt(),n=gt(),r=v(!1),o=v(void 0),u=v(""),d=v(""),m=v(""),p=v("viewer"),h=v(""),w=g(Pn,"s_22z0CwgGRjQ",[m,o,u,h,p,d,r]),E=[{value:"admin",label:"Administrator"},{value:"manager",label:"Manager"},{value:"viewer",label:"Viewer"}];return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[i(ge,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[s]:{class:s}},3,"pv_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"User Administration",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage users and their permissions",3,null)],3,null)],1,null),e("button",null,{class:"mt-4 sm:mt-0 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:f("s_97298IyYAwg",[w])},[i(Ee,{class:"mr-2 h-4 w-4",[s]:{class:s}},3,"pv_1"),"Add User"],1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"User",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Role",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},l.value.map(x=>z(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap"},[e("div",null,{class:"text-sm font-medium text-slate-800 dark:text-slate-100"},R(x,"name"),1,null),e("div",null,{class:"text-sm text-slate-500 dark:text-slate-400"},R(x,"email"),1,null)],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},R(x,"role"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${x.active?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 dark:from-slate-700 dark:to-slate-600 dark:text-slate-300"}`},null,x.active?"Active":"Inactive",1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[e("button",{onClick$:f("s_O4CvBodU74s",[w,x])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all",title:"Edit User"},i(je,{class:"h-5 w-5",[s]:{class:s}},3,"pv_2"),0,null),i(H,{action:a,children:[e("input",{value:R(x,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:x.active?"true":"false"},{type:"hidden",name:"active"},null,3,null),e("button",{class:`p-1.5 rounded-full transition-all ${x.active?"text-slate-600 dark:text-slate-400 hover:text-yellow-600 hover:bg-yellow-50 dark:hover:text-yellow-400 dark:hover:bg-yellow-900/20":"text-slate-600 dark:text-slate-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20"}`,title:x.active?"Deactivate":"Activate"},{type:"submit"},x.active?i(Ht,{class:"h-5 w-5",[s]:{class:s}},3,"pv_3"):i(Bt,{class:"h-5 w-5",[s]:{class:s}},3,"pv_4"),1,null)],[s]:{action:s}},1,"pv_5"),i(H,{action:n,children:[e("input",{value:R(x,"id")},{type:"hidden",name:"id"},null,3,null),e("button",null,{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Delete User"},i(de,{class:"h-5 w-5",[s]:{class:s}},3,"pv_6"),1,null)],[s]:{action:s}},1,"pv_7")],1,null),1,null)],1,x.id))),1,null)],1,null),1,null),1,null)],1,null),r.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:f("s_0VJKs3Cj51k",[r])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},i(H,{action:t,onSubmitCompleted$:g(jn,"s_uctbYNgi4OY",[t,r]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100"},[b(x=>x.value?"Edit":"Add",[o],'p0.value?"Edit":"Add"')," User"],3,null),e("input",null,{type:"hidden",name:"id",value:b(x=>x.value,[o],"p0.value")},null,3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Full Name",3,null),e("input",null,{type:"text",name:"name",id:"name",value:u,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_oN0ORdmSBQk",[u])},null,3,null),((k=(T=t.value)==null?void 0:T.fieldErrors)==null?void 0:k.name)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.name,[t],"p0.value.fieldErrors.name"),3,"pv_8")],1,null),e("div",null,null,[e("label",null,{for:"username",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Username",3,null),e("input",null,{type:"text",name:"username",id:"username",value:d,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_s0IUkW8ve40",[d])},null,3,null),((D=(L=t.value)==null?void 0:L.fieldErrors)==null?void 0:D.username)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.username,[t],"p0.value.fieldErrors.username"),3,"pv_9")],1,null)],1,null),e("div",null,null,[e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"email",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_n0pakWINAc8",[m])},null,3,null),((O=(N=t.value)==null?void 0:N.fieldErrors)==null?void 0:O.email)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.email,[t],"p0.value.fieldErrors.email"),3,"pv_10")],1,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("select",null,{name:"role",id:"role",value:p,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_dia70tVBw94",[p])},E.map(x=>e("option",{value:R(x,"value")},null,x.label,1,x.value)),1,null)],1,null),e("div",null,null,[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Password",3,null),e("input",null,{type:"password",name:"password",id:"password",value:h,placeholder:b(x=>x.value?"Leave blank to keep current":"",[o],'p0.value?"Leave blank to keep current":""'),class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:f("s_Xj20SVtNgHs",[h])},null,3,null),((q=(U=t.value)==null?void 0:U.fieldErrors)==null?void 0:q.password)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(x=>x.value.fieldErrors.password,[t],"p0.value.fieldErrors.password"),3,"pv_11")],1,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(x=>x.isRunning,[t],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[t.isRunning?i(ee,{class:"animate-spin h-5 w-5 mr-2",[s]:{class:s}},3,"pv_12"):i(pe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"pv_13"),"Save User"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:f("s_iD3Bt7nAzVc",[r])},[i(oe,{class:"h-5 w-5 mr-2",[s]:{class:s}},3,"pv_14"),"Cancel"],1,null)],1,null),((S=t.value)==null?void 0:S.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[i(se,{class:"inline h-5 w-5 mr-2",[s]:{class:s}},3,"pv_15"),b(x=>x.value.error,[t],"p0.value.error")],1,"pv_16")],[s]:{action:s,onSubmitCompleted$:s}},1,"pv_17"),1,null)],1,null),1,"pv_18")],1,"pv_19")},Fn=V(g($n,"s_bCkyk2JlVAo")),qn=Object.freeze(Object.defineProperty({__proto__:null,default:Fn,useAuthLoader:mt,useDeleteUser:gt,useSaveUser:ft,useToggleUserStatus:xt,useUsersLoader:pt},Symbol.toStringTag,{value:"Module"})),Bn=[],gl=()=>At,X=()=>ts,Hn=[["/",[X,()=>us],"/",["q-DIcajowi.js","q-XO27ErjZ.js"]],["api/contracts/view/[fileName]/",[X,()=>cs],"/api/contracts/view/[fileName]/",["q-DIcajowi.js"]],["api/invoices/view/[fileName]/",[X,()=>fs],"/api/invoices/view/[fileName]/",["q-DIcajowi.js"]],["api/upload-contract/",[X,()=>gs],"/api/upload-contract/",["q-DIcajowi.js"]],["api/upload-image/",[X,()=>hs],"/api/upload-image/",["q-DIcajowi.js"]],["api/upload-invoice/",[X,()=>ws],"/api/upload-invoice/",["q-DIcajowi.js"]],["auth/logout/",[X,gl,()=>Es],"/auth/logout/",["q-DIcajowi.js","q-BxRdWqCr.js","q-8xRD5hmm.js"]],["auth/",[X,gl,()=>Ps],"/auth/",["q-DIcajowi.js","q-BxRdWqCr.js","q-V8kGM0Jl.js"]],["contracts/",[X,()=>Ks],"/contracts/",["q-DIcajowi.js","q-38fVKm5x.js"]],["invoices/",[X,()=>ca],"/invoices/",["q-DIcajowi.js","q-DHP72ASR.js"]],["planner-auto/",[X,()=>Ha],"/planner-auto/",["q-DIcajowi.js","q-zDc5ZG-q.js"]],["planner/",[X,()=>Xa],"/planner/",["q-DIcajowi.js","q-Dse9Rxhw.js"]],["professionals/",[X,()=>mn],"/professionals/",["q-DIcajowi.js","q-CN_jkOHO.js"]],["settings/",[X,()=>vn],"/settings/",["q-DIcajowi.js","q-BA_monqA.js"]],["settlements/",[X,()=>An],"/settlements/",["q-DIcajowi.js","q-Bt1IFxqT.js"]],["user-admin/",[X,()=>qn],"/user-admin/",["q-DIcajowi.js","q-DgEGzhvQ.js"]]],Yn=[],zn=!0,Gn="/",Wn=!0,nr={routes:Hn,serverPlugins:Bn,menus:Yn,trailingSlash:zn,basePathname:Gn,cacheModules:Wn};export{Gn as basePathname,Wn as cacheModules,nr as default,Yn as menus,Hn as routes,Bn as serverPlugins,zn as trailingSlash};
