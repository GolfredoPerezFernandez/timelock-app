import{c as Q,i as p,u as f,b as _e,d as g,e,f as u,S as Me,g as R,h as b,r as Y,j as X,k as Je,l as a,L as pe,m as be,n as L,o as C,p as q,F as K,z as te,q as xe,s as Kt,t as Ge}from"./q-BbaayOrg.js";import{createClient as Be}from"@libsql/client";import Ze from"path";import ze from"fs";import{readFile as Qt,mkdir as et,writeFile as $e}from"node:fs/promises";import Re,{join as Se}from"node:path";import{randomBytes as tt}from"node:crypto";import{z as I}from"zod";import{DateTime as Jt}from"luxon";import{createPublicClient as Zt,http as el}from"viem";import{base as We}from"viem/chains";const tl=()=>{const t=f(!1);return _e(g("s_kMIkvtDqkEU",[t])),e("div",null,{class:"min-h-screen flex flex-col items-center justify-center transition-colors duration-300 bg-transparent",style:{paddingTop:"calc(env(safe-area-inset-top))"}},[e("div",null,{class:"fixed inset-0 pointer-events-none overflow-hidden opacity-40"},[e("div",null,{class:"w-20 h-20 bg-teal-500/20 rounded-full absolute top-[10%] left-[15%] animate-[float_15s_infinite]"},null,3,null),e("div",null,{class:"w-32 h-32 bg-slate-500/20 rounded-full absolute top-[30%] left-[65%] animate-[float_18s_infinite]",style:"animation-delay: 0.5s;"},null,3,null),e("div",null,{class:"w-16 h-16 bg-amber-400/20 rounded-full absolute top-[70%] left-[25%] animate-[float_12s_infinite]",style:"animation-delay: 1s;"},null,3,null)],3,null),e("div",null,{class:"pt-safe"},u(Me,null,3,"GY_0"),1,null),e("style",null,null,`
        @keyframes float {
          0% { transform: translate(0, 0); }
          25% { transform: translate(5px, -15px); }
          50% { transform: translate(10px, 0); }
          75% { transform: translate(5px, 15px); }
          100% { transform: translate(0, 0); }
        }
        @keyframes pulse {
          0%, 100% { opacity: 0.5; transform: scale(1); }
          50% { opacity: 1; transform: scale(1.05); }
        }
      `,3,null)],1,"GY_1")},ll=Q(p(tl,"s_9ToU0mvTu94")),sl=Object.freeze(Object.defineProperty({__proto__:null,default:ll},Symbol.toStringTag,{value:"Module"})),j=async t=>{var i,o;const l=(i=t.cookie.get("auth_token"))==null?void 0:i.value,s=(o=t.cookie.get("user_type"))==null?void 0:o.value;if(!l||!s)return{isAuthenticated:!1,userId:null,role:null,is_admin:!1,email:null};let n=!1,r=s;try{const m=await Be({url:t.env.get("PRIVATE_TURSO_DATABASE_URL"),authToken:t.env.get("PRIVATE_TURSO_AUTH_TOKEN")}).execute({sql:"SELECT email, type FROM users WHERE id = ?",args:[l]});if(m.rows.length===0)return qe(t),{isAuthenticated:!1,userId:null,role:null,is_admin:!1,email:null};const c=m.rows[0];return c.email==="admin@gmail.com"?(n=!0,r="admin"):(n=!1,(s==="admin"||s==="super_admin")&&(r="freelancer")),{isAuthenticated:!0,userId:l,role:r,is_admin:n,email:c.email??null}}catch(d){return console.error("Session validation DB error:",d),{isAuthenticated:!1,userId:null,role:null,is_admin:!1,email:null}}};function lt(t){return new TextEncoder().encode(t).buffer}function we(t){return Array.from(new Uint8Array(t)).map(l=>l.toString(16).padStart(2,"0")).join("")}async function al(t){const l=lt(t),s=crypto.getRandomValues(new Uint8Array(16)),n=await crypto.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveBits"]),r=await crypto.subtle.deriveBits({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},n,256),i=new Uint8Array(s.length+32);i.set(s),i.set(new Uint8Array(r),s.length);const o=we(i.buffer);return console.log("[hashPassword] password:",t),console.log("[hashPassword] salt:",we(s.buffer)),console.log("[hashPassword] derivedKey:",we(r)),console.log("[hashPassword] combined hex:",o),o}async function nl(t,l){const s=new Uint8Array(l.match(/.{1,2}/g).map(x=>parseInt(x,16))),n=s.slice(0,16),r=s.slice(16),i=lt(t),o=await crypto.subtle.importKey("raw",i,{name:"PBKDF2"},!1,["deriveBits"]),d=await crypto.subtle.deriveBits({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},o,256),m=we(d),c=we(r.buffer);return console.log("[verifyPassword] password:",t),console.log("[verifyPassword] salt:",we(n.buffer)),console.log("[verifyPassword] derivedKey:",m),console.log("[verifyPassword] storedKey:",c),m===c}const st=(t,l,s)=>{const n=String(l),r={path:"/",httpOnly:!0,sameSite:"strict",secure:t.url.protocol==="https:",maxAge:3600};t.cookie.set("auth_token",n,r),t.cookie.set("user_type",s,r)},qe=t=>{const l={path:"/"};t.cookie.delete("auth_token",l),t.cookie.delete("user_type",l)},rl=t=>R("svg",{...t,children:[e("circle",null,{cx:"12",cy:"12",r:"10"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"8",y2:"12"},null,3,null),e("line",null,{x1:"12",x2:"12.01",y1:"16",y2:"16"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Ui_0"),ee=t=>R("svg",{...t,children:[e("path",null,{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"},null,3,null),e("path",null,{d:"M12 9v4"},null,3,null),e("path",null,{d:"M12 17h.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"zY_0"),Ve=t=>R("svg",{...t,children:[e("path",null,{d:"m12 19-7-7 7-7"},null,3,null),e("path",null,{d:"M19 12H5"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"VY_0"),Te=t=>R("svg",{...t,children:[e("rect",null,{height:"14",rx:"2",ry:"2",width:"20",x:"2",y:"7"},null,3,null),e("path",null,{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"sZ_0"),ol=t=>R("svg",{...t,children:[e("rect",null,{height:"20",rx:"2",ry:"2",width:"16",x:"4",y:"2"},null,3,null),e("path",null,{d:"M9 22v-4h6v4"},null,3,null),e("path",null,{d:"M8 6h.01"},null,3,null),e("path",null,{d:"M16 6h.01"},null,3,null),e("path",null,{d:"M12 6h.01"},null,3,null),e("path",null,{d:"M12 10h.01"},null,3,null),e("path",null,{d:"M12 14h.01"},null,3,null),e("path",null,{d:"M16 10h.01"},null,3,null),e("path",null,{d:"M16 14h.01"},null,3,null),e("path",null,{d:"M8 10h.01"},null,3,null),e("path",null,{d:"M8 14h.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"t9_0"),at=t=>R("svg",{...t,children:[e("rect",null,{height:"18",rx:"2",ry:"2",width:"18",x:"3",y:"4"},null,3,null),e("line",null,{x1:"16",x2:"16",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"8",x2:"8",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"3",x2:"21",y1:"10",y2:"10"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"34_0"),Oe=t=>R("svg",{...t,children:[e("path",null,{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,3,null),e("polyline",null,{points:"22 4 12 14.01 9 11.01"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Jy_0"),nt=t=>R("svg",{...t,children:e("path",null,{d:"m15 18-6-6 6-6"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"5O_0"),rt=t=>R("svg",{...t,children:e("path",null,{d:"m9 18 6-6-6-6"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Rc_0"),Ne=t=>R("svg",{...t,children:[e("circle",null,{cx:"12",cy:"12",r:"10"},null,3,null),e("polyline",null,{points:"12 6 12 12 16 14"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"PM_0"),il=t=>R("svg",{...t,children:[e("rect",null,{height:"14",rx:"2",width:"20",x:"2",y:"5"},null,3,null),e("line",null,{x1:"2",x2:"22",y1:"10",y2:"10"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"UR_0"),ul=t=>R("svg",{...t,children:[e("line",null,{x1:"12",x2:"12",y1:"2",y2:"22"},null,3,null),e("path",null,{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"0T_0"),ot=t=>R("svg",{...t,children:[e("path",null,{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},null,3,null),e("polyline",null,{points:"7 10 12 15 17 10"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"15",y2:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"f4_0"),it=t=>R("svg",{...t,children:[e("path",null,{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},null,3,null),e("polyline",null,{points:"15 3 21 3 21 9"},null,3,null),e("line",null,{x1:"10",x2:"21",y1:"14",y2:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Oq_0"),Ee=t=>R("svg",{...t,children:[e("path",null,{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"},null,3,null),e("circle",null,{cx:"12",cy:"12",r:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"jA_0"),ce=t=>R("svg",{...t,children:[e("path",null,{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},null,3,null),e("polyline",null,{points:"14 2 14 8 20 8"},null,3,null),e("line",null,{x1:"16",x2:"8",y1:"13",y2:"13"},null,3,null),e("line",null,{x1:"16",x2:"8",y1:"17",y2:"17"},null,3,null),e("line",null,{x1:"10",x2:"8",y1:"9",y2:"9"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"gd_0"),ut=t=>R("svg",{...t,children:[e("path",null,{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},null,3,null),e("polyline",null,{points:"14 2 14 8 20 8"},null,3,null),e("path",null,{d:"M12 12v6"},null,3,null),e("path",null,{d:"m15 15-3-3-3 3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Wk_0"),dt=t=>R("svg",{...t,children:e("polygon",null,{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"bo_0"),Xe=t=>R("svg",{...t,children:[e("circle",null,{cx:"7.5",cy:"15.5",r:"5.5"},null,3,null),e("path",null,{d:"m21 2-9.6 9.6"},null,3,null),e("path",null,{d:"m15.5 7.5 3 3L22 7l-3-3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Wf_0"),se=t=>R("svg",{...t,children:e("path",null,{d:"M21 12a9 9 0 1 1-6.219-8.56"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"nT_0"),Ie=t=>R("svg",{...t,children:[e("line",null,{x1:"12",x2:"12",y1:"2",y2:"6"},null,3,null),e("line",null,{x1:"12",x2:"12",y1:"18",y2:"22"},null,3,null),e("line",null,{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76"},null,3,null),e("line",null,{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07"},null,3,null),e("line",null,{x1:"2",x2:"6",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"18",x2:"22",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24"},null,3,null),e("line",null,{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"kT_0"),Ue=t=>R("svg",{...t,children:[e("rect",null,{height:"11",rx:"2",ry:"2",width:"18",x:"3",y:"11"},null,3,null),e("path",null,{d:"M7 11V7a5 5 0 0 1 10 0v4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"WS_0"),ct=t=>R("svg",{...t,children:[e("path",null,{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},null,3,null),e("polyline",null,{points:"16 17 21 12 16 7"},null,3,null),e("line",null,{x1:"21",x2:"9",y1:"12",y2:"12"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"0h_0"),dl=t=>R("svg",{...t,children:[e("rect",null,{height:"16",rx:"2",width:"20",x:"2",y:"4"},null,3,null),e("path",null,{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"n4_0"),cl=t=>R("svg",{...t,children:[e("line",null,{x1:"4",x2:"20",y1:"12",y2:"12"},null,3,null),e("line",null,{x1:"4",x2:"20",y1:"6",y2:"6"},null,3,null),e("line",null,{x1:"4",x2:"20",y1:"18",y2:"18"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"f1_0"),ml=t=>R("svg",{...t,children:e("path",null,{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"},null,3,null)},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Oe_0"),pl=t=>R("svg",{...t,children:[e("circle",null,{cx:"13.5",cy:"6.5",r:".5"},null,3,null),e("circle",null,{cx:"17.5",cy:"10.5",r:".5"},null,3,null),e("circle",null,{cx:"8.5",cy:"7.5",r:".5"},null,3,null),e("circle",null,{cx:"6.5",cy:"12.5",r:".5"},null,3,null),e("path",null,{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"60_0"),Pe=t=>R("svg",{...t,children:[e("path",null,{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"},null,3,null),e("path",null,{d:"m15 5 4 4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"eG_0"),fl=t=>R("svg",{...t,children:[e("path",null,{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},null,3,null),e("path",null,{d:"M22 12A10 10 0 0 0 12 2v10z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"HH_0"),Ce=t=>R("svg",{...t,children:[e("path",null,{d:"M5 12h14"},null,3,null),e("path",null,{d:"M12 5v14"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Z7_0"),xl=t=>R("svg",{...t,children:[e("path",null,{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"},null,3,null),e("path",null,{d:"M3 3v5h5"},null,3,null),e("path",null,{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"},null,3,null),e("path",null,{d:"M16 16h5v5"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"CE_0"),ke=t=>R("svg",{...t,children:[e("path",null,{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,3,null),e("polyline",null,{points:"17 21 17 13 7 13 7 21"},null,3,null),e("polyline",null,{points:"7 3 7 8 15 8"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Jw_0"),Ye=t=>R("svg",{...t,children:[e("circle",null,{cx:"11",cy:"11",r:"8"},null,3,null),e("path",null,{d:"m21 21-4.3-4.3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"OE_0"),mt=t=>R("svg",{...t,children:[e("path",null,{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"},null,3,null),e("circle",null,{cx:"12",cy:"12",r:"3"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"xG_0"),gl=t=>R("svg",{...t,children:[e("path",null,{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"},null,3,null),e("path",null,{d:"m9 12 2 2 4-4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"oN_0"),hl=t=>R("svg",{...t,children:[e("path",null,{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2"},null,3,null),e("path",null,{d:"m2 2 20 20"},null,3,null),e("path",null,{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Ij_0"),bl=t=>R("svg",{...t,children:[e("circle",null,{cx:"12",cy:"12",r:"4"},null,3,null),e("path",null,{d:"M12 2v2"},null,3,null),e("path",null,{d:"M12 20v2"},null,3,null),e("path",null,{d:"m4.93 4.93 1.41 1.41"},null,3,null),e("path",null,{d:"m17.66 17.66 1.41 1.41"},null,3,null),e("path",null,{d:"M2 12h2"},null,3,null),e("path",null,{d:"M20 12h2"},null,3,null),e("path",null,{d:"m6.34 17.66-1.41 1.41"},null,3,null),e("path",null,{d:"m19.07 4.93-1.41 1.41"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Qm_0"),pt=t=>R("svg",{...t,children:[e("path",null,{d:"M3 6h18"},null,3,null),e("path",null,{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},null,3,null),e("path",null,{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},null,3,null),e("line",null,{x1:"10",x2:"10",y1:"11",y2:"17"},null,3,null),e("line",null,{x1:"14",x2:"14",y1:"11",y2:"17"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"Eb_0"),ve=t=>R("svg",{...t,children:[e("path",null,{d:"M3 6h18"},null,3,null),e("path",null,{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"},null,3,null),e("path",null,{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"St_0"),vl=t=>R("svg",{...t,children:[e("path",null,{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"},null,3,null),e("circle",null,{cx:"12",cy:"7",r:"4"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"sX_0"),ge=t=>R("svg",{...t,children:[e("path",null,{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},null,3,null),e("circle",null,{cx:"9",cy:"7",r:"4"},null,3,null),e("path",null,{d:"M22 21v-2a4 4 0 0 0-3-3.87"},null,3,null),e("path",null,{d:"M16 3.13a4 4 0 0 1 0 7.75"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"pI_0"),wl=t=>R("svg",{...t,children:[e("path",null,{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"},null,3,null),e("path",null,{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"},null,3,null),e("path",null,{d:"M18 12a2 2 0 0 0 0 4h4v-4Z"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"lt_0"),fe=t=>R("svg",{...t,children:[e("path",null,{d:"M18 6 6 18"},null,3,null),e("path",null,{d:"m6 6 12 12"},null,3,null)]},{"data-qwikest-icon":!0,fill:"none",height:"1em",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"1em",xmlns:"http://www.w3.org/2000/svg"},0,"CN_0"),kl=t=>{const l={xs:{width:24,height:24,text:"text-sm",subtext:"text-xs"},sm:{width:32,height:32,text:"text-lg",subtext:"text-xs"},md:{width:40,height:40,text:"text-xl",subtext:"text-sm"},lg:{width:56,height:56,text:"text-2xl",subtext:"text-base"}},s=t.responsive??!1?{width:"w-6 sm:w-8 md:w-10",height:"h-6 sm:h-8 md:h-10",text:"text-sm sm:text-lg md:text-xl",subtext:"text-xs sm:text-xs md:text-sm"}:null,{width:n,height:r,text:i,subtext:o}=t.responsive??!1?s:l[t.size??"md"];return e("div",null,{class:b(d=>`inline-flex items-center ${d.className??""}`,[t],'`inline-flex items-center ${p0.className??""}`')},[e("div",{style:{width:n,height:r}},null,e("svg",null,{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg",class:"w-full h-full"},[e("defs",null,null,e("linearGradient",null,{id:"logoGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},[e("stop",null,{offset:"0%",style:{stopColor:"#0f766e",stopOpacity:1}},null,3,null),e("stop",null,{offset:"50%",style:{stopColor:"#14b8a6",stopOpacity:1}},null,3,null),e("stop",null,{offset:"100%",style:{stopColor:"#5eead4",stopOpacity:1}},null,3,null)],3,null),3,null),e("circle",null,{cx:"50",cy:"50",r:"42",fill:"url(#logoGradient)",stroke:"#0f766e","stroke-width":"2"},null,3,null),e("text",null,{x:"50%",y:"50%","dominant-baseline":"central","text-anchor":"middle","font-family":"'Poppins', sans-serif","font-size":"28","font-weight":"bold",fill:"#ffffff","letter-spacing":"-1"},"STL",3,null)],3,null),3,null),e("div",{class:`ml-2 sm:ml-3 font-bold ${t.responsive??!1?s.text:i} flex flex-col leading-none`},null,[e("span",null,{class:"text-slate-800 dark:text-slate-100"},"Saave",3,null),e("span",{class:`text-teal-600 dark:text-teal-400 ${t.responsive??!1?s.subtext:o}`},null,"TimeLock",3,null)],1,null)],1,"2o_0")},yl=Q(p(kl,"s_jTI0vSQg3mw")),je=t=>u(yl,{...t},0,"S3_0"),_l=async t=>j(t),ft=Y(p(_l,"s_kPZv5zqFaP4")),Tl=()=>{const[t]=C();t.value=!t.value,t.value?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},El=()=>{const[t]=C();t.value=!t.value},Sl=()=>{const[t]=C();return t.value=!1},Ll=()=>{const[t]=C();return t.value=!1},Rl=()=>{const[t]=C();return t.value=!1},Al=()=>{X();const t=ft(),l=Je(),s=f(!1),n=f(!1),r=f(!0),i=[...t.value.role==="admin"||t.value.role==="super_admin"?[{name:"Dashboard",href:"/",icon:fl,description:"Overview of key metrics"},{name:"Professionals",href:"/professionals",icon:ge,description:"Manage professional profiles"},{name:"Contracts",href:"/contracts",icon:Te,description:"Administer service contracts"},{name:"Invoices",href:"/invoices",icon:ce,description:"Track and manage invoices"},{name:"Settlements",href:"/settlements",icon:ul,description:"Process payment settlements"},{name:"Planner",href:"/planner",icon:at,description:"View payment schedules"},{name:"Settings",href:"/settings",icon:mt,description:"Configure application settings"},...t.value.role==="super_admin"?[{name:"User Admin",href:"/user-admin",icon:ge,description:"Manage system users"}]:[]]:[{name:"Contracts",href:"/contracts",icon:Te,description:"Administer service contracts"},{name:"Invoices",href:"/invoices",icon:ce,description:"Track and manage invoices"},{name:"Payment Scheduler",href:"/planner-auto",icon:Ne,description:"Automate payment schedules"}]],o=t.value.isAuthenticated?{name:"Logout",href:"/auth/logout",icon:ct,description:"Sign out of your account"}:{name:"Login",href:"/auth",icon:vl,description:"Access your account"};_e(g("s_PXmMQHEJxdA",[s]));const d=p(Tl,"s_gdjDhvPXj4E",[s]),m=p(El,"s_B99zaGvTXxk",[r]);return l.url.pathname==="/auth/"?e("main",null,{class:"flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto"},u(Me,null,3,"S3_1"),1,"S3_2"):e("div",null,{class:"flex h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200"},[e("aside",{class:`hidden lg:flex flex-col transition-all duration-300 ease-in-out bg-white dark:bg-slate-800/50 border-r border-slate-200 dark:border-slate-700/50
        ${r.value?"w-64":"w-20"}`},null,[e("div",null,{class:b(c=>`flex items-center h-16 px-4 ${c.value?"justify-between":"justify-center"}`,[r],'`flex items-center h-16 px-4 ${p0.value?"justify-between":"justify-center"}`')},[u(pe,{href:"/",get class(){return`flex items-center gap-2 ${!r.value&&"w-full justify-center"}`},children:[u(je,{className:"w-8 h-8 text-teal-500",[a]:{className:a}},3,"S3_3"),r.value&&e("span",null,{class:"font-bold text-lg"},"SaveeTimelock",3,"S3_4")],[a]:{href:a,class:b(c=>`flex items-center gap-2 ${!c.value&&"w-full justify-center"}`,[r],'`flex items-center gap-2 ${!p0.value&&"w-full justify-center"}`')}},1,"S3_5"),r.value&&e("button",null,{class:"p-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700",onClick$:m},u(nt,{class:"w-5 h-5",[a]:{class:a}},3,"S3_6"),1,"S3_7")],1,null),!r.value&&e("div",null,{class:"flex justify-center my-2"},e("button",null,{class:"p-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700",onClick$:m},u(rt,{class:"w-5 h-5",[a]:{class:a}},3,"S3_8"),1,null),1,"S3_9"),e("nav",null,{class:"flex-1 px-2 py-4 space-y-2"},t.value.isAuthenticated&&i.map(c=>{const x=l.url.pathname===c.href||c.href!=="/"&&l.url.pathname.startsWith(c.href);return u(pe,{get href(){return c.href},get title(){return c.name},class:`flex items-center gap-3 rounded-md transition-colors
                ${r.value?"px-3 py-2":"p-3 justify-center"}
                ${x?"bg-teal-500/10 text-teal-500 dark:bg-teal-400/20 dark:text-teal-400":"hover:bg-slate-100 dark:hover:bg-slate-700/50"}`,children:[u(c.icon,{class:"w-5 h-5 shrink-0",[a]:{class:a}},3,"S3_10"),r.value&&e("span",null,{class:"text-sm font-medium"},L(c,"name"),1,"S3_11")],[a]:{href:be(c,"href"),title:be(c,"name")}},1,c.name)}),1,null),e("div",null,{class:"px-2 py-4 mt-auto"},u(pe,{get href(){return o.href},get title(){return o.name},class:`flex items-center gap-3 rounded-md transition-colors
            ${r.value?"px-3 py-2":"p-3 justify-center"}
            hover:bg-slate-100 dark:hover:bg-slate-700/50`,children:[u(o.icon,{class:"w-5 h-5 shrink-0",[a]:{class:a}},3,"S3_12"),r.value&&e("span",null,{class:"text-sm font-medium"},L(o,"name"),1,"S3_13")],[a]:{href:be(o,"href"),title:be(o,"name")}},1,"S3_14"),1,null)],1,null),e("header",null,{class:"lg:hidden fixed top-0 left-0 right-0 z-40 flex items-center justify-between h-16 px-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800"},[e("button",null,{class:"p-2",onClick$:g("s_CqXkyDmMGuc",[n])},u(cl,{class:"w-6 h-6",[a]:{class:a}},3,"S3_15"),1,null),u(pe,{href:"/",class:"flex items-center gap-2",children:u(je,{className:"w-8 h-8 text-teal-500",[a]:{className:a}},3,"S3_16"),[a]:{href:a,class:a}},1,"S3_17"),e("button",null,{class:"p-2",onClick$:d},s.value?u(bl,{class:"w-6 h-6",[a]:{class:a}},3,"S3_18"):u(ml,{class:"w-6 h-6",[a]:{class:a}},3,"S3_19"),1,null)],1,null),n.value&&e("div",null,{class:"lg:hidden fixed inset-0 z-50",role:"dialog","aria-modal":"true"},[e("div",null,{class:"fixed inset-0 bg-black/25 backdrop-blur-sm",onClick$:g("s_29h0Cs0YvUk",[n])},null,3,null),e("div",null,{class:"fixed inset-y-0 left-0 w-64 bg-white dark:bg-slate-800 p-4"},[e("div",null,{class:"flex items-center justify-between h-12 mb-4"},[u(pe,{href:"/",class:"flex items-center gap-2",onClick$:p(Sl,"s_Lgh2fELhsxw",[n]),children:e("span",null,{class:"font-bold text-lg"},"SaveeTimelock",3,null),[a]:{href:a,class:a,onClick$:a}},3,"S3_20"),e("button",null,{class:"p-2",onClick$:g("s_tUdpu55U93Q",[n])},u(fe,{class:"w-6 h-6",[a]:{class:a}},3,"S3_21"),1,null)],1,null),e("nav",null,{class:"flex flex-col h-full"},[e("div",null,{class:"flex-1 space-y-2"},t.value.isAuthenticated&&i.map(c=>{const x=l.url.pathname===c.href||c.href!=="/"&&l.url.pathname.startsWith(c.href);return u(pe,{get href(){return c.href},onClick$:p(Ll,"s_rHbc3bvvZ1E",[n]),class:`flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium
                      ${x?"bg-teal-500/10 text-teal-500 dark:bg-teal-400/20 dark:text-teal-400":"hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[u(c.icon,{class:"w-5 h-5",[a]:{class:a}},3,"S3_22"),L(c,"name")],[a]:{href:be(c,"href"),onClick$:a}},1,c.name)}),1,null),e("div",null,{class:"mt-auto"},u(pe,{get href(){return o.href},onClick$:p(Rl,"s_NhVnMTaOGeI",[n]),class:"flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium hover:bg-slate-100 dark:hover:bg-slate-700",children:[u(o.icon,{class:"w-5 h-5",[a]:{class:a}},3,"S3_23"),L(o,"name")],[a]:{href:be(o,"href"),onClick$:a,class:a}},1,"S3_24"),1,null)],1,null)],1,null)],1,"S3_25"),e("main",null,{class:"flex-1 overflow-y-auto pt-16 lg:pt-0"},e("div",null,{class:"p-4 sm:p-6 lg:p-8"},u(Me,null,3,"S3_26"),1,null),1,null)],1,"S3_27")},Il=Q(p(Al,"s_7u8M1ps3cz0")),Nl=Object.freeze(Object.defineProperty({__proto__:null,Logo:je,default:Il,useAuthSession:ft},Symbol.toStringTag,{value:"Module"}));Be({url:process.env.PRIVATE_TURSO_DATABASE_URL||"file:./local.db",authToken:process.env.PRIVATE_TURSO_AUTH_TOKEN});function O(t){var n,r;const l=(n=t.env.get("PRIVATE_TURSO_DATABASE_URL"))==null?void 0:n.trim();if(l===void 0)throw new Error("PRIVATE_TURSO_DATABASE_URL is not defined");const s=(r=t.env.get("PRIVATE_TURSO_AUTH_TOKEN"))==null?void 0:r.trim();if(s===void 0&&!l.includes("file:"))throw new Error("PRIVATE_TURSO_AUTH_TOKEN is not defined");return Be({url:l,authToken:s})}async function Cl(t){const l=O(t),s=await l.execute("PRAGMA table_info(professionals);"),n=s.rows.find(o=>o.name==="wallet"),r=s.rows.find(o=>o.name==="user_id");(n&&n.notnull===1||r&&r.notnull===1)&&(await l.execute("BEGIN TRANSACTION;"),await l.execute(`
      CREATE TABLE IF NOT EXISTS professionals_tmp (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        user_id INTEGER,
        name TEXT NOT NULL,
        role TEXT NOT NULL,
        email TEXT,
        phone TEXT,
        wallet TEXT,
        created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (user_id) REFERENCES users(id)
      );
    `),await l.execute(`
      INSERT INTO professionals_tmp (id, user_id, name, role, email, phone, wallet, created_at)
      SELECT id, user_id, name, role, email, phone, wallet, created_at FROM professionals;
    `),await l.execute("DROP TABLE professionals;"),await l.execute("ALTER TABLE professionals_tmp RENAME TO professionals;"),await l.execute("COMMIT;")),console.log("Running database migrations for users and trees tables..."),await l.execute(`CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    email TEXT NOT NULL UNIQUE,
    password_hash TEXT NOT NULL,
    username TEXT NOT NULL DEFAULT '',
    type TEXT DEFAULT 'normal',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    session_expires DATETIME
  );`);try{await l.execute("ALTER TABLE users ADD COLUMN email TEXT;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE users ADD COLUMN type TEXT DEFAULT 'normal';")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE users ADD COLUMN username TEXT NOT NULL DEFAULT '';")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE users ADD COLUMN session_expires DATETIME;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute("CREATE UNIQUE INDEX IF NOT EXISTS idx_users_email ON users(email);"),await l.execute(`CREATE TABLE IF NOT EXISTS professionals (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    name TEXT NOT NULL,
    role TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await l.execute("ALTER TABLE professionals ADD COLUMN email TEXT;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE professionals ADD COLUMN phone TEXT;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE professionals ADD COLUMN wallet TEXT;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute(`CREATE TABLE IF NOT EXISTS contracts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    start_date TEXT NOT NULL,
    end_date TEXT NOT NULL,
    status TEXT NOT NULL DEFAULT 'pending',
    contract_pdf_url TEXT,
    contract_url TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await l.execute("ALTER TABLE contracts ADD COLUMN contract_url TEXT;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute(`CREATE TABLE IF NOT EXISTS invoices (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    contract_id INTEGER NOT NULL,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    issue_date TEXT NOT NULL,
    paid_date TEXT,
    amount REAL NOT NULL,
    currency TEXT NOT NULL,
    status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
    invoice_url TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (contract_id) REFERENCES contracts(id),
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await l.execute("ALTER TABLE invoices ADD COLUMN created_date DATETIME;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute("UPDATE invoices SET created_date = created_at WHERE created_date IS NULL;"),await l.execute(`CREATE TABLE IF NOT EXISTS settlements (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    professional_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL,
    month INTEGER NOT NULL,
    year INTEGER NOT NULL,
    total_amount REAL NOT NULL,
    total_in_knrt REAL,
    currency TEXT NOT NULL,
    status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
    payment_date TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (professional_id) REFERENCES professionals(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
  );`);try{await l.execute("ALTER TABLE settlements ADD COLUMN total_in_knrt REAL;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute(`CREATE TABLE IF NOT EXISTS payments (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      professional_id INTEGER NOT NULL,
      user_id INTEGER NOT NULL,
      invoice_id INTEGER,
      amount REAL NOT NULL,
      currency TEXT NOT NULL,
      status TEXT NOT NULL CHECK(status IN ('pending', 'paid')),
      due_date TEXT NOT NULL,
      payment_date TEXT,
      description TEXT,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (professional_id) REFERENCES professionals(id),
      FOREIGN KEY (user_id) REFERENCES users(id),
      FOREIGN KEY (invoice_id) REFERENCES invoices(id)
  );`);try{await l.execute("ALTER TABLE payments ADD COLUMN contract_id INTEGER;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}try{await l.execute("ALTER TABLE payments ADD COLUMN updated_at DATETIME;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute(`CREATE TABLE IF NOT EXISTS timelocks (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      payment_id INTEGER NOT NULL,
      invoice_id INTEGER,
      release_timestamp INTEGER NOT NULL,
      status TEXT NOT NULL CHECK(status IN ('pending', 'completed', 'failed')),
      tx_hash TEXT,
      created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
      FOREIGN KEY (payment_id) REFERENCES payments(id),
      FOREIGN KEY (invoice_id) REFERENCES invoices(id)
  );`);try{await l.execute("ALTER TABLE timelocks ADD COLUMN invoice_id INTEGER;")}catch(o){if(!String(o.message).toLowerCase().includes("duplicate column name"))throw o}await l.execute("CREATE INDEX IF NOT EXISTS idx_timelocks_payment_id ON timelocks(payment_id);");try{console.log("Verificando la tabla timelocks..."),(await l.execute("SELECT name FROM sqlite_master WHERE type='table' AND name='timelocks';")).rows.length===0?(console.error("⚠️ La tabla timelocks no se creó correctamente. Intentando crearla de nuevo con DROP TABLE..."),await l.execute("DROP TABLE IF EXISTS timelocks;"),await l.execute(`CREATE TABLE IF NOT EXISTS timelocks (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          payment_id INTEGER NOT NULL,
          release_timestamp INTEGER NOT NULL,
          status TEXT NOT NULL CHECK(status IN ('pending', 'completed', 'failed')),
          tx_hash TEXT,
          created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
          updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
      );`),console.log("✅ Tabla timelocks creada correctamente.")):console.log("✅ Tabla timelocks verificada correctamente.")}catch(o){console.error("Error al verificar la tabla timelocks:",o)}await l.execute(`CREATE TABLE IF NOT EXISTS app_settings (
    id INTEGER PRIMARY KEY CHECK (id = 1),
    company_name TEXT NOT NULL DEFAULT 'Mi Empresa',
    company_email TEXT NOT NULL DEFAULT 'info@miempresa.com',
    company_logo_url TEXT,
    invoice_prefix TEXT NOT NULL DEFAULT 'INV-',
    default_currency TEXT NOT NULL DEFAULT 'USD',
    payment_methods TEXT NOT NULL DEFAULT '["bank_transfer","paypal","wise","crypto"]',
    notifications_enabled BOOLEAN NOT NULL DEFAULT 1,
    theme TEXT NOT NULL DEFAULT 'system',
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )`),(await l.execute("SELECT COUNT(*) as count FROM app_settings WHERE id = 1")).rows[0].count===0&&await l.execute("INSERT INTO app_settings (id) VALUES (1)")}const Dl=async t=>{const l=await j(t);if(!l.isAuthenticated)throw t.redirect(302,"/auth");return l},xt=Y(p(Dl,"s_euvihm1OmHg")),Ml=async t=>{var s,n,r,i,o,d;const l=O(t);try{const m=await l.execute("SELECT COUNT(*) as count FROM professionals"),c=await l.execute("SELECT COUNT(*) as count FROM contracts WHERE status = 'active'"),x=await l.execute("SELECT COUNT(*) as count, SUM(amount) as total FROM invoices WHERE status = 'pending'"),h=await l.execute({sql:`
        SELECT COUNT(*) as count 
        FROM payments 
        WHERE status = 'scheduled' AND payment_date BETWEEN date('now') AND date('now', '+7 days')
      `,args:[]}),w=await l.execute("SELECT SUM(total_in_knrt) as total FROM settlements WHERE status = 'paid'"),y=await l.execute({sql:`
        SELECT id, name, role, created_at 
        FROM professionals 
        ORDER BY created_at DESC 
        LIMIT 5
      `,args:[]}),v=await l.execute({sql:`
        SELECT 
          i.id, 
          i.amount, 
          i.currency, 
          i.status, 
          i.issue_date, 
          p.name as professional_name 
        FROM invoices i
        JOIN professionals p ON i.professional_id = p.id
        ORDER BY i.created_at DESC 
        LIMIT 5
      `,args:[]});return{professionals:((s=m.rows[0])==null?void 0:s.count)||0,activeContracts:((n=c.rows[0])==null?void 0:n.count)||0,pendingInvoices:{count:((r=x.rows[0])==null?void 0:r.count)||0,total:((i=x.rows[0])==null?void 0:i.total)||0},upcomingPayments:((o=h.rows[0])==null?void 0:o.count)||0,totalSettled:((d=w.rows[0])==null?void 0:d.total)||0,recentProfessionals:y.rows||[],recentInvoices:v.rows||[]}}catch(m){return console.error("Dashboard data loading error:",m),{professionals:0,activeContracts:0,pendingInvoices:{count:0,total:0},upcomingPayments:0,totalSettled:0,recentProfessionals:[],recentInvoices:[]}}},gt=Y(p(Ml,"s_FQa6Zhzh4t0")),Ol=(t,l="USD")=>{const s=l==="KNRT",n=s?"USD":l,r=new Intl.NumberFormat("en-US",{style:"currency",currency:n,minimumFractionDigits:2,maximumFractionDigits:2}).format(t);return s?`${r} KNRT`:r},Ul=()=>{var r,i;X(),xt();const t=gt();Je();const l=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=p(Ol,"s_W1w5p9RjLGU"),n={totalProfessionals:Number(t.value.professionals)||0,activeContracts:Number(t.value.activeContracts)||0,pendingInvoices:Number((r=t.value.pendingInvoices)==null?void 0:r.count)||0,upcomingPayments:Number(t.value.upcomingPayments)||0,totalSettled:Number(t.value.totalSettled)||0,pendingAmount:Number((i=t.value.pendingInvoices)==null?void 0:i.total)||0};return e("div",null,{class:"min-h-screen bg-white dark:bg-slate-900 flex flex-col"},e("div",null,{class:"container mx-auto px-4 py-8 flex-1 flex flex-col"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},[e("h1",null,{class:"text-2xl md:text-3xl font-bold mb-2 text-slate-800 dark:text-slate-100"},"Dashboard",3,null),e("p",null,{class:"text-sm md:text-base text-slate-500 dark:text-slate-400"},l,1,null)],1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Professionals",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},L(n,"totalProfessionals"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center text-slate-700 dark:text-slate-300 shadow-sm"},u(ge,{class:"w-6 h-6",[a]:{class:a}},3,"Pz_0"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Active Contracts",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},L(n,"activeContracts"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-teal-100 to-teal-200 dark:from-teal-800/30 dark:to-teal-700/30 flex items-center justify-center text-teal-600 dark:text-teal-400 shadow-sm"},u(Te,{class:"w-6 h-6",[a]:{class:a}},3,"Pz_1"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Invoices",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},L(n,"pendingInvoices"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-100 to-amber-200 dark:from-amber-800/30 dark:to-amber-700/30 flex items-center justify-center text-amber-600 dark:text-amber-400 shadow-sm"},u(ce,{class:"w-6 h-6",[a]:{class:a}},3,"Pz_2"),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700 transition-all hover:shadow-elegant-lg"},e("div",null,{class:"flex justify-between items-center"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Upcoming Payments",3,null),e("p",null,{class:"text-2xl font-bold mt-1 text-slate-800 dark:text-slate-100"},L(n,"upcomingPayments"),1,null)],1,null),e("div",null,{class:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-100 to-indigo-200 dark:from-indigo-800/30 dark:to-indigo-700/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400 shadow-sm"},u(Ne,{class:"w-6 h-6",[a]:{class:a}},3,"Pz_3"),1,null)],1,null),1,null)],1,null),e("div",null,{class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"flex justify-between items-center mb-4"},e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Financial Summary",3,null),3,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Settled",3,null),e("div",null,{class:"flex items-center mt-2"},e("span",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-100"},s(n.totalSettled,"KNRT"),1,null),1,null)],1,null),e("div",null,null,[e("p",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Amount",3,null),e("div",null,{class:"flex items-center mt-2"},e("span",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-100"},s(n.pendingAmount,"KNRT"),1,null),1,null)],1,null)],1,null),e("div",null,{class:"mt-6 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-700/50 dark:to-slate-800/50 rounded-lg h-48 flex items-center justify-center shadow-elegant-sm"},e("p",null,{class:"text-slate-500 dark:text-slate-400 text-sm font-medium"},"Monthly payments chart",3,null),3,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant p-6 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"flex justify-between items-center mb-4"},e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Recent Professionals",3,null),3,null),e("div",null,{class:"space-y-4"},t.value.recentProfessionals.length>0?t.value.recentProfessionals.map(o=>e("div",null,{class:"flex items-center p-2 hover:bg-slate-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors"},[e("div",null,{class:"w-10 h-10 rounded-full bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center text-slate-700 dark:text-slate-300 shadow-sm"},o.name.charAt(0).toUpperCase(),1,null),e("div",null,{class:"ml-3"},[e("p",null,{class:"font-medium text-sm text-slate-800 dark:text-slate-200"},L(o,"name"),1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400"},L(o,"role"),1,null)],1,null)],1,o.id)):e("div",null,{class:"text-center py-6 text-slate-500 dark:text-slate-400"},[e("div",null,{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-3"},u(ge,{class:"w-6 h-6 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"Pz_4"),1,null),e("p",null,null,"No professionals registered",3,null)],1,"Pz_5"),1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-xl shadow-elegant border border-slate-100 dark:border-slate-700 overflow-hidden"},[e("div",null,{class:"p-6"},e("h2",null,{class:"text-lg font-semibold mb-4 text-slate-800 dark:text-slate-100"},"Recent Invoices",3,null),3,null),e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"w-full"},[e("thead",null,null,e("tr",null,{class:"text-left bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800"},[e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Date",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Amount",3,null),e("th",null,{class:"px-6 py-3 text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null)],3,null),3,null),e("tbody",null,{class:"divide-y divide-gray-200 dark:divide-gray-700"},t.value.recentInvoices.length>0?t.value.recentInvoices.map(o=>e("tr",null,null,[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},L(o,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},new Date(o.issue_date).toLocaleDateString(),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm"},[new Intl.NumberFormat("es-ES",{style:"currency",currency:o.currency==="KNRT"?"USD":o.currency}).format(o.amount)," ",o.currency==="KNRT"?"KNRT":""],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${o.status==="paid"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":o.status==="awaiting_release"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"}`},null,o.status==="paid"?"Pagado":o.status==="awaiting_release"?"Esperando liberación":"Pendiente",1,null),1,null)],1,o.id)):e("tr",null,null,e("td",null,{colSpan:4,class:"px-6 py-8 text-center text-sm text-slate-500 dark:text-slate-400"},[e("div",null,{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-3"},u(ce,{class:"w-6 h-6 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"Pz_6"),1,null),e("p",null,null,"No recent invoices",3,null)],1,null),1,"Pz_7"),1,null)],1,null),1,null)],1,null)],1,null),1,"Pz_8")},Pl=Q(p(Ul,"s_G4PaHCacZj0")),jl=Object.freeze(Object.defineProperty({__proto__:null,default:Pl,useAuthLoader:xt,useDashboardDataLoader:gt},Symbol.toStringTag,{value:"Module"})),Fl=Ze.join(process.cwd(),"private_uploads"),Bl=async t=>{const{params:l,redirect:s,headers:n,error:r}=t;if(!(await j(t)).isAuthenticated)throw s(303,"/auth");const o=l.fileName;if(!o||o.includes("..")||o.includes("/"))throw r(400,"Invalid filename");const d=Ze.join(Fl,o);try{await ze.promises.access(d)}catch{throw r(404,"File not found")}try{const m=await ze.promises.readFile(d);n.set("Content-Type","application/pdf"),n.set("Content-Length",m.length.toString()),n.set("Content-Disposition",`inline; filename="${o}"`),t.send(new Response(m));return}catch(m){throw console.error("Failed to read file:",m),r(500,"Could not read file")}},$l=Object.freeze(Object.defineProperty({__proto__:null,onGet:Bl},Symbol.toStringTag,{value:"Module"})),ql=Se(process.cwd(),"private_uploads","invoices"),Yl=async t=>{var i;const{params:l,error:s,headers:n}=t;if(!(await j(t)).isAuthenticated)throw s(401,"Unauthorized");try{const o=l.fileName;if(o.includes("..")||o.includes("/"))throw s(400,"Invalid file name");const d=Se(ql,o),m=await Qt(d),c=(i=o.split(".").pop())==null?void 0:i.toLowerCase();let x="application/octet-stream";c==="pdf"?x="application/pdf":["png","jpg","jpeg","gif","webp"].includes(c||"")&&(x=`image/${c}`),n.set("Content-Type",x),n.set("Content-Length",m.length.toString()),n.set("Content-Disposition",`inline; filename="${o}"`);const h=new Response(new Uint8Array(m),{headers:n});t.send(h)}catch(o){throw console.error("File serving failed:",o),s(404,"File not found")}},Hl=Object.freeze(Object.defineProperty({__proto__:null,onGet:Yl},Symbol.toStringTag,{value:"Module"})),Gl=async t=>{const{json:l,error:s}=t;if(!(await j(t)).isAuthenticated)throw s(401,"Unauthorized");try{const i=(await t.request.formData()).get("contract");if(!i)throw s(400,"No file uploaded.");if(i.type!=="application/pdf")throw s(400,"Only PDF files are allowed.");const o=tt(8).toString("hex"),d=Re.extname(i.name)||".pdf",m=`${Re.basename(i.name,d)}-${Date.now()}-${o}${d}`,c=Re.join(process.cwd(),"private_uploads");await et(c,{recursive:!0});const x=Re.join(c,m),h=Buffer.from(await i.arrayBuffer());await $e(x,h),l(200,{success:!0,fileName:m})}catch(r){const i=r&&typeof r=="object"&&"message"in r&&typeof r.message=="string"?r.message:String(r);throw console.error("File upload error:",i),r&&typeof r.status<"u"?r:s(500,i||"An unexpected error occurred during file upload.")}},zl=Object.freeze(Object.defineProperty({__proto__:null,onPost:Gl},Symbol.toStringTag,{value:"Module"})),Wl=async t=>{const s=(await t.request.formData()).get("file");if(!s||typeof s=="string"){t.json(400,{error:"No file uploaded"});return}const n=await s.arrayBuffer(),r=Buffer.from(n),i=s.type.split("/")[1]||"jpg",o=`tree-${Date.now()}-${Math.random().toString(36).slice(2,8)}.${i}`,d=Se(process.cwd(),"public","uploads",o);await $e(d,r),t.json(200,{url:`/uploads/${o}`})},Vl=Object.freeze(Object.defineProperty({__proto__:null,onPost:Wl},Symbol.toStringTag,{value:"Module"})),Ke=Se(process.cwd(),"private_uploads","invoices"),Xl=async t=>{const{request:l,error:s,json:n}=t;if(!(await j(t)).isAuthenticated){n(401,{success:!1,error:"Unauthorized"});return}try{await et(Ke,{recursive:!0});const o=(await l.formData()).get("file");if(!o){n(400,{success:!1,error:"File not provided"});return}if(!o.type.startsWith("application/pdf")&&!o.type.startsWith("image/")){n(400,{success:!1,error:"Invalid file type. Only PDF and images are allowed."});return}if(o.size>10485760){n(400,{success:!1,error:"File is too large. Max size is 10MB."});return}const d=Buffer.from(await o.arrayBuffer()),m=`${Date.now()}-${tt(6).toString("hex")}`,c=o.name.split(".").pop()||"file",x=`invoice-${m}.${c}`,h=Se(Ke,x);await $e(h,d),n(200,{success:!0,fileName:x});return}catch(i){console.error("File upload failed:",i),n(500,{success:!1,error:`Upload failed: ${i.message||"Unknown error"}`});return}},Kl=Object.freeze(Object.defineProperty({__proto__:null,onPost:Xl},Symbol.toStringTag,{value:"Module"})),Ql=({cookie:t,redirect:l})=>{throw t.delete("auth_token",{path:"/"}),t.delete("user_type",{path:"/"}),l(302,"/auth")},Jl=async(t,l)=>{try{console.log("[LOGOUT] Starting logout process"),qe(l),await new Promise(r=>setTimeout(r,100));const s=l.cookie.get("auth_token"),n=l.cookie.get("user_type");if(s||n)throw console.error("[LOGOUT] Cookies not cleared properly:",{authToken:s,userType:n}),new Error("Failed to clear authentication cookies");return console.log("[LOGOUT] Successfully cleared all cookies"),l.redirect(302,"/auth"),{success:!0}}catch(s){return console.error("Logout error:",s),{success:!1,error:s instanceof Error?s.message:"Logout failed"}}},ht=q(p(Jl,"s_lYyU40i0tiI")),Zl=()=>{var s,n;X();const t=ht(),l=((s=t.value)==null?void 0:s.success)===!1;return e("div",null,{class:"min-h-screen w-full flex items-center justify-center transition-colors duration-300 bg-gradient-to-b from-blue-50 to-indigo-100 dark:from-gray-950 dark:to-blue-950 py-6 px-4 sm:px-6 lg:px-8 overflow-hidden relative"},[e("div",null,{class:"fixed inset-0 pointer-events-none overflow-hidden"},[e("div",null,{class:"w-20 h-20 bg-blue-500/10 rounded-full absolute top-[10%] left-[15%] animate-[float_15s_infinite]"},null,3,null),e("div",null,{class:"w-32 h-32 bg-indigo-500/10 rounded-full absolute top-[30%] left-[65%] animate-[float_18s_infinite]",style:"animation-delay: 0.5s;"},null,3,null),e("div",null,{class:"w-16 h-16 bg-teal-500/10 rounded-full absolute top-[70%] left-[25%] animate-[float_12s_infinite]",style:"animation-delay: 1s;"},null,3,null)],3,null),e("div",null,{class:"absolute top-6 left-1/2 transform -translate-x-1/2"},e("div",null,{class:"flex items-center"},[e("div",null,{class:"relative"},e("div",null,{class:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white shadow-lg"},e("svg",null,{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},e("path",null,{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9 9 10.5-3m0 6.553v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 1 1-.99-3.467l2.31-.66a2.25 2.25 0 0 0 1.632-2.163Zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 0 1-.99-3.467l2.31-.66A2.25 2.25 0 0 0 9 15.553Z"},null,3,null),3,null),3,null),3,null),e("h1",null,{class:"ml-2 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400"},"Move On Challenge",3,null)],3,null),3,null),e("div",null,{class:"max-w-md w-full z-10"},[e("div",null,{class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden backdrop-blur-sm p-8 animate-[fade-in_0.5s_ease-out]"},[e("div",null,{class:"text-center mb-8"},[e("h2",null,{class:"text-3xl font-bold mb-3 text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400"},"Log Out",3,null),e("p",null,{class:"text-gray-600 dark:text-gray-400"},"Are you sure you want to log out?",3,null)],3,null),u(K,{action:t,class:"space-y-6",spaReset:!0,get"preventdefault:submit"(){return t.isRunning},children:[e("button",null,{type:"submit",disabled:b(r=>r.isRunning,[t],"p0.isRunning"),class:"w-full flex justify-center items-center py-3 px-4 rounded-xl text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 dark:from-blue-500 dark:to-indigo-500 dark:hover:from-blue-600 dark:hover:to-indigo-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},t.isRunning?e("span",null,{class:"flex items-center"},[u(Ie,{class:"animate-spin mr-2 h-5 w-5",[a]:{class:a}},3,"6d_0"),"Logging out..."],1,"6d_1"):e("span",null,{class:"flex items-center"},[u(ct,{class:"mr-2 h-5 w-5",[a]:{class:a}},3,"6d_2"),"Confirm Logout"],1,null),1,null),l&&e("div",null,{class:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm mt-4"},[e("p",null,null,"There was a problem logging you out. Please try again.",3,null),((n=t.value)==null?void 0:n.error)&&e("p",null,{class:"mt-1 text-xs opacity-80"},b(r=>r.value.error,[t],"p0.value.error"),3,"6d_3")],1,"6d_4"),e("a",null,{href:"/challenges",class:"block w-full text-center mt-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors duration-200"},"Cancel",3,null)],[a]:{action:a,class:a,spaReset:a,"preventdefault:submit":b(r=>r.isRunning,[t],"p0.isRunning")}},1,"6d_5")],1,null),e("div",null,{class:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400"},"Thank you for using Move On Challenge",3,null)],1,null),e("style",null,null,`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes float {
          0% { transform: translate(0, 0); }
          25% { transform: translate(5px, -15px); }
          50% { transform: translate(10px, 0); }
          75% { transform: translate(5px, 15px); }
          100% { transform: translate(0, 0); }
        }
        
        @keyframes fade-in {
          0% { opacity: 0; }
          100% { opacity: 1; }
        }
      `,3,null)],1,"6d_6")},es=Q(p(Zl,"s_zqPwfW3jn0I")),ts=Object.freeze(Object.defineProperty({__proto__:null,default:es,onGet:Ql,useLogout:ht},Symbol.toStringTag,{value:"Module"})),ls=async(t,l)=>{try{return console.log("[LOGOUT] Starting logout process"),qe(l),l.redirect(302,"/auth"),{success:!0}}catch(s){return console.error("Logout error:",s),{success:!1,error:s instanceof Error?s.message:"Logout failed"}}},ss=q(p(ls,"s_uyYPcWOxv4U")),as=async(t,l)=>{const s=O(l),{email:n}=t;try{return{success:!0,isRegistered:(await s.execute({sql:"SELECT id FROM users WHERE email = ?",args:[n]})).rows.length>0}}catch(r){return console.error("Email check error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to check email"}}},bt=q(p(as,"s_DmU9OP9DRTo")),ns=async(t,l)=>{const s=O(l),{email:n,password:r,username:i}=t;try{const o=await al(r),m=(await s.execute({sql:"SELECT COUNT(*) as count FROM users",args:[]})).rows[0].count===0,c=n==="golfredo.pf@gmail.com"||m?"admin":"freelancer";let x;if(x=(await s.execute({sql:"INSERT INTO users (email, password_hash, type, username) VALUES (?, ?, ?, ?)",args:[n,o,c,i||n.split("@")[0]]})).lastInsertRowid,!x)throw new Error("Registration failed: userId is undefined");return st(l,x,c),l.redirect(302,"/"),{success:!0}}catch(o){return console.error("Registration error:",o),{success:!1,error:o instanceof Error?o.message:"Registration failed"}}},vt=q(p(ns,"s_ifiWVdoZ0cQ")),rs=async t=>({success:!0}),Fe=Y(p(rs,"s_0gRwIEUvq0E")),os=async(t,l)=>{const s=O(l),{email:n,password:r}=t;try{console.log("[LOGIN] Intentando login para email:",n);const i=await s.execute({sql:"SELECT * FROM users WHERE email = ?",args:[n]});console.log("[LOGIN] Resultado de búsqueda en DB:",i.rows);const o=i.rows[0];if(!o)return console.error("[LOGIN] Usuario no encontrado para email:",n),{success:!1,error:"Usuario no encontrado"};if(typeof o.password_hash!="string")return console.error("[LOGIN] password_hash inválido:",o.password_hash),{success:!1,error:"password_hash inválido"};if(!o.id)return console.error("[LOGIN] user.id inválido:",o.id),{success:!1,error:"user.id inválido"};console.log("[LOGIN] password ingresada:",r),console.log("[LOGIN] hash guardado:",o.password_hash);const d=await nl(r,o.password_hash);if(console.log("[LOGIN] resultado de verifyPassword:",d),!d)return console.error("[LOGIN] Contraseña incorrecta para email:",n),{success:!1,error:"Contraseña incorrecta"};const m=String(o.id);try{await s.execute({sql:"UPDATE users SET session_expires = ? WHERE id = ?",args:[new Date(Date.now()+36e5),m]}),console.log("[LOGIN] session_expires actualizado para user:",m)}catch(x){console.error("[LOGIN] Error actualizando session_expires:",x)}const c=o.type==="admin"?"admin":o.type==="super_admin"?"super_admin":"freelancer";return st(l,m,c),console.log("[LOGIN] Cookies seteadas para user:",m,c),l.redirect(302,"/"),{success:!0}}catch(i){return console.error("[LOGIN] Error general en login:",i),{success:!1,error:"Login failed"}}},wt=q(p(os,"s_YXIc7hgvWuM")),is=async()=>{var i,o;const[t,l,s,n,r]=C();n.value=!0,s.value="",await new Promise(d=>setTimeout(d,500)),(i=t.value)!=null&&i.success?(r.value=t.value.isRegistered?"password":"register",l.value=document.getElementById("email").value):s.value=((o=t.value)==null?void 0:o.error)||"Failed to check email",n.value=!1},us=async()=>{var n,r;const[t,l,s]=C();l.value=!0,t.value="",await new Promise(i=>setTimeout(i,500)),(n=s.value)!=null&&n.success||(t.value=((r=s.value)==null?void 0:r.error)||"Login failed"),l.value=!1},ds=async()=>{var n,r;const[t,l,s]=C();l.value=!0,t.value="",await new Promise(i=>setTimeout(i,500)),(n=s.value)!=null&&n.success||(t.value=((r=s.value)==null?void 0:r.error)||"Registration failed"),l.value=!1},cs=()=>{var c;X(),Fe();const t=Fe(),l=bt(),s=vt(),n=wt(),r=f("email"),i=f(""),o=f(""),d=f(""),m=f(!1);return(c=t.value)!=null&&c.success&&console.log("Tables initialized successfully"),e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 flex flex-col items-center justify-center"},[e("header",null,{class:"w-full flex flex-col items-center py-8 mb-2"},[e("h1",null,{class:"text-3xl md:text-4xl font-extrabold text-slate-700 dark:text-teal-400 mb-2 flex items-center gap-2 animate-slide-down"},[e("span",null,{role:"img","aria-label":"clock"},"⏱️",3,null)," Welcome to SaveeTimelock"],3,null),e("p",null,{class:"text-center text-lg text-slate-600 dark:text-slate-300 max-w-2xl animate-fade-in"},"Sign in or register to start tracking your time and managing your projects.",3,null)],3,null),e("section",null,{class:"w-full flex flex-col items-center"},e("div",null,{class:"w-full max-w-md rounded-3xl overflow-hidden shadow-2xl bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-2 md:p-6 animate-grow-in transition-transform duration-700"},[r.value==="email"&&u(K,{action:l,class:"space-y-6",onSubmit$:p(is,"s_xydvnoO3NQo",[l,i,d,m,r]),children:[e("div",null,{class:"space-y-2"},[e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Email address",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},u(dl,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"eD_0"),1,null),e("input",null,{id:"email",name:"email",type:"email",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"your@email.com"},null,3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"},"We'll check if you already have an account",3,null)],1,null),e("button",null,{type:"submit",disabled:b(x=>x.value,[m],"p0.value"),class:"w-full flex justify-center items-center py-3 px-4 rounded-xl text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[u(Ie,{class:"animate-spin mr-2 h-5 w-5 text-white",[a]:{class:a}},3,"eD_1"),"Verifying..."],1,"eD_2"):"Continue",1,null)],[a]:{action:a,class:a,onSubmit$:a}},1,"eD_3"),r.value==="password"&&u(K,{action:n,class:"space-y-6",onSubmit$:p(us,"s_90k8QQrQSdk",[d,m,n]),children:[e("input",null,{type:"hidden",name:"email",value:b(x=>x.value,[i],"p0.value")},null,3,null),e("div",null,{class:"space-y-2"},[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Password",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},u(Ue,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"eD_4"),1,null),e("input",null,{id:"password",name:"password",type:"password",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"••••••••"},null,3,null)],1,null)],1,null),e("div",null,{class:"flex justify-between items-center"},[e("button",null,{type:"button",class:"flex items-center px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all duration-200 text-sm",onClick$:g("s_SkMVgm4N03A",[d,o,r])},[u(Ve,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"eD_5"),"Back"],1,null),e("button",null,{type:"submit",disabled:b(x=>x.value,[m],"p0.value"),class:"flex justify-center items-center py-2 px-6 rounded-lg text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[u(Ie,{class:"animate-spin mr-2 h-5 w-5 text-white",[a]:{class:a}},3,"eD_6"),"Signing in..."],1,"eD_7"):"Sign in",1,null)],1,null)],[a]:{action:a,class:a,onSubmit$:a}},1,"eD_8"),r.value==="register"&&u(K,{action:s,class:"space-y-6",onSubmit$:p(ds,"s_3ewRqCLfpMg",[d,m,s]),children:[e("input",null,{type:"hidden",name:"email",value:b(x=>x.value,[i],"p0.value")},null,3,null),e("div",null,{class:"space-y-2"},[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-200"},"Create a password",3,null),e("div",null,{class:"relative"},[e("div",null,{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},u(Ue,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"eD_9"),1,null),e("input",null,{id:"password",name:"password",type:"password",required:!0,class:"pl-10 block w-full rounded-xl border-0 py-3 text-slate-700 dark:text-white shadow-sm ring-1 ring-inset ring-slate-300 dark:ring-slate-600 placeholder:text-slate-400 dark:placeholder:text-slate-500 focus:ring-2 focus:ring-inset focus:ring-teal-500 dark:focus:ring-teal-400 bg-white dark:bg-gray-800",placeholder:"••••••••",minLength:6},null,3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"},"Password must be at least 6 characters",3,null)],1,null),e("div",null,{class:"flex justify-between items-center"},[e("button",null,{type:"button",class:"flex items-center px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all duration-200 text-sm",onClick$:g("s_sFCb2F6Zv7w",[d,o,r])},[u(Ve,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"eD_10"),"Back"],1,null),e("button",null,{type:"submit",disabled:b(x=>x.value,[m],"p0.value"),class:"flex justify-center items-center py-2 px-6 rounded-lg text-white bg-gradient-to-r from-slate-700 to-teal-500 hover:from-slate-800 hover:to-teal-600 dark:from-slate-700 dark:to-teal-600 font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed"},m.value?e("span",null,{class:"flex items-center"},[u(Ie,{class:"animate-spin mr-2 h-5 w-5 text-white",[a]:{class:a}},3,"eD_11"),"Creating account..."],1,"eD_12"):"Create account",1,null)],1,null)],[a]:{action:a,class:a,onSubmit$:a}},1,"eD_13"),d.value&&e("div",null,{class:"mt-6 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-800 rounded-xl animate-[slide-up_0.3s_ease-out]"},e("div",null,{class:"flex items-start"},[u(rl,{class:"h-5 w-5 text-rose-500 dark:text-rose-400 mt-0.5 mr-2 flex-shrink-0",[a]:{class:a}},3,"eD_14"),e("p",null,{class:"text-sm text-rose-600 dark:text-rose-300"},b(x=>x.value,[d],"p0.value"),3,null)],1,null),1,"eD_15")],1,null),1,null),e("div",null,{class:"mt-6 text-center text-sm text-slate-600 dark:text-slate-400"},["By continuing, you agree to our",e("a",null,{href:"#",class:"text-teal-600 hover:text-teal-500 dark:text-teal-400 dark:hover:text-teal-300 ml-1"},"Terms of Service",3,null),e("span",null,{class:"mx-1"},"and",3,null),e("a",null,{href:"#",class:"text-teal-600 hover:text-teal-500 dark:text-teal-400 dark:hover:text-teal-300"},"Privacy Policy",3,null)],3,null),e("style",null,null,`
        .animate-fade-in { animation: fadeIn 1s both; }
        .animate-slide-down { animation: slideDown 0.8s both; }
        .animate-slide-up { animation: slideUp 0.7s both; }
        .animate-grow-in { animation: growIn 1.2s both; }
        .animate-pop { animation: popIn 0.5s both; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-40px); } to { opacity: 1, transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1, transform: translateY(0); } }
        @keyframes growIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1, transform: scale(1); } }
        @keyframes popIn { 0% { transform: scale(0.7); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); } }
      `,3,null)],1,"eD_16")},ms=Q(p(cs,"s_86Uj5I0HEKo")),ps=Object.freeze(Object.defineProperty({__proto__:null,default:ms,useCheckEmail:bt,useDbInitializer:Fe,useLogin:wt,useLogout:ss,useRegister:vt},Symbol.toStringTag,{value:"Module"}));function he(t){return t?"is_admin"in t&&typeof t.is_admin=="boolean"?t.is_admin:"role"in t&&typeof t.role=="string"?t.role==="admin"||t.role==="super_admin":!1:!1}const fs=async t=>{const l=await j(t);if(!l.isAuthenticated)return t.fail(401,{error:"Unauthorized"});const s=O(t);let n=`SELECT c.id, c.professional_id, p.name as professional_name, p.email as professional_email, c.start_date, c.end_date, c.status, c.contract_url 
    FROM contracts c
    JOIN professionals p ON c.professional_id = p.id`,r=[];return he(l)||(n+=" WHERE p.email = ?",r.push(l.email)),n+=" ORDER BY c.start_date DESC",{contracts:(await s.execute({sql:n,args:r})).rows.map(d=>({id:typeof d.id=="number"?d.id:0,professional_id:typeof d.professional_id=="number"?d.professional_id:0,professional_name:typeof d.professional_name=="string"?d.professional_name:"N/A",professional_email:typeof d.professional_email=="string"?d.professional_email:"N/A",start_date:typeof d.start_date=="string"?d.start_date:"",end_date:typeof d.end_date=="string"?d.end_date:"",status:typeof d.status=="string"?d.status:"unknown",contract_url:typeof d.contract_url=="string"?d.contract_url:null})),session:l}},kt=Y(p(fs,"s_pOtMp0xpTww")),xs=async t=>(await O(t).execute("SELECT id, name, role FROM professionals")).rows,yt=Y(p(xs,"s_f6iI4LuEstI")),gs=async(t,l)=>{const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return l.redirect(303,"/auth");let r=t.professionalId;if(!he(n)){const i=await s.execute({sql:"SELECT id FROM professionals WHERE user_id = ?",args:[n.userId]});if(!i.rows.length)return l.fail(403,{error:"No professional profile found for this user."});r=String(i.rows[0].id)}try{return await s.execute({sql:"INSERT INTO contracts (professional_id, user_id, start_date, end_date, status, contract_url) VALUES (?, ?, ?, ?, ?, ?)",args:[r||"",n.userId,t.startDate,t.endDate,"active",t.contractUrl??null]}),{success:!0}}catch(i){return console.error("Failed to create contract:",i),{success:!1,error:"Failed to create contract."}}},hs=t=>t.object({professionalId:t.string().optional(),startDate:t.string().min(1,"Start date is required."),endDate:t.string().min(1,"End date is required."),contractUrl:t.string().optional().nullable()}),_t=q(p(gs,"s_LIYrlyegNzI"),te(p(hs,"s_JXXcjSD3j1E"))),bs=({track:t})=>{const[l]=C(),s=t(()=>l.value);s&&!("failed"in s&&s.failed)&&!("formErrors"in s&&Array.isArray(s.formErrors)&&s.formErrors.length>0)&&typeof window<"u"&&window.location.reload()},vs=({track:t})=>{const[l,s,n]=C(),r=t(()=>l),i=t(()=>n.value.trim().toLowerCase());i?s.value=r.filter(o=>o.professional_name.toLowerCase().includes(i)||o.professional_email.toLowerCase().includes(i)||o.id.toString().includes(i)||o.status.toLowerCase().includes(i)):s.value=r},ws=()=>{const[t,l,s,n,r,i,o,d]=C();i.value="",o.value="",s.value="",l.value=null,t.value="",r.value=!1,d.value="",n.value&&(n.value.value="")},ks=async t=>{const[l,s,n,r]=C(),i=t.target;if(!i.files||i.files.length===0)return;const o=i.files[0];if(o.type!=="application/pdf"){r.value="Only PDF files are allowed.";return}n.value=!0,r.value="";const d=new FormData;d.append("contract",o);try{const m=await fetch("/api/upload-contract",{method:"POST",body:d});if(!m.ok){let x="Upload failed";try{const h=await m.json();h&&typeof h.error=="string"&&h.error.length>0&&(x=h.error)}catch{}throw new Error(x)}const c=await m.json();s.value=c.fileName||"",l.value=c.fileName?`/api/contracts/view/${c.fileName}`:""}catch(m){r.value=m&&typeof m.message=="string"&&m.message.length>0?m.message:"An unexpected error occurred.",s.value=null,l.value=""}finally{n.value=!1}},ys=()=>{const[t,l]=C();l.value=!1,t()},_s=()=>{var z,E;X();const t=kt(),l=yt(),s=_t();xe(p(bs,"s_vbBz20uaL9Q",[s]));const n=((z=t.value)==null?void 0:z.contracts)??[],r=(E=t.value)==null?void 0:E.session,i=!!r&&he(r);let o=null;!i&&n.length>0&&(o=String(n[0].professional_id)),typeof window<"u"&&(console.log("[DEBUG contracts] isAdminUser:",i),console.log("[DEBUG contracts] userProfessionalId:",o),console.log("[DEBUG contracts] contracts:",n),console.log("[DEBUG contracts] professionals.value:",l.value));const d=f(""),m=f(!1),c=f(""),x=f(""),h=f(""),w=f(null),y=f(""),v=f(!1),S=f(""),N=f(),U=f(n);xe(p(vs,"s_0p2McuoVgUs",[n,U,d]));const F=p(ws,"s_g0LwifoYHg8",[y,w,h,N,v,c,x,S]),$=p(ks,"s_cm8OO2jiQek",[y,w,v,S]),P=T=>{if(!T)return"N/A";const B=new Date(T),H=B.getTimezoneOffset()*6e4;return new Date(B.getTime()+H).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[u(Te,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"d3_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Contracts",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage contracts with professionals",3,null)],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3"},[i&&e("button",{onClick$:g("s_3D44dgnfvmk",[i,m])},{class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[u(Ce,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"d3_1"),"Create Contract"],0,"d3_2"),e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[u(ot,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"d3_3"),"Export"],1,null)],1,null)],1,null),1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},u(Ye,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"d3_4"),1,null),e("input",null,{type:"text",value:d,class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by professional or ID...",onInput$:g("s_fr6YtxdVoQM",[d])},null,3,null)],1,null),e("div",null,{class:"flex-shrink-0"},e("button",null,{class:"inline-flex items-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[u(dt,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"d3_5"),"Filter"],1,null),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"ID",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Email",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Start Date",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"End Date",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},Array.isArray(U.value)?U.value.map(T=>{var H,W;X();const B=typeof T.contract_url=="string"?T.contract_url:null;return e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-700 dark:text-slate-200 group-hover:text-teal-600 dark:group-hover:text-teal-500"},["#CONT-",T.id.toString().padStart(3,"0")],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-700 dark:text-slate-200 font-medium"},T.professional_name||"N/A",1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},T.professional_email||"N/A",1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},P(T.start_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},P(T.end_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${T.status==="active"?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-rose-50 to-rose-100 text-rose-700 dark:from-rose-900/30 dark:to-rose-800/30 dark:text-rose-400"}`},null,((H=T.status)==null?void 0:H.charAt(0).toUpperCase())+((W=T.status)==null?void 0:W.slice(1))||"N/A",1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[B?e("a",{href:`/api/contracts/view/${B}`},{target:"_blank",rel:"noopener noreferrer",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all",title:"View Contract"},u(Ee,{class:"h-5 w-5",[a]:{class:a}},3,"d3_6"),1,"d3_7"):e("button",null,{class:"p-1.5 text-slate-400 dark:text-slate-600 rounded-full transition-all cursor-not-allowed",disabled:!0,title:"No contract uploaded"},u(Ee,{class:"h-5 w-5",[a]:{class:a}},3,"d3_8"),1,null),e("button",null,{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:text-indigo-400 dark:hover:bg-indigo-900/20 rounded-full transition-all"},u(ce,{class:"h-5 w-5",[a]:{class:a}},3,"d3_9"),1,null)],1,null),1,null)],1,T.id)}):e("tr",null,null,e("td",null,{colSpan:6,class:"text-center text-red-500 py-8"},"Error loading contracts. Please try again.",3,null),3,"d3_10"),1,null)],1,null),1,null),U.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},[e("div",null,{class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-4"},u(Te,{class:"w-8 h-8 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"d3_11"),1,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No contracts found.",3,null),e("p",null,{class:"text-slate-400 dark:text-slate-500 mt-1 text-sm"},"Create a new contract to get started.",3,null)],1,"d3_12")],1,null),e("div",null,{class:"flex items-center justify-between mt-6 bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-slate-100 dark:border-slate-700"},e("div",null,{class:"text-sm text-slate-600 dark:text-slate-400"},["Showing ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(T=>T.value.length,[U],"p0.value.length"),3,null)," of ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},L(n,"length"),1,null)," contracts"],1,null),1,null)],1,null),m.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:g("s_vbDtEMOt8dg",[m])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},u(K,{action:s,onSubmitCompleted$:p(ys,"s_wxLSoFiDGro",[F,m]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},e("div",null,{class:"sm:flex sm:items-start"},e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Create New Contract",3,null),e("div",null,{class:"mt-4"},e("div",null,{class:"space-y-4"},[i?e("div",null,null,[e("label",null,{for:"professional",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Professional",3,null),e("select",null,{name:"professionalId",id:"professional",value:c,class:"mt-1 block w-full pl-3 pr-10 py-3 text-base border border-slate-300 dark:border-slate-600 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 shadow-sm transition-all",required:!0,onInput$:g("s_K0awB0bLaxM",[c])},[e("option",null,{value:""},"Select a professional",3,null),l.value.map(T=>e("option",{value:L(T,"id")},null,`${T.name} - ${T.role}`,1,`prof-${T.id}`))],1,null)],1,"d3_13"):e("input",{value:o??""},{type:"hidden",name:"professionalId"},null,3,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"start-date",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Start Date",3,null),e("input",null,{type:"date",name:"startDate",id:"start-date",value:x,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:g("s_MJ0xPQa0QLc",[x])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"end-date",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"End Date",3,null),e("input",null,{type:"date",name:"endDate",id:"end-date",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:g("s_PFNm876R0OE",[h])},null,3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Contract PDF",3,null),y.value?e("div",null,{class:"mt-2"},[e("div",null,{class:"relative h-64 w-full rounded-lg border border-slate-300 dark:border-slate-600 overflow-hidden group"},[e("iframe",null,{src:b(T=>T.value,[y],"p0.value"),class:"h-full w-full",title:"Contract Preview"},null,3,null),e("a",null,{href:b(T=>T.value,[y],"p0.value"),target:"_blank",rel:"noopener noreferrer",class:"absolute top-2 right-2 p-2 bg-slate-700/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Open in new tab"},u(it,{class:"h-5 w-5",[a]:{class:a}},3,"d3_14"),1,null)],1,null),e("button",null,{type:"button",class:"mt-2 inline-flex items-center text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400",onClick$:g("s_QAjq0gRc9qQ",[y,w,N])},[u(pt,{class:"mr-1.5 h-4 w-4",[a]:{class:a}},3,"d3_15"),"Remove PDF"],1,null)],1,"d3_16"):e("div",null,{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 dark:border-slate-600 border-dashed rounded-lg"},e("div",null,{class:"space-y-1 text-center"},[v.value?u(se,{class:"mx-auto h-12 w-12 text-slate-400 animate-spin",[a]:{class:a}},3,"d3_17"):u(ut,{class:"mx-auto h-12 w-12 text-slate-400",[a]:{class:a}},3,"d3_18"),e("div",null,{class:"flex text-sm text-slate-600 dark:text-slate-400"},[e("label",null,{for:"file-upload",class:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-teal-600 dark:text-teal-500 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500"},[e("span",null,null,"Upload a file",3,null),e("input",{ref:N},{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"application/pdf",disabled:b(T=>T.value,[v],"p0.value"),onChange$:$},null,3,null)],1,null),e("p",null,{class:"pl-1"},"or drag and drop",3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-500"},"PDF up to 10MB",3,null)],1,null),1,null),S.value&&e("p",null,{class:"mt-2 text-sm text-red-600 dark:text-red-500"},b(T=>T.value,[S],"p0.value"),3,"d3_19"),e("input",null,{type:"hidden",name:"contractUrl",value:b(T=>T.value??"",[w],'p0.value??""')},null,3,null)],1,null)],1,null),1,null)],1,null),1,null),1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b((T,B)=>T.isRunning||B.value,[s,v],"p0.isRunning||p1.value"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"},[s.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"d3_20"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"d3_21"),"Save Contract"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_C788vIi2DC8",[F,m])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"d3_22"),"Cancel"],1,null)],1,null),s.value&&("success"in s.value&&s.value.success===!1||"failed"in s.value&&s.value.failed)&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"d3_23"),"error"in s.value&&typeof s.value.error=="string"&&s.value.error.length>0?e("span",null,null,b(T=>T.value.error,[s],"p0.value.error"),3,"d3_24"):null,Array.isArray(s.value.formErrors)&&s.value.formErrors.length>0&&e("ul",null,{class:"mt-2 list-disc list-inside text-sm"},s.value.formErrors.map(T=>e("li",null,null,T,1,"d3_25")),1,"d3_26"),typeof s.value.fieldErrors=="object"&&s.value.fieldErrors!==null&&e("ul",null,{class:"mt-2 list-disc list-inside text-sm"},Object.entries(s.value.fieldErrors).map(([T,B])=>Array.isArray(B)&&B.length>0?e("li",null,null,[e("b",null,null,[T,":"],1,null)," ",B.join(", ")],1,T):null),1,"d3_27")],1,"d3_28")],[a]:{action:a,onSubmitCompleted$:a}},1,"d3_29"),1,null)],1,null),1,"d3_30")],1,"d3_31")},Ts=Q(p(_s,"s_bsFwD0XY188")),Es=Object.freeze(Object.defineProperty({__proto__:null,default:Ts,useContractsLoader:kt,useCreateContract:_t,useProfessionalsLoader:yt},Symbol.toStringTag,{value:"Module"})),Ss=async t=>{const l=await j(t);if(!(l!=null&&l.isAuthenticated))throw t.redirect(302,"/auth");return l},Tt=Y(p(Ss,"s_0RlA56KjQ2c")),Ls=async t=>{const l=O(t),s=await j(t);let n;s.isAuthenticated&&s.role==="admin"?n=await l.execute(`
      SELECT i.id, i.professional_id, p.name as professional_name, i.contract_id, i.amount, i.currency, i.status, i.issue_date, i.paid_date, i.invoice_url, i.created_date 
      FROM invoices i
      JOIN professionals p ON i.professional_id = p.id
      ORDER BY i.created_date DESC
    `):s.isAuthenticated&&s.email?n=await l.execute({sql:`SELECT i.id, i.professional_id, p.name as professional_name, i.contract_id, i.amount, i.currency, i.status, i.issue_date, i.paid_date, i.invoice_url, i.created_date 
            FROM invoices i
            JOIN professionals p ON i.professional_id = p.id
            JOIN contracts c ON i.contract_id = c.id
            WHERE p.email = ?
            ORDER BY i.created_date DESC`,args:[s.email]}):n={rows:[]};const r=await l.execute("SELECT id, name, role FROM professionals ORDER BY name"),i=await l.execute(`
    SELECT c.id, c.professional_id, p.name as professional_name, c.start_date, c.end_date
    FROM contracts c
    JOIN professionals p ON c.professional_id = p.id
    WHERE c.status = 'active'
    ORDER BY p.name, c.start_date DESC
  `);return{invoices:n.rows.map(o=>({...o,amount:Number(o.amount)})),professionals:r.rows,contracts:i.rows}},Et=Y(p(Ls,"s_ZuT2HY9zmpM")),Rs=async(t,l)=>{const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};const r=await s.execute({sql:"SELECT professional_id FROM contracts WHERE id = ?",args:[t.contractId]});if(r.rows.length===0)return{success:!1,error:"Contract not found."};const i=r.rows[0].professional_id;try{const o=new Date().toISOString();return await s.execute({sql:"INSERT INTO invoices (contract_id, professional_id, user_id, issue_date, amount, currency, status, paid_date, invoice_url, created_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",args:[t.contractId,i,n.userId,t.issueDate,t.amount,t.currency,t.status,t.status==="paid"?new Date().toISOString().split("T")[0]:null,t.invoiceUrl,o]}),{success:!0}}catch(o){return console.error("Failed to add invoice:",o),{success:!1,error:"Failed to add invoice."}}},As={contractId:I.coerce.number().int().positive(),issueDate:I.string().regex(/^\d{4}-\d{2}-\d{2}$/),amount:I.coerce.number().positive(),currency:I.string(),status:I.enum(["pending","paid"]),invoiceUrl:I.string().optional().nullable()},St=q(p(Rs,"s_8G0MNZu2NZ0"),te(p(As,"s_H13o942bCtI"))),Is=async({id:t,status:l},s)=>{const n=O(s),r=l==="paid"?"pending":"paid",i=r==="paid"?new Date().toISOString().split("T")[0]:null;try{return await n.execute({sql:"UPDATE invoices SET status = ?, paid_date = ? WHERE id = ?",args:[r,i,t]}),{success:!0}}catch(o){return console.error("Failed to update invoice status:",o),{success:!1,error:"Failed to update status."}}},Ns={id:I.coerce.number(),status:I.enum(["pending","paid"])},Lt=q(p(Is,"s_Ti9m9weHHSs"),te(p(Ns,"s_CVqZ0lQFoCg"))),Cs=async({id:t},l)=>{const s=O(l);try{return await s.execute({sql:"DELETE FROM invoices WHERE id = ?",args:[t]}),{success:!0}}catch(n){return console.error("Failed to delete invoice:",n),{success:!1,error:"Failed to delete invoice."}}},Ds={id:I.coerce.number()},Rt=q(p(Cs,"s_c4Qyl0s0PVo"),te(p(Ds,"s_4ZbqH5h4Ri4"))),Ms=({track:t})=>{const[l,s,n]=C();t(()=>s.value.invoices),t(()=>n.value);const r=n.value.toLowerCase();let i=s.value.invoices;r&&(i=i.filter(o=>o.professional_name.toLowerCase().includes(r))),l.value=[...i].sort((o,d)=>{const m=o.created_date?new Date(o.created_date).getTime():0;return(d.created_date?new Date(d.created_date).getTime():0)-m})},Os=({track:t})=>{const[l,s,n]=C();t(()=>l.value.invoices),n.value=l.value.invoices.filter(r=>r.status==="pending").reduce((r,i)=>r+i.amount,0),s.value=l.value.invoices.filter(r=>r.status==="paid").reduce((r,i)=>r+i.amount,0)},Us=()=>{const[t,l,s,n,r,i,o,d,m,c]=C();l.value="",d.value=new Date().toISOString().split("T")[0],t.value="",s.value="USD",m.value="pending",i.value=null,r.value="",o.value=!1,c.value="",n.value&&(n.value.value="")},Ps=async t=>{const[l,s,n,r,i]=C(),o=t.target;if(!o.files||o.files.length===0)return;const d=o.files[0];r.value=!0,i.value="";const m=new FormData;m.append("file",d);try{const c=await fetch("/api/upload-invoice",{method:"POST",body:m});if(!c.ok){const h=await c.json();throw new Error(h.error||`HTTP error! ${c.status}`)}const x=await c.json();if(x.success)n.value=x.fileName,s.value=URL.createObjectURL(d);else throw new Error(x.error||"Upload failed")}catch(c){i.value=c.message||"An unknown error occurred during upload.",l.value&&(l.value.value="")}finally{r.value=!1}},js=()=>{var n;const[t,l,s]=C();(n=t.value)!=null&&n.success&&(s.value=!1,l())},Fs=()=>{var B,H,W,ae,ne,ie,ue;X();const t=Tt(),l=Et(),s=St(),n=Lt(),r=Rt(),i=f(!1),o=f(""),d=f(""),m=f(new Date().toISOString().split("T")[0]),c=f(""),x=f("USD"),h=f("pending"),w=f(null),y=f(""),v=f(!1),S=f(""),N=f(),U=f([]);xe(p(Ms,"s_09zgfJk3cKE",[U,l,o]));const F=f(0),$=f(0);xe(p(Os,"s_Gb41b109yVk",[l,$,F]));const P=p(Us,"s_GwAboejWJWc",[c,d,x,N,y,w,v,m,h,S]),z=p(Ps,"s_gJ13e1jvr0M",[N,y,w,v,S]),E=_=>{if(!_)return"-";const J=new Date(_),de=J.getTimezoneOffset()*6e4;return new Date(J.getTime()+de).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},T=(_,J)=>J==="KNRT"?`${_.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})} KNRT`:new Intl.NumberFormat("en-US",{style:"currency",currency:J}).format(_);return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[u(ce,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"T3_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Invoices",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Track and manage all payments",3,null)],3,null)],1,null),t.value.role==="admin"&&e("button",null,{class:"mt-4 sm:mt-0 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:g("s_Xh7yKGgpt0Y",[i])},[u(Ce,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"T3_1"),"Add Invoice"],1,"T3_2")],1,null),1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Invoices",3,null),e("p",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-200"},b(_=>_.value.invoices.length,[l],"p0.value.invoices.length"),3,null)],3,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Payment",3,null),e("p",null,{class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},T(F.value,"USD"),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Paid",3,null),e("p",null,{class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},T($.value,"USD"),1,null)],1,null)],1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},u(Ye,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"T3_3"),1,null),e("input",null,{type:"text",value:o,class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by professional...",onInput$:g("s_tpWw3z3lXmM",[o])},null,3,null)],1,null),1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Professional",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Created",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Issue Date",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Amount",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},U.value.map(_=>X(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800 dark:text-slate-100"},L(_,"professional_name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},E(_.created_date??null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},E(_.issue_date),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-800 dark:text-slate-100 font-semibold"},T(_.amount,_.currency),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${_.status==="paid"?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-amber-50 to-amber-100 text-amber-700 dark:from-amber-900/30 dark:to-amber-800/30 dark:text-amber-400"}`},null,_.status.charAt(0).toUpperCase()+_.status.slice(1),1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[_.invoice_url?e("a",{href:`/api/invoices/view/${_.invoice_url}`},{target:"_blank",rel:"noopener noreferrer",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all",title:"View Invoice"},u(Ee,{class:"h-5 w-5",[a]:{class:a}},3,"T3_4"),1,"T3_5"):e("button",null,{class:"p-1.5 text-slate-400 dark:text-slate-600 rounded-full transition-all cursor-not-allowed",disabled:!0,title:"No invoice uploaded"},u(Ee,{class:"h-5 w-5",[a]:{class:a}},3,"T3_6"),1,null),u(K,{action:n,children:[e("input",{value:L(_,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:L(_,"status")},{type:"hidden",name:"status"},null,3,null),e("button",{title:_.status==="paid"?"Mark as Pending":"Mark as Paid"},{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all"},_.status==="paid"?u(Ne,{class:"h-5 w-5",[a]:{class:a}},3,"T3_7"):u(Oe,{class:"h-5 w-5",[a]:{class:a}},3,"T3_8"),1,null)],[a]:{action:a}},1,"T3_9"),u(K,{action:r,children:[e("input",{value:L(_,"id")},{type:"hidden",name:"id"},null,3,null),e("button",null,{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Delete Invoice"},u(ve,{class:"h-5 w-5",[a]:{class:a}},3,"T3_10"),1,null)],[a]:{action:a}},1,"T3_11")],1,null),1,null)],1,_.id))),1,null)],1,null),1,null),U.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No invoices found.",3,null),3,"T3_12")],1,null)],1,null),i.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:g("s_uGSf4oJ6SJQ",[i])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},u(K,{action:s,onSubmitCompleted$:p(js,"s_EU50MZy0BNs",[s,P,i]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Add New Invoice",3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,null,[e("label",null,{for:"contractId",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Contract",3,null),e("select",null,{name:"contractId",id:"contractId",value:d,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_gV4M91Oagjs",[d])},[e("option",null,{value:""},"Select a contract",3,null),l.value.contracts.map(_=>e("option",{value:L(_,"id")},null,`${_.professional_name} (${E(_.start_date)})`,1,_.id))],1,null),((H=(B=s.value)==null?void 0:B.fieldErrors)==null?void 0:H.contractId)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.contractId[0],[s],"p0.value.fieldErrors.contractId[0]"),3,"T3_13")],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"issueDate",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Issue Date",3,null),e("input",null,{type:"date",name:"issueDate",id:"issueDate",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_ae1ZGRqvTnM",[m])},null,3,null),((ae=(W=s.value)==null?void 0:W.fieldErrors)==null?void 0:ae.issueDate)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.issueDate[0],[s],"p0.value.fieldErrors.issueDate[0]"),3,"T3_14")],1,null),e("div",null,null,[e("label",null,{for:"amount",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Amount",3,null),e("input",null,{type:"number",name:"amount",id:"amount",value:c,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_oqM2x05LSOg",[c])},null,3,null),((ie=(ne=s.value)==null?void 0:ne.fieldErrors)==null?void 0:ie.amount)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(_=>_.value.fieldErrors.amount[0],[s],"p0.value.fieldErrors.amount[0]"),3,"T3_15")],1,null)],1,null),e("div",null,{class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},[e("div",null,null,[e("label",null,{for:"currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Currency",3,null),e("select",null,{name:"currency",id:"currency",value:x,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_5or9uINNTRc",[x])},[e("option",null,null,"USD",3,null),e("option",null,null,"EUR",3,null),e("option",null,null,"KNRT",3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{for:"status",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Status",3,null),e("select",null,{name:"status",id:"status",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_6e4iQEdCYJU",[h])},[e("option",null,{value:"pending"},"Pending",3,null),e("option",null,{value:"paid"},"Paid",3,null)],3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Invoice Document (PDF/Image)",3,null),y.value?e("div",null,{class:"mt-2"},[e("div",null,{class:"relative h-64 w-full rounded-lg border border-slate-300 dark:border-slate-600 overflow-hidden group"},[y.value.startsWith("blob:http")&&e("iframe",null,{src:b(_=>_.value,[y],"p0.value"),class:"h-full w-full",title:"Invoice Preview"},null,3,"T3_16"),e("a",null,{href:b(_=>_.value,[y],"p0.value"),target:"_blank",rel:"noopener noreferrer",class:"absolute top-2 right-2 p-2 bg-slate-700/50 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Open in new tab"},u(it,{class:"h-5 w-5",[a]:{class:a}},3,"T3_17"),1,null)],1,null),e("button",null,{type:"button",class:"mt-2 inline-flex items-center text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-500 dark:hover:text-red-400",onClick$:g("s_fM3VT6rrliw",[N,y,w])},[u(pt,{class:"mr-1.5 h-4 w-4",[a]:{class:a}},3,"T3_18"),"Remove Document"],1,null)],1,"T3_19"):e("div",null,{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 dark:border-slate-600 border-dashed rounded-lg"},e("div",null,{class:"space-y-1 text-center"},[v.value?u(se,{class:"mx-auto h-12 w-12 text-slate-400 animate-spin",[a]:{class:a}},3,"T3_20"):u(ut,{class:"mx-auto h-12 w-12 text-slate-400",[a]:{class:a}},3,"T3_21"),e("div",null,{class:"flex text-sm text-slate-600 dark:text-slate-400"},[e("label",null,{for:"file-upload",class:"relative cursor-pointer bg-white dark:bg-slate-800 rounded-md font-medium text-teal-600 dark:text-teal-500 hover:text-teal-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-teal-500"},[e("span",null,null,"Upload a file",3,null),e("input",{ref:N},{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:"application/pdf,image/*",disabled:b(_=>_.value,[v],"p0.value"),onChange$:z},null,3,null)],1,null),e("p",null,{class:"pl-1"},"or drag and drop",3,null)],1,null),e("p",null,{class:"text-xs text-slate-500 dark:text-slate-500"},"PDF, PNG, JPG up to 10MB",3,null)],1,null),1,null),S.value&&e("p",null,{class:"mt-2 text-sm text-red-600 dark:text-red-500"},b(_=>_.value,[S],"p0.value"),3,"T3_22"),e("input",null,{type:"hidden",name:"invoiceUrl",value:b(_=>_.value??"",[w],'p0.value??""')},null,3,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b((_,J)=>_.isRunning||J.value,[s,v],"p0.isRunning||p1.value"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[s.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"T3_23"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"T3_24"),"Save Invoice"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_SUoZcR3RUO0",[P,i])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"T3_25"),"Cancel"],1,null)],1,null),((ue=s.value)==null?void 0:ue.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"T3_26"),b(_=>_.value.error,[s],"p0.value.error")],1,"T3_27")],[a]:{action:a,onSubmitCompleted$:a}},1,"T3_28"),1,null)],1,null),1,"T3_29")],1,"T3_30")},Bs=Q(p(Fs,"s_a5XSqTax3Rc")),$s=Object.freeze(Object.defineProperty({__proto__:null,default:Bs,useAddInvoice:St,useAuthLoader:Tt,useDeleteInvoice:Rt,useInvoicesLoader:Et,useUpdateInvoiceStatus:Lt},Symbol.toStringTag,{value:"Module"}));function Ae(t,l){const n=new Intl.NumberFormat("es-ES",{style:"currency",currency:l==="KNRT"?"EUR":l,minimumFractionDigits:2}).format(t);return l==="KNRT"?n.replace("€","KNRT"):n}const qs=async t=>{const l=O(t),s=new URL(t.request.url),n=new Date,r=parseInt(s.searchParams.get("year")||n.getFullYear().toString()),i=parseInt(s.searchParams.get("month")||(n.getMonth()+1).toString()),o=`${r}-${String(i).padStart(2,"0")}-01`,d=new Date(r,i,0),m=`${r}-${String(i).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`,h=(await l.execute({sql:`
    SELECT 
      i.id,
      p.name as professional_name,
      i.amount,
      i.currency,
      i.status,
      i.issue_date as due_date
    FROM invoices i
    JOIN professionals p ON i.professional_id = p.id
    WHERE i.issue_date >= ? AND i.issue_date <= ?
    ORDER BY i.issue_date ASC
  `,args:[o,m]})).rows.map(S=>({...S,amount:Number(S.amount)})),w=d.getDate(),y=new Date(r,i-1,1).getDay(),v=[];for(let S=0;S<y;S++)v.push({day:null,payments:[]});for(let S=1;S<=w;S++){const N=`${r}-${String(i).padStart(2,"0")}-${String(S).padStart(2,"0")}`,U=h.filter(F=>F.due_date===N);v.push({day:S,payments:U})}return{payments:h,calendarData:v,currentMonth:i,currentYear:r}},At=Y(p(qs,"s_KLgGdYv9ffA")),Ys=t=>{const[l]=C();let s=l.month,n=l.year;t==="prev"?(s--,s<1&&(s=12,n--)):(s++,s>12&&(s=1,n++));const r=new URL(window.location.href);r.searchParams.set("month",String(s)),r.searchParams.set("year",String(n)),window.location.href=r.toString()},Hs=()=>{const t=At(),l=Kt({month:t.value.currentMonth,year:t.value.currentYear}),s=t.value.payments.reduce((d,m)=>d+m.amount,0),n=t.value.payments.filter(d=>d.status==="pending").reduce((d,m)=>d+m.amount,0),r=p(Ys,"s_SydKp69OxJo",[l]),i=d=>new Date(l.year,d-1,1).toLocaleString("en-US",{month:"long"}),o=(d,m)=>{if(d===null)return"bg-slate-50 dark:bg-slate-800/50 opacity-50";const c=new Date;c.setHours(0,0,0,0);const x=new Date(l.year,l.month-1,d);let h="bg-white dark:bg-slate-800";x.getTime()<c.getTime()&&(h="bg-slate-100 dark:bg-slate-800/70"),x.getTime()===c.getTime()&&(h="bg-teal-50 dark:bg-teal-900/30 border-teal-400 dark:border-teal-600");const w=m.some(v=>v.status==="pending"),y=m.some(v=>v.status==="paid");return w?`${h} border-l-4 border-amber-400 dark:border-amber-500`:y?`${h} border-l-4 border-emerald-400 dark:border-emerald-500`:h};return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[u(at,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"Zl_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Payment Planner",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Visualize your monthly financial commitments",3,null)],3,null)],1,null),e("div",null,{class:"flex items-center space-x-2 mt-4 sm:mt-0"},[e("div",null,{class:"inline-flex items-center space-x-1.5 text-xs"},[e("span",null,{class:"w-3 h-3 inline-block bg-amber-400 rounded-full"},null,3,null),e("span",null,{class:"text-slate-600 dark:text-slate-300"},"Pending",3,null)],3,null),e("div",null,{class:"inline-flex items-center space-x-1.5 text-xs"},[e("span",null,{class:"w-3 h-3 inline-block bg-emerald-400 rounded-full"},null,3,null),e("span",null,{class:"text-slate-600 dark:text-slate-300"},"Paid",3,null)],3,null)],3,null)],1,null),1,null),e("div",null,{class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},[e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Payments This Month",3,null),e("p",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-200"},b(d=>d.value.payments.length,[t],"p0.value.payments.length"),3,null)],3,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Pending Amount",3,null),e("p",null,{class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},Ae(n,"USD"),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm p-5 border border-slate-100 dark:border-slate-700"},[e("h3",null,{class:"text-sm font-medium text-slate-500 dark:text-slate-400"},"Total Amount",3,null),e("p",null,{class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},Ae(s,"USD"),1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700"},[e("button",null,{class:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",onClick$:g("s_yEUHrZlk7e8",[r])},u(nt,{class:"h-5 w-5 text-slate-600 dark:text-slate-300",[a]:{class:a}},3,"Zl_1"),1,null),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},[i(l.month)," ",b(d=>d.year,[l],"p0.year")],1,null),e("button",null,{class:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",onClick$:g("s_9lirksKinnQ",[r])},u(rt,{class:"h-5 w-5 text-slate-600 dark:text-slate-300",[a]:{class:a}},3,"Zl_2"),1,null)],1,null),e("div",null,{class:"grid grid-cols-7"},[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(d=>e("div",null,{class:"p-2 text-center text-xs font-medium text-slate-500 dark:text-slate-400 border-b border-r border-slate-100 dark:border-slate-700"},d,1,d)),t.value.calendarData.map((d,m)=>e("div",{class:`p-2 border-b border-r border-slate-100 dark:border-slate-700 min-h-[120px] transition-colors duration-300 ${o(d.day,d.payments)}`},null,[d.day!==null&&e("div",null,{class:"text-sm font-semibold text-slate-700 dark:text-slate-200"},L(d,"day"),1,"Zl_3"),e("div",null,{class:"mt-1 space-y-1"},d.payments.map(c=>e("div",{class:`text-xs p-1.5 rounded-lg shadow-sm ${c.status==="paid"?"bg-emerald-50 text-emerald-800 dark:bg-emerald-900/50 dark:text-emerald-300":"bg-amber-50 text-amber-800 dark:bg-amber-900/50 dark:text-amber-300"}`,title:`${c.professional_name}: ${Ae(c.amount,c.currency)}`},null,[e("div",null,{class:"font-bold truncate"},L(c,"professional_name"),1,null),e("div",null,{class:"font-medium"},Ae(c.amount,c.currency),1,null)],1,c.id)),1,null)],1,m))],1,null)],1,null)],1,null),1,"Zl_4")},Gs=Q(p(Hs,"s_SibSP8O5TQA")),zs=Object.freeze(Object.defineProperty({__proto__:null,default:Gs,usePaymentPlannerLoader:At},Symbol.toStringTag,{value:"Module"})),Ws=async t=>{const l=await j(t);if(!(l!=null&&l.isAuthenticated))throw t.redirect(302,"/auth");return l},It=Y(p(Ws,"s_6l7uYMCB50c")),Vs=async t=>(await O(t).execute("SELECT id, name, role, email, phone, wallet FROM professionals ORDER BY name")).rows,Nt=Y(p(Vs,"s_9ghkRguhPB4")),Xs=async(t,l)=>{const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{return await s.execute({sql:"INSERT INTO professionals (user_id, name, role, email, phone, wallet) VALUES (?, ?, ?, ?, ?, ?)",args:[n.userId,t.name??"",t.role??"",t.email??"",t.phone??"",t.wallet??""]}),{success:!0}}catch(r){return console.error("Failed to add professional:",r),{success:!1,error:"Failed to add professional."}}},Ks={name:I.string().min(3,"Name must be at least 3 characters."),role:I.string().min(3,"Role must be at least 3 characters."),email:I.string().email("Please enter a valid email.").optional().or(I.literal("")),phone:I.string().optional(),wallet:I.string().optional()},Ct=q(p(Xs,"s_ewYr998vpGU"),te(p(Ks,"s_W0H0hD8VHsM"))),Qs=async(t,l)=>{var r,i;const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{const o=await s.execute({sql:"SELECT user_id FROM professionals WHERE id = ?",args:[t.id]});if(o.rows.length===0)return{success:!1,error:"Professional not found."};const m=(r=(await s.execute({sql:"SELECT email FROM users WHERE id = ?",args:[n.userId]})).rows[0])==null?void 0:r.email,c=o.rows[0].user_id;if(m!=="admin@gmail.com"&&c!==n.userId)return{success:!1,error:"You do not have permission to delete this professional."};const x=await s.execute({sql:"SELECT COUNT(*) as count FROM payments WHERE professional_id = ?",args:[t.id]});return Number(((i=x.rows[0])==null?void 0:i.count)||0)>0?{success:!1,error:"Cannot delete a professional with associated payments."}:(await s.execute({sql:"DELETE FROM professionals WHERE id = ?",args:[t.id]}),{success:!0})}catch(o){return console.error("Failed to delete professional:",o),{success:!1,error:"Failed to delete professional."}}},Js={id:I.coerce.number()},Dt=q(p(Qs,"s_PF9CMJpbl0s"),te(p(Js,"s_T3PAvZb0J0k"))),Zs=async(t,l)=>{var r;const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};try{const i=await s.execute({sql:"SELECT user_id FROM professionals WHERE id = ?",args:[t.id]});if(i.rows.length===0)return{success:!1,error:"Professional not found."};const d=(r=(await s.execute({sql:"SELECT email FROM users WHERE id = ?",args:[n.userId]})).rows[0])==null?void 0:r.email,m=i.rows[0].user_id;return d!=="admin@gmail.com"&&m!==n.userId?{success:!1,error:"You do not have permission to edit this professional."}:(await s.execute({sql:"UPDATE professionals SET name = ?, role = ?, email = ?, phone = ?, wallet = ? WHERE id = ?",args:[t.name??"",t.role??"",t.email??"",t.phone??"",t.wallet??"",t.id]}),{success:!0})}catch(i){return console.error("Failed to edit professional:",i),{success:!1,error:"Failed to edit professional."}}},ea={id:I.coerce.number(),name:I.string().min(3,"Name must be at least 3 characters."),role:I.string().min(3,"Role must be at least 3 characters."),email:I.string().email("Please enter a valid email.").optional().or(I.literal("")),phone:I.string().optional(),wallet:I.string().optional()},Mt=q(p(Zs,"s_dOwNrTSENvc"),te(p(ea,"s_HBjaONcPEVA"))),ta=({track:t})=>{const[l,s]=C();t(()=>s.value),l.value=s.value},la=t=>{const[l,s,n,r,i,o,d]=C();s.value=t.id,n.value=t.name,i.value=t.role,l.value=t.email||"",r.value=t.phone||"",o.value=t.wallet||"",d.value=!0},sa=()=>{const[t,l,s]=C();if(!s.value){t.value=l.value;return}const n=s.value.toLowerCase();t.value=l.value.filter(r=>r.name.toLowerCase().includes(n)||r.role.toLowerCase().includes(n))},aa=()=>{var d;const[t,l,s,n,r,i,o]=C();(d=t.value)!=null&&d.success&&(i.value=!1,s.value="",r.value="",l.value="",n.value="",o.value="")},na=()=>{var s;const[t,l]=C();(s=t.value)!=null&&s.success&&(l.value=!1)},ra=()=>{var n;const[t,l,s]=C();(n=t.value)!=null&&n.success&&(s.value=!1,l.value=null)},oa=()=>{var T,B,H,W,ae,ne,ie,ue,_,J,de;X(),It();const t=Nt(),l=Ct(),s=Mt(),n=Dt(),r=f(""),i=f(!1),o=f(!1),d=f(!1),m=f(null),c=f(""),x=f(""),h=f(""),w=f(""),y=f(""),v=f(null),S=f(""),N=f(""),U=f(""),F=f(""),$=f(""),P=f(t.value);xe(p(ta,"s_kB3Dg4UqAn0",[P,t]));const z=p(la,"s_NpfzvKQlomg",[U,v,S,F,N,$,o]),E=p(sa,"s_gzBsbP7L8is",[P,t,r]);return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[u(ge,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"3n_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Professionals",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Freelancer management",3,null)],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3"},[e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:g("s_eoeiqcBEHfA",[i])},[u(Ce,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"3n_1"),"Add Professional"],1,null),e("button",null,{class:"inline-flex items-center justify-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[u(ot,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"3n_2"),"Export"],1,null)],1,null)],1,null),1,null),e("div",null,{class:"mb-6"},e("div",null,{class:"flex flex-col sm:flex-row gap-4 bg-white dark:bg-slate-800 rounded-lg shadow-sm p-4 border border-slate-100 dark:border-slate-700"},[e("div",null,{class:"relative flex-1"},[e("div",null,{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},u(Ye,{class:"h-5 w-5 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"3n_3"),1,null),e("input",null,{type:"text",value:b(A=>A.value,[r],"p0.value"),class:"block w-full pl-10 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Search by name or role...",onInput$:g("s_pQ7saR2vT2Q",[r,E])},null,3,null)],1,null),e("div",null,{class:"flex-shrink-0"},e("button",null,{class:"inline-flex items-center px-4 py-2 border border-slate-200 dark:border-slate-600 rounded-md shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200"},[u(dt,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"3n_4"),"Filter"],1,null),1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Name",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Role",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Contact",3,null),e("th",null,{scope:"col",class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},P.value.map(A=>e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-800 dark:text-slate-100"},L(A,"name"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},L(A,"role"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},[e("div",null,null,L(A,"email"),1,null),e("div",null,null,L(A,"phone"),1,null)],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[e("button",null,{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-teal-600 hover:bg-teal-50 dark:hover:text-teal-400 dark:hover:bg-teal-900/20 rounded-full transition-all"},u(Ee,{class:"h-5 w-5",[a]:{class:a}},3,"3n_5"),1,null),e("button",{onClick$:g("s_yNzzDuBT0os",[z,A])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all"},u(Pe,{class:"h-5 w-5",[a]:{class:a}},3,"3n_6"),0,null),e("button",{onClick$:g("s_76pej4xkv8c",[A,m,d])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all"},u(ve,{class:"h-5 w-5",[a]:{class:a}},3,"3n_7"),0,null)],1,null),1,null)],1,A.id)),1,null)],1,null),1,null),P.value.length===0&&e("div",null,{class:"px-6 py-12 text-center"},[e("div",null,{class:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700/50 mb-4"},u(ge,{class:"w-8 h-8 text-slate-400 dark:text-slate-500",[a]:{class:a}},3,"3n_8"),1,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 font-medium"},"No professionals found.",3,null),e("p",null,{class:"text-slate-400 dark:text-slate-500 mt-1 text-sm"},"Add a new professional to get started.",3,null)],1,"3n_9")],1,null),e("div",null,{class:"flex items-center justify-between mt-6 bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border border-slate-100 dark:border-slate-700"},e("div",null,{class:"text-sm text-slate-600 dark:text-slate-400"},["Showing ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(A=>A.value.length,[P],"p0.value.length"),3,null)," of ",e("span",null,{class:"font-medium text-teal-600 dark:text-teal-500"},b(A=>A.value.length,[t],"p0.value.length"),3,null)," professionals"],3,null),3,null)],1,null),i.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:g("s_TmJ39fMCzuM",[i])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},u(K,{action:l,onSubmitCompleted$:p(aa,"s_9kOa6fjVAlU",[l,h,c,w,x,i,y]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},e("div",null,{class:"sm:flex sm:items-start"},e("div",null,{class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100",id:"modal-title"},"Add New Professional",3,null),e("div",null,{class:"mt-4"},e("div",null,{class:"space-y-4"},[e("div",null,null,[e("label",null,{for:"name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Full Name",3,null),e("input",null,{type:"text",name:"name",id:"name",value:c,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",required:!0,onInput$:g("s_GVdHcpX68tA",[c])},null,3,null),((B=(T=l.value)==null?void 0:T.fieldErrors)==null?void 0:B.name)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(A=>A.value.fieldErrors.name,[l],"p0.value.fieldErrors.name"),3,"3n_10")],1,null),e("div",null,null,[e("label",null,{for:"role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("input",null,{type:"text",name:"role",id:"role",value:x,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",placeholder:"e.g., Frontend Developer",required:!0,onInput$:g("s_jAxO9x2uMs4",[x])},null,3,null),((W=(H=l.value)==null?void 0:H.fieldErrors)==null?void 0:W.role)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(A=>A.value.fieldErrors.role,[l],"p0.value.fieldErrors.role"),3,"3n_11")],1,null),e("div",null,null,[e("div",null,null,[e("label",null,{for:"wallet",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet (optional)",3,null),e("input",null,{type:"text",name:"wallet",id:"wallet",value:y,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",placeholder:"Wallet address or ID",onInput$:g("s_lbSNTM5SAhM",[y])},null,3,null),((ne=(ae=l.value)==null?void 0:ae.fieldErrors)==null?void 0:ne.wallet)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(A=>A.value.fieldErrors.wallet,[l],"p0.value.fieldErrors.wallet"),3,"3n_12")],1,null),e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"email",value:h,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_DyU1DEK6eOo",[h])},null,3,null),((ue=(ie=l.value)==null?void 0:ie.fieldErrors)==null?void 0:ue.email)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(A=>A.value.fieldErrors.email,[l],"p0.value.fieldErrors.email"),3,"3n_13")],1,null),e("div",null,null,[e("label",null,{for:"phone",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Phone",3,null),e("input",null,{type:"tel",name:"phone",id:"phone",value:w,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all",onInput$:g("s_NWWIOlSD3Rw",[w])},null,3,null)],3,null)],1,null),1,null)],1,null),1,null),1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(A=>A.isRunning,[l],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[l.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"3n_14"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_15"),"Save Professional"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_NLbcS0Hh0oA",[i])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_16"),"Cancel"],1,null)],1,null),((_=l.value)==null?void 0:_.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"3n_17"),b(A=>A.value.error,[l],"p0.value.error")],1,"3n_18")],[a]:{action:a,onSubmitCompleted$:a}},1,"3n_19"),1,null)],1,null),1,"3n_20"),o.value&&e("div",null,{class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},[e("div",null,{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick$:g("s_Fw4HsovHP9U",[o])},null,3,null),e("div",null,{class:"relative bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 sm:mx-auto z-10 overflow-hidden"},[e("div",null,{class:"bg-gradient-to-r from-blue-500 to-blue-600 py-6 px-6"},[e("h3",null,{class:"text-xl font-semibold text-white flex items-center"},[u(Pe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_21"),"Edit Professional"],1,null),e("p",null,{class:"text-blue-100 text-sm mt-1"},"Update the professional's information",3,null)],1,null),u(K,{action:s,onSubmitCompleted$:p(na,"s_mMfvy2XJjqs",[s,o]),children:[e("div",null,{class:"p-6"},e("div",null,{class:"space-y-6"},[e("input",null,{type:"hidden",name:"id",value:b(A=>A.value,[v],"p0.value")},null,3,null),e("div",null,null,[e("label",null,{for:"edit-name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Name",3,null),e("input",null,{type:"text",name:"name",id:"edit-name",value:S,required:!0,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:g("s_0ZBxof0L4gU",[S])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("input",null,{type:"text",name:"role",id:"edit-role",value:N,required:!0,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:g("s_6W3vXIVkP74",[N])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-wallet",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Wallet Address",3,null),e("input",null,{type:"text",name:"wallet",id:"edit-wallet",value:$,placeholder:"0x...",class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all font-mono",onInput$:g("s_ZAfnG9J9o7g",[$])},null,3,null)],3,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"edit-email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"edit-email",value:U,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:g("s_kNAqpYnviD8",[U])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"edit-phone",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Phone",3,null),e("input",null,{type:"tel",name:"phone",id:"edit-phone",value:F,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition-all",onInput$:g("s_0RnaKJYNBv8",[F])},null,3,null)],3,null)],3,null)],3,null),3,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(A=>A.isRunning,[s],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-base font-medium text-white hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[s.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"3n_22"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_23"),"Update Professional"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_274GbrB0tgE",[o])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_24"),"Cancel"],1,null)],1,null),((J=s.value)==null?void 0:J.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"3n_25"),b(A=>A.value.error,[s],"p0.value.error")],1,"3n_26")],[a]:{action:a,onSubmitCompleted$:a}},1,"3n_27")],1,null)],1,"3n_28"),d.value&&e("div",null,{class:"fixed inset-0 overflow-y-auto z-50 flex items-center justify-center"},[e("div",null,{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick$:g("s_0ceVdQIKjhg",[d])},null,3,null),e("div",null,{class:"relative bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md mx-4 sm:mx-auto z-10 overflow-hidden"},[e("div",null,{class:"bg-gradient-to-r from-red-500 to-red-600 py-6 px-6"},[e("h3",null,{class:"text-xl font-semibold text-white flex items-center"},[u(ve,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_29"),"Confirm Deletion"],1,null),e("p",null,{class:"text-red-100 text-sm mt-1"},"This action cannot be undone",3,null)],1,null),u(K,{action:n,onSubmitCompleted$:p(ra,"s_eem45vjZWkA",[n,m,d]),children:[e("div",null,{class:"p-6"},[e("input",null,{type:"hidden",name:"id",value:b(A=>A.value,[m],"p0.value")},null,3,null),e("div",null,{class:"text-center mb-6"},[e("div",null,{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30"},u(ve,{class:"h-6 w-6 text-red-600 dark:text-red-500",[a]:{class:a}},3,"3n_30"),1,null),e("h3",null,{class:"mt-3 text-lg font-medium text-slate-900 dark:text-slate-100"},"Delete Professional",3,null),e("p",null,{class:"mt-2 text-sm text-slate-500 dark:text-slate-400"},"Are you sure you want to delete this professional? This action cannot be undone.",3,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(A=>A.isRunning,[n],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-red-500 to-red-600 text-base font-medium text-white hover:from-red-600 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[n.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"3n_31"):u(ve,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_32"),"Delete"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_duhryAVQI0Q",[d])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3n_33"),"Cancel"],1,null)],1,null),((de=n.value)==null?void 0:de.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"3n_34"),b(A=>A.value.error,[n],"p0.value.error")],1,"3n_35")],[a]:{action:a,onSubmitCompleted$:a}},1,"3n_36")],1,null)],1,"3n_37")],1,"3n_38")},ia=Q(p(oa,"s_ihBQ0teuNC8")),ua=Object.freeze(Object.defineProperty({__proto__:null,default:ia,useAddProfessional:Ct,useAuthLoader:It,useDeleteProfessional:Dt,useEditProfessional:Mt,useProfessionalsLoader:Nt},Symbol.toStringTag,{value:"Module"})),da=async t=>{const l=await j(t);if(!(l!=null&&l.isAuthenticated)||!he(l))throw t.redirect(302,"/auth");return l},Ot=Y(p(da,"s_HEMMVDaKQS8")),ca=async t=>{const l=await j(t);if(!he(l))throw t.fail(401,{error:"Unauthorized"});const r=(await O(t).execute("SELECT * FROM app_settings WHERE id = 1")).rows[0];return{...r,notifications_enabled:!!r.notifications_enabled}},Ut=Y(p(ca,"s_OCPwWYs74WM")),ma=async(t,l)=>{const s=await j(l);if(!(s!=null&&s.is_admin))return{success:!1,error:"Unauthorized"};const n=O(l);try{return await n.execute({sql:`
          UPDATE app_settings SET 
            company_name = ?, company_email = ?, company_logo_url = ?, 
            invoice_prefix = ?, default_currency = ?, payment_methods = ?, 
            notifications_enabled = ?, theme = ?, updated_at = CURRENT_TIMESTAMP
          WHERE id = 1
        `,args:[t.company_name,t.company_email,t.company_logo_url||null,t.invoice_prefix,t.default_currency,JSON.stringify(t.payment_methods),t.notifications_enabled?1:0,t.theme]}),{success:!0}}catch(r){return console.error(r),{success:!1,error:"Failed to update settings."}}},pa={company_name:I.string().min(1),company_email:I.string().email(),company_logo_url:I.string().url().optional().or(I.literal("")),invoice_prefix:I.string().max(10),default_currency:I.string(),payment_methods:I.array(I.string()),notifications_enabled:I.boolean(),theme:I.enum(["light","dark","system"])},Pt=q(p(ma,"s_XJ5eJM6wJS4"),te(p(pa,"s_qOz9xR07XuY"))),fa=()=>{var y;X(),Ot();const t=Ut(),l=Pt(),s=f(t.value.company_name),n=f(t.value.company_email),r=f(t.value.company_logo_url||""),i=f(t.value.invoice_prefix),o=f(t.value.default_currency),d=f(JSON.parse(t.value.payment_methods||"[]")),m=f(!!t.value.notifications_enabled),c=f(t.value.theme),x=[{value:"bank_transfer",label:"Bank Transfer"},{value:"paypal",label:"PayPal"},{value:"wise",label:"Wise"},{value:"crypto",label:"Crypto"}],h=[{value:"USD",label:"USD - US Dollar"},{value:"EUR",label:"EUR - Euro"}],w=[{value:"light",label:"Light"},{value:"dark",label:"Dark"},{value:"system",label:"System"}];return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},e("div",null,{class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex items-center"},[u(mt,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"cI_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"Application Settings",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage global application settings",3,null)],3,null)],1,null),1,null),u(K,{action:l,class:"space-y-8",children:[e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[u(ol,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"cI_1"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Company Information",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("label",null,{for:"company_name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Company Name",3,null),e("input",null,{type:"text",name:"company_name",id:"company_name",value:s,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_ytQl2RUxF1g",[s])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"company_email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Company Email",3,null),e("input",null,{type:"email",name:"company_email",id:"company_email",value:n,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_4BpnU5fjv4o",[n])},null,3,null)],3,null),e("div",null,{class:"md:col-span-2"},[e("label",null,{for:"company_logo_url",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Logo URL",3,null),e("input",null,{type:"url",name:"company_logo_url",id:"company_logo_url",value:r,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_ENb9DsgOlVs",[r])},null,3,null)],3,null)],3,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[u(ce,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"cI_2"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Invoice Settings",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",null,null,[e("label",null,{for:"invoice_prefix",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Invoice Prefix",3,null),e("input",null,{type:"text",name:"invoice_prefix",id:"invoice_prefix",value:i,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_ca07GSOeg1o",[i])},null,3,null)],3,null),e("div",null,null,[e("label",null,{for:"default_currency",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Default Currency",3,null),e("select",null,{name:"default_currency",id:"default_currency",value:o,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_lLUvYLnkacs",[o])},h.map(v=>e("option",{value:L(v,"value")},null,v.label,1,v.value)),1,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[u(il,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"cI_3"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Payment Methods",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-2 md:grid-cols-4 gap-4"},x.map(v=>e("div",null,{class:"flex items-center"},[e("input",{id:`payment-${v.value}`,value:L(v,"value"),checked:d.value.includes(v.value),onChange$:g("s_9IYanuJ7Uic",[v,d])},{type:"checkbox",name:"payment_methods",class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-slate-300 dark:border-slate-600 rounded"},null,2,null),e("label",{for:`payment-${v.value}`},{class:"ml-2 text-sm text-slate-700 dark:text-slate-300"},L(v,"label"),1,null)],1,v.value)),1,null)],1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl border border-slate-200 dark:border-slate-700"},[e("div",null,{class:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center"},[u(pl,{class:"h-6 w-6 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"cI_4"),e("h2",null,{class:"text-lg font-semibold text-slate-800 dark:text-slate-100"},"Appearance & Notifications",3,null)],1,null),e("div",null,{class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6 items-center"},[e("div",null,null,[e("label",null,{for:"theme",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Theme",3,null),e("select",null,{name:"theme",id:"theme",value:c,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500",onInput$:g("s_6hiRG0tcDe4",[c])},w.map(v=>e("option",{value:L(v,"value")},null,v.label,1,v.value)),1,null)],1,null),e("div",null,{class:"flex items-center pt-6"},[e("input",null,{type:"checkbox",id:"notifications_enabled",name:"notifications_enabled",checked:m,class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-slate-300 dark:border-slate-600 rounded",onInput$:g("s_8iPCJdppKeA",[m])},null,3,null),e("label",null,{for:"notifications_enabled",class:"ml-2 text-sm font-medium text-slate-700 dark:text-slate-300"},"Enable Notifications",3,null)],3,null)],1,null)],1,null),e("div",null,{class:"flex justify-end items-center pt-4"},[((y=l.value)==null?void 0:y.success)===!1&&e("div",null,{class:"text-red-600 dark:text-red-400 mr-4 flex items-center"},[u(ee,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"cI_5"),b(v=>v.value.error,[l],"p0.value.error")],1,"cI_6"),e("button",null,{type:"submit",disabled:b(v=>v.isRunning,[l],"p0.isRunning"),class:"inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200 disabled:opacity-50"},[l.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"cI_7"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"cI_8"),"Save Settings"],1,null)],1,null)],[a]:{action:a,class:a}},1,"cI_9")],1,null),1,"cI_10")},xa=Q(p(fa,"s_pkX8xUp3FVg")),ga=Object.freeze(Object.defineProperty({__proto__:null,default:xa,useAuthLoader:Ot,useSettingsLoader:Ut,useUpdateSettings:Pt},Symbol.toStringTag,{value:"Module"})),ha=[{inputs:[{internalType:"address",name:"_registry",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{inputs:[],name:"ReentrancyGuardReentrantCall",type:"error"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"SafeERC20FailedOperation",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lockId",type:"uint256"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"releaseTime",type:"uint256"},{indexed:!1,internalType:"address[]",name:"recipients",type:"address[]"},{indexed:!1,internalType:"uint256[]",name:"amounts",type:"uint256[]"},{indexed:!1,internalType:"uint256",name:"invoiceId",type:"uint256"}],name:"LockCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"lockId",type:"uint256"}],name:"LockReleased",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"cancelUpkeepAndWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"checkUpkeep",outputs:[{internalType:"bool",name:"upkeepNeeded",type:"bool"},{internalType:"bytes",name:"performData",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"totalAmount",type:"uint256"},{internalType:"address[]",name:"recipients",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"uint256",name:"releaseTime",type:"uint256"},{internalType:"uint256",name:"invoiceId",type:"uint256"}],name:"createLock",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"emergencyWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"forwarder",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllLocks",outputs:[{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"address[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"uint256[]",name:"releaseTimes",type:"uint256[]"},{internalType:"bool[]",name:"released",type:"bool[]"},{internalType:"address[][]",name:"recipients",type:"address[][]"},{internalType:"uint256[][]",name:"recipientAmounts",type:"uint256[][]"},{internalType:"uint256[]",name:"invoiceIds",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"}],name:"getLocksByRecipient",outputs:[{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"address[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"amounts",type:"uint256[]"},{internalType:"uint256[]",name:"releaseTimes",type:"uint256[]"},{internalType:"bool[]",name:"released",type:"bool[]"},{internalType:"address[][]",name:"recipientsArr",type:"address[][]"},{internalType:"uint256[][]",name:"recipientAmounts",type:"uint256[][]"},{internalType:"uint256[]",name:"invoiceIds",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"locks",outputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"releaseTime",type:"uint256"},{internalType:"bool",name:"released",type:"bool"},{internalType:"uint256",name:"invoiceId",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextLockId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"performUpkeep",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"registry",outputs:[{internalType:"contract AutomationRegistryInterface",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_forwarder",type:"address"}],name:"setForwarderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"setUpkeepId",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"upkeepId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"}],name:"withdrawAllLink",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"linkToken",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdrawLink",outputs:[],stateMutability:"nonpayable",type:"function"}],ba=async()=>{const[t,l,s]=C();return l.value="MetaMask solo se puede usar en el navegador.",!1},va=async(t,l,s,n,r,i)=>{const[o,d,m,c,x]=C();c.value="Esta acción solo se puede realizar en el navegador."},wa=async()=>{const[t,l,s,n]=C();s.value=!0,l.value="",console.log("[TimeLock] Iniciando carga de locks..."),window.dbLocks&&console.log("[TimeLock] dbLocks:",window.dbLocks);try{const r=Zt({chain:We,transport:el(We.rpcUrls.default.http[0])});console.log("[TimeLock] Llamando a getAllLocks en el contrato:",t);const i=await r.readContract({address:t,abi:ha,functionName:"getAllLocks"});if(console.log("[TimeLock] Resultado de getAllLocks:",i),!i||!Array.isArray(i)||i.length<8){l.value="El contrato no devolvió el formato esperado de locks.",console.error("[TimeLock] Formato inesperado:",i),n.value=[],s.value=!1;return}const[o,d,m,c,x,h,w,y]=i,v=(o||[]).map((S,N)=>({id:S,token:d[N],totalAmount:m[N],releaseTime:c[N],released:x[N],recipients:h[N],amounts:w[N],invoiceId:y[N]}));n.value=v,console.log("[TimeLock] Locks parseados:",v)}catch(r){l.value=r.message||"Error al leer locks",console.error("[TimeLock] Error al leer locks:",r)}s.value=!1},ka=async()=>{const[t,l,s,n,r]=C();s.value="Esta acción solo se puede realizar en el navegador."};function ya(){const t=f(null),l=f(""),s=f(""),n=f([]),r=f(!1),i=p(ba,"s_81MCpzm7a6o",[t,s,l]),o="0x3FaD005Daf5DBc6Bb2E7645932557EBC1776Ef3e",d=p(va,"s_Nk78oOdFUOs",[o,t,i,s,l]),m=p(wa,"s_nugdMjWhp0M",[o,s,r,n]);return{address:t,status:l,error:s,locks:n,loadingLocks:r,connect:i,createLock:d,loadLocks:m,performUpkeep:p(ka,"s_03RWAw0emAM",[o,t,s,m,l])}}const _a=async t=>{var y;await Cl(t);const l=O(t);if(!(await j(t)).isAuthenticated)throw t.fail(401,{error:"Unauthorized"});const n=new URL(t.request.url),r=Number(n.searchParams.get("locksPage")||1),i=Number(n.searchParams.get("locksPerPage")||10),o=(r-1)*i,d=`
    SELECT t.id, t.payment_id, t.invoice_id as facturaId, t.release_timestamp, t.status,
           i.invoice_url, i.amount, i.currency, i.status as invoice_status,
           prof.name, prof.email, prof.wallet,
           c.contract_url, c.id as contract_id
    FROM timelocks t
    LEFT JOIN invoices i ON t.invoice_id = i.id
    LEFT JOIN professionals prof ON i.professional_id = prof.id
    LEFT JOIN contracts c ON i.contract_id = c.id
    ORDER BY t.id DESC
    LIMIT ? OFFSET ?`,m=[i,o],c=await l.execute({sql:d,args:m}),h=((y=(await l.execute("SELECT COUNT(*) as total FROM payments")).rows[0])==null?void 0:y.total)||0,w=await l.execute("SELECT id, name, email, wallet FROM professionals ORDER BY name");return{locks:c.rows,total:h,page:r,limit:i,professionals:w.rows}},jt=Y(p(_a,"s_vJidTSJ0IPw"));function Ft(t){switch(t){case"USDC":return"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48";case"USDT":return"0xdAC17F958D2ee523a2206206994597C13D831ec7";case"DAI":return"0x6B175474E89094C44Da98b954EedeAC495271d0F";case"KNRT":{const l="0xa210Fff1cfD0ffBdF4A623682dB2102bef8473D2".replace(/"/g,"");return l&&l.startsWith("0x")?l:void 0}default:return}}const Ta=async t=>{const l=await j(t);if(!(l!=null&&l.isAuthenticated))throw t.redirect(302,"/auth");return l},Ea=Y(p(Ta,"s_D9LiNjAXUhY")),Sa=async t=>{console.log("[planner-auto] loader: requestEvent",{url:t.request.url});const l=await j(t);if(!l.isAuthenticated)throw t.fail(401,{error:"Unauthorized"});const s=O(t),n=new URL(t.request.url),r=n.searchParams.get("month")||(new Date().getMonth()+1).toString(),i=n.searchParams.get("year")||new Date().getFullYear().toString(),o=`${i}-${String(r).padStart(2,"0")}-01`,m=new Date(Number(i),Number(r),0).getDate(),c=`${i}-${String(r).padStart(2,"0")}-${String(m).padStart(2,"0")}`;let x=`
      SELECT p.id, p.professional_id, prof.name as professional_name, prof.wallet as professional_wallet,
             p.amount, p.currency, p.status, p.due_date, p.description, p.contract_id, c.id as contract_id, c.start_date, c.end_date, c.status as contract_status, c.contract_url
      FROM payments p
      JOIN professionals prof ON p.professional_id = prof.id
      LEFT JOIN contracts c ON p.contract_id = c.id
      WHERE p.due_date BETWEEN ? AND ?`;const h=[o,c];he(l)||(x+=" AND prof.email = ?",h.push(l.email)),x+=`
      ORDER BY p.due_date ASC`;const w=await s.execute({sql:x,args:h}),y=await s.execute("SELECT id, name, wallet FROM professionals ORDER BY name"),v=await s.execute(`
    SELECT c.id, c.professional_id, c.start_date, c.end_date, c.status, c.contract_url
    FROM contracts c
    WHERE c.status = 'active'
    ORDER BY c.start_date DESC
  `),S={payments:w.rows.map(N=>({...N,amount:Number(N.amount)})),professionals:y.rows,contracts:v.rows,currentMonth:Number(r),currentYear:Number(i)};return console.log("[planner-auto] loader result",JSON.stringify(S,null,2)),S},Bt=Y(p(Sa,"s_ciAoTd0tSN0")),La=async t=>{const l=O(t),s=await j(t);if(!s.isAuthenticated)throw t.fail(401,{error:"Unauthorized"});const r=(await l.execute("SELECT id, name, role, email, wallet FROM professionals ORDER BY name")).rows,o=(await l.execute(`
    SELECT c.id, c.professional_id, p.name as professional_name, c.start_date, c.end_date, c.status, c.contract_url
    FROM contracts c
    JOIN professionals p ON c.professional_id = p.id
    WHERE c.status = 'active'
    ORDER BY p.name, c.start_date DESC
  `)).rows;let d;he(s)?d=await l.execute(`
      SELECT i.id, i.professional_id, p.name as professional_name, i.contract_id, i.amount, i.currency, i.status, i.issue_date, i.paid_date, i.invoice_url, i.created_date 
      FROM invoices i
      JOIN professionals p ON i.professional_id = p.id
      ORDER BY i.created_date DESC
    `):d=await l.execute({sql:`SELECT i.id, i.professional_id, p.name as professional_name, i.contract_id, i.amount, i.currency, i.status, i.issue_date, i.paid_date, i.invoice_url, i.created_date 
            FROM invoices i
            JOIN professionals p ON i.professional_id = p.id
            WHERE p.email = ?
            ORDER BY i.created_date DESC`,args:[s.email]});const m=d.rows.map(c=>({...c,amount:Number(c.amount)}));return{professionals:r,contracts:o,invoices:m,session:s}},$t=Y(p(La,"s_YeuiPGf0MkM")),Ra=async(t,l)=>{const s=O(l),n=await j(l);if(!n.isAuthenticated||!n.userId)return{success:!1,error:"Authentication required."};const r=await s.execute({sql:"SELECT * FROM invoices WHERE id = ?",args:[t.invoiceId]});if(!r.rows.length)return{success:!1,error:"Invoice not found."};const i=r.rows[0];try{return await s.execute({sql:"UPDATE invoices SET status = ? WHERE id = ?",args:["paid",t.invoiceId]}),await s.execute({sql:"INSERT INTO settlements (professional_id, user_id, month, year, total_amount, currency, status, payment_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?)",args:[i.professional_id,n.userId,new Date(i.issue_date).getMonth()+1,new Date(i.issue_date).getFullYear(),i.amount,i.currency,"paid",new Date().toISOString().split("T")[0]]}),Date.now(),await s.execute({sql:"INSERT INTO timelocks (payment_id, invoice_id, release_timestamp, status) VALUES (?, ?, ?, ?)",args:[t.invoiceId,t.invoiceId,t.releaseTimestamp??Math.floor(Date.now()/1e3)+86400,"pending"]}),{success:!0}}catch{return{success:!1,error:"Failed to automate payment."}}},Aa=t=>t.object({invoiceId:t.coerce.number().int().positive(),releaseTimestamp:t.coerce.number().int().positive().optional()}),qt=q(p(Ra,"s_BtIs65RC1kg"),te(p(Aa,"s_LgRY0xLp03w"))),Ia=async(t,l)=>{const s=await j(l);if(!s.isAuthenticated||!s.userId)return{success:!1,error:"Authentication required"};const n=O(l);try{return await n.execute({sql:"INSERT INTO settlements (professional_id, user_id, month, year, total_amount, currency, status) VALUES (?, ?, ?, ?, ?, ?, ?)",args:[t.professionalId,s.userId,t.month,t.year,t.totalAmount,t.currency,"pending"]}),{success:!0}}catch(r){return console.error(r),{success:!1,error:"Failed to create settlement."}}},Na=t=>t.object({professionalId:t.coerce.number(),month:t.coerce.number().min(1).max(12),year:t.coerce.number().min(2e3).max(2100),totalAmount:t.coerce.number().positive(),currency:t.string().min(3)}),Ca=q(p(Ia,"s_igFdqUmxqns"),te(p(Na,"s_QEe4M0HM2F8"))),Da=async({id:t,status:l},s)=>{const n=O(s),r=l==="paid"?"pending":"paid",i=r==="paid"?new Date().toISOString().split("T")[0]:null;try{return await n.execute({sql:"UPDATE settlements SET status = ?, payment_date = ? WHERE id = ?",args:[String(r),i?String(i):null,String(t)]}),{success:!0}}catch{return{success:!1,error:"Failed to update status."}}},Ma=q(p(Da,"s_9x1ijvU6PpI")),Oa=async({id:t},l)=>{const s=O(l);try{return await s.execute({sql:"DELETE FROM settlements WHERE id = ?",args:[String(t)]}),{success:!0}}catch{return{success:!1,error:"Failed to delete settlement."}}},Ua=q(p(Oa,"s_aH8dasVygFA")),Yt=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],Ht=()=>{const t=new Date().getFullYear(),l=[];for(let s=t-3;s<=t+1;s++)l.push({value:s.toString(),label:s.toString()});return l},Pa=async()=>{const[t,l,s]=C(),n=l.value;t.value=n.locks,s.value=Number(n.total)},ja=async()=>{var E,T;const[t,l,s,n,r,i,o,d,m,c,x,h]=C(),w=Ft(x.value);if(!w){r.error.value="Unsupported token.";return}if(!h.value){r.error.value="Professional's wallet is required.";return}if(l.value)return;const y=c.value,v=o.value,S=parseInt(d.value,10),N=parseInt(m.value,10),[U,F,$]=v.split("-").map(Number),P=Jt.fromObject({year:U,month:F,day:$,hour:S,minute:N},{zone:y||"UTC"}),z=Math.floor(P.toSeconds());if(n.value==null){r.error.value="No se ha seleccionado una factura válida.";return}if(await r.createLock(w,i.value.toString(),h.value,i.value.toString(),z.toString(),n.value),n.value){const B=await t.submit({invoiceId:n.value,releaseTimestamp:z});if((E=B.value)!=null&&E.success){r.status.value="Timelock creado y factura automatizada.";const H=s.value.invoices.findIndex(W=>W.id===n.value);H!==-1&&(s.value.invoices[H].status="paid"),closeAutomateModal()}else r.error.value=((T=B.value)==null?void 0:T.error)||"Error al automatizar la factura."}},Fa=({track:t})=>{const[l,s,n,r,i,o,d]=C(),m=t(()=>d.value.trim().toLowerCase()),c=t(()=>s.value),x=t(()=>r.value),h=t(()=>l.value),w=t(()=>n.value);i.value=o.value.professionals.filter(y=>{let v=!0;m&&(v=y.name.toLowerCase().includes(m)||(y.email??"").toLowerCase().includes(m));const S=o.value.invoices.filter(P=>P.professional_id===y.id);if(S.length===0&&(c||x||h||w))return!1;const N=!c||S.some(P=>String(new Date(P.issue_date).getUTCMonth()+1)===c),U=!x||S.some(P=>String(new Date(P.issue_date).getUTCFullYear())===x),F=!h||S.some(P=>P.currency===h),$=!w||S.some(P=>P.status===w);return v&&N&&U&&F&&$})},Ba=t=>{const[l,s,n,r,i,o,d,m,c,x]=C();n.value=t;const h=l.value.invoices.find(y=>y.id===t);if(!h)return;const w=l.value.professionals.find(y=>y.id===h.professional_id);c.value=h.currency||"USDC",x.value=(w==null?void 0:w.wallet)||"",i.value=h.amount||0,o.value=new Date(Date.now()+864e5).toISOString().split("T")[0],d.value="10",m.value="0",s.value=String(h.contract_id??""),r.value=!0},$a=()=>{const[t,l,s,n]=C();s.value=!1,l.value=null,n.error.value="",n.status.value="",t.value=""},qa=({track:t})=>{const[l,s]=C(),n=t(()=>s.status.value);n&&n.includes("Lock creado correctamente")&&(l(),typeof window<"u"&&window.location.reload())},Ya=()=>{X();const t=f(!0),l=f([]),s=f(1),n=f(0),r=jt();_e(g("s_e46ZeN7c0po",[p(Pa,"s_DU0gmHOYIVM",[l,r,n]),s,t]));const o=$t(),d=qt(),m=f(""),c=f(!1),x=f(null),h=f(""),w=ya(),y=f("USDC"),v=f(Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC"),S=f(""),N=f(0),U=f(new Date(Date.now()+864e5).toISOString().split("T")[0]),F=f("10"),$=f("0"),P=f(""),z=f(new Date),E=f(new Date),T=f(new Date);_e(g("s_BclXGPWLo4M",[h,z,E,T,c,U,F,$,v]));const B=p(ja,"s_QJi0lpNmFpU",[d,h,o,x,w,N,U,F,$,v,y,S]),H=f(String(new Date().getMonth()+1)),W=f(String(new Date().getFullYear())),ae=f(""),ne=f(""),ie=f(o.value.professionals);xe(p(Fa,"s_sozVq3kqzM4",[ae,H,ne,W,ie,o,m]));const ue=k=>o.value.contracts.filter(D=>D.professional_id===k),_=k=>o.value.invoices.filter(D=>D.professional_id===k),J=p(Ba,"s_006zcKdtEVo",[o,P,x,c,N,U,F,$,y,S]),de=p($a,"s_BhwBmIFt2cA",[h,x,c,w]);xe(p(qa,"s_IVinuTb0nCs",[de,w]));const A=k=>{const D=new Date(Number(k)*1e3);return D.toLocaleDateString()+" "+D.toLocaleTimeString()};Bt();const Le=f(!1);return f(null),_e(g("s_AhJYVb2Md5Q",[Le,w])),e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},[e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},[e("h1",null,{class:"text-2xl font-bold text-slate-800 dark:text-slate-100"},"Settlements Dashboard",3,null),e("div",null,{class:"flex flex-col sm:flex-row items-center gap-3"},e("button",null,{class:"inline-flex items-center px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-medium text-sm shadow-md hover:from-indigo-600 hover:to-purple-600 transition-all",onClick$:g("s_yR9FJvWweUY",[Le,w])},w.address.value?u(Ge,{children:[u(Xe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3q_0")," ",b(k=>k.value?"Ocultar Timelocks":"Ver Timelocks",[Le],'p0.value?"Ocultar Timelocks":"Ver Timelocks"')]},1,"3q_1"):u(Ge,{children:[u(wl,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"3q_2")," Conectar Wallet"]},1,"3q_3"),1,null),1,null)],1,null),e("div",null,{class:"mt-4 flex flex-wrap gap-3"},[e("input",null,{type:"text",value:m,class:"block w-full sm:w-64 pl-3 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 placeholder-slate-400 shadow-sm hover:border-teal-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm transition-all duration-200",placeholder:"Buscar profesional...",onInput$:g("s_vJmrtKGFO3c",[m])},null,3,null),e("select",null,{value:H,class:"block w-full sm:w-auto pl-2 pr-8 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200",onInput$:g("s_a0YfR8J25OE",[H])},[e("option",null,{value:""},"Mes",3,null),Yt.map(k=>e("option",{value:L(k,"value")},null,k.label,1,k.value))],1,null),e("select",null,{value:W,class:"block w-full sm:w-auto pl-2 pr-8 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200",onInput$:g("s_mna5SON6m2o",[W])},[e("option",null,{value:""},"Año",3,null),Ht().map(k=>e("option",{value:L(k,"value")},null,k.label,1,k.value))],1,null),e("select",null,{value:ae,class:"block w-full sm:w-auto pl-2 pr-8 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200",onInput$:g("s_VaHxRamqf68",[ae])},[e("option",null,{value:""},"Moneda",3,null),e("option",null,{value:"USDC"},"USDC",3,null),e("option",null,{value:"USDT"},"USDT",3,null),e("option",null,{value:"DAI"},"DAI",3,null),e("option",null,{value:"KNRT"},"KNRT",3,null)],3,null),e("select",null,{value:ne,class:"block w-full sm:w-auto pl-2 pr-8 py-2 border border-slate-200 dark:border-slate-600 rounded-md bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200",onInput$:g("s_Ek68hxw2Bqk",[ne])},[e("option",null,{value:""},"Estado",3,null),e("option",null,{value:"pending"},"Pendiente",3,null),e("option",null,{value:"paid"},"Pagado",3,null)],3,null)],1,null)],1,null),w.address.value&&Le.value&&e("div",null,{class:"mb-8 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/30 dark:to-purple-900/30 rounded-xl shadow-md p-6 border border-indigo-100 dark:border-indigo-800/50"},[e("div",null,{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4"},[e("div",null,null,[e("div",null,{class:"flex items-center"},[u(Ue,{class:"h-6 w-6 text-indigo-600 dark:text-indigo-400 mr-2",[a]:{class:a}},3,"3q_4"),e("h2",null,{class:"text-xl font-bold text-slate-800 dark:text-slate-200"},"TimeLock Smart Contract",3,null)],1,null),e("p",null,{class:"text-sm text-slate-600 dark:text-slate-400 mt-1"},["Wallet: ",b(k=>k.address.value,[w],"p0.address.value")],3,null)],1,null),e("div",null,{class:"mt-4 sm:mt-0 space-x-2"},[e("button",{onClick$:w.loadLocks},{class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-indigo-100 hover:bg-indigo-200 dark:bg-indigo-900/50 dark:hover:bg-indigo-800/70 text-indigo-700 dark:text-indigo-300 text-sm transition-all"},[u(xl,{get class(){return`h-4 w-4 mr-1.5 ${w.loadingLocks.value?"animate-spin":""}`},[a]:{class:b(k=>`h-4 w-4 mr-1.5 ${k.loadingLocks.value?"animate-spin":""}`,[w],'`h-4 w-4 mr-1.5 ${p0.loadingLocks.value?"animate-spin":""}`')}},3,"3q_5")," Refrescar"],0,null),e("button",{onClick$:w.performUpkeep},{class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-emerald-100 hover:bg-emerald-200 dark:bg-emerald-900/50 dark:hover:bg-emerald-800/70 text-emerald-700 dark:text-emerald-300 text-sm transition-all"},[u(Xe,{class:"h-4 w-4 mr-1.5",[a]:{class:a}},3,"3q_6")," Ejecutar Pagos"],0,null)],1,null)],1,null),w.error.value&&e("div",null,{class:"mt-2 p-2 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg text-sm"},[u(ee,{class:"inline-block h-4 w-4 mr-1",[a]:{class:a}},3,"3q_7")," ",b(k=>k.error.value,[w],"p0.error.value")],1,"3q_8"),w.status.value&&e("div",null,{class:"mt-2 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg text-sm"},[u(Oe,{class:"inline-block h-4 w-4 mr-1",[a]:{class:a}},3,"3q_9")," ",b(k=>k.status.value,[w],"p0.status.value")],1,"3q_10"),(()=>{X();const k=f(1),D=f(10),ye=[...w.locks.value].slice().reverse(),re=Math.ceil(ye.length/D.value),me=ye.slice((k.value-1)*D.value,k.value*D.value);return e("div",null,{class:"mt-4 overflow-auto rounded-lg border border-slate-200 dark:border-slate-700/50"},[e("table",null,{class:"w-full bg-white dark:bg-slate-800/50 text-left text-sm"},[e("thead",null,{class:"bg-slate-50 dark:bg-slate-700/50"},e("tr",null,null,[e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"ID",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Factura",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Token",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Monto",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Fecha Liberación",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Time Remaining",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Estado",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Destinatarios",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Profesional",3,null),e("th",null,{class:"px-4 py-3 text-slate-600 dark:text-slate-300 font-semibold"},"Email",3,null)],3,null),3,null),e("tbody",null,{class:"divide-y divide-slate-200 dark:divide-slate-700/50"},w.loadingLocks.value?e("tr",null,null,e("td",null,{colSpan:8,class:"px-4 py-6 text-center text-slate-500 dark:text-slate-400"},[u(se,{class:"animate-spin h-6 w-6 mx-auto mb-2",[a]:{class:a}},3,"3q_11"),"Cargando locks..."],1,null),1,"3q_12"):me.length===0?e("tr",null,null,e("td",null,{colSpan:8,class:"px-4 py-6 text-center text-slate-500 dark:text-slate-400"},"No hay locks creados aún.",3,null),3,"3q_13"):me.map(M=>e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/30"},[e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},L(M,"id"),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},M.invoiceId!==void 0&&M.invoiceId!==null&&Number(M.invoiceId)!==0?e("span",null,{class:"font-mono"},String(M.invoiceId),1,"3q_14"):e("span",null,{class:"text-slate-400"},"-",3,null),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},[M.token.slice(0,6),"...",M.token.slice(-4)],1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},[(Number(M.totalAmount)/1e18).toFixed(4)," ETH"],1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},A(M.releaseTime),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},(()=>{const le=Math.floor(Date.now()/1e3),Z=Number(M.releaseTime)-le;if(M.released)return e("span",null,{class:"text-emerald-600 dark:text-emerald-300"},"-",3,"3q_15");if(Z<=0)return e("span",null,{class:"text-amber-600 dark:text-amber-300"},"Ready",3,"3q_16");const G=Math.floor(Z/86400),oe=Math.floor(Z%86400/3600),De=Math.floor(Z%3600/60),He=Z%60;return e("span",null,null,[G>0&&`${G}d `,oe>0&&`${oe}h `,De>0&&`${De}m `,He>0&&G===0&&oe===0&&De===0?`${He}s`:""],1,"3q_17")})(),1,null),e("td",null,{class:"px-4 py-3"},e("span",{class:`px-2 py-1 rounded-full text-xs font-medium ${M.released?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300"}`},null,M.released?"Liberado":"Pendiente",1,null),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},M.recipients.map((le,Z)=>e("div",null,{class:"text-xs"},[le.slice(0,6),"...",le.slice(-4)," (",M.amounts[Z].toString(),")"],1,Z)),1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},Array.isArray(M.recipients)&&M.recipients.length>0?M.recipients.map((le,Z)=>{const G=(r.value.professionals??[]).find(oe=>oe.wallet&&oe.wallet.toLowerCase()===le.toLowerCase());return e("div",null,{class:"text-xs"},G&&typeof G.name=="string"?G.name:String((G==null?void 0:G.name)??"-"),1,Z)}):"-",1,null),e("td",null,{class:"px-4 py-3 text-slate-700 dark:text-slate-300"},Array.isArray(M.recipients)&&M.recipients.length>0?M.recipients.map((le,Z)=>{const G=(r.value.professionals??[]).find(oe=>oe.wallet&&oe.wallet.toLowerCase()===le.toLowerCase());return e("div",null,{class:"text-xs"},G&&typeof G.email=="string"?G.email:String((G==null?void 0:G.email)??"-"),1,Z)}):"-",1,null)],1,M.id)),1,null)],1,null),e("div",null,{class:"flex justify-between items-center py-4 px-2"},[e("span",null,{class:"text-xs text-slate-500 dark:text-slate-400"},["Mostrando página ",b(M=>M.value,[k],"p0.value")," de ",re],1,null),e("div",null,{class:"flex gap-2"},[e("button",null,{class:"px-3 py-1 rounded bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium disabled:opacity-50",disabled:b(M=>M.value===1,[k],"p0.value===1"),onClick$:g("s_yEon4XCUfYw",[k])},"Anterior",3,null),e("button",{disabled:k.value>=re,onClick$:g("s_BTsFleKlXfQ",[k,re])},{class:"px-3 py-1 rounded bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 text-xs font-medium disabled:opacity-50"},"Siguiente",2,null)],1,null)],1,null)],1,"3q_18")})()],1,"3q_19"),e("div",null,{class:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ie.value.map(k=>e("div",null,{class:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-md p-5 flex flex-col gap-4 hover:shadow-lg transition-all duration-200"},[e("div",null,{class:"flex items-center gap-3"},[e("div",null,{class:"w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center text-teal-700 dark:text-teal-300 font-bold text-lg shrink-0"},k.name[0],1,null),e("div",null,{class:"flex-grow"},[e("div",null,{class:"font-bold text-slate-800 dark:text-slate-100 text-lg"},L(k,"name"),1,null),k.email&&e("div",null,{class:"text-xs text-slate-500 dark:text-slate-400 truncate"},L(k,"email"),1,"3q_20")],1,null),k.wallet&&e("span",{title:L(k,"wallet")},{class:"ml-auto px-2 py-1 text-xs rounded bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 shrink-0"},[k.wallet.slice(0,6),"...",k.wallet.slice(-4)],1,"3q_21")],1,null),e("div",null,null,[e("div",null,{class:"font-semibold text-xs text-slate-500 dark:text-slate-400 mb-1"},"Contratos Activos",3,null),e("div",null,{class:"flex flex-wrap gap-2"},[ue(k.id).length===0&&e("span",null,{class:"text-xs text-slate-400"},"Sin contratos",3,"3q_22"),ue(k.id).map(D=>e("span",{title:D.contract_url??""},{class:"px-2 py-1 rounded bg-slate-100 dark:bg-slate-700 text-xs text-slate-700 dark:text-slate-200"},[e("span",null,{class:"text-green-600 dark:text-green-400 font-semibold"},L(D,"status"),1,null)," ",e("span",null,null,["(",L(D,"start_date")," - ",D.end_date??"Presente",")"],1,null)],1,D.id))],1,null)],1,null),e("div",null,null,[e("div",null,{class:"font-semibold text-xs text-slate-500 dark:text-slate-400 mb-1"},"Facturas",3,null),e("div",null,{class:"flex flex-col gap-2"},[_(k.id).length===0&&e("span",null,{class:"text-xs text-slate-400"},"Sin facturas",3,"3q_23"),_(k.id).map(D=>{X();const ye=l.value.find(le=>le.facturaId===D.id);let re,me,M;return D.status==="paid"?(re="Pagado",me="bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",M=u(Oe,null,3,"3q_24")):ye?ye.released||(re="Pendiente",me="bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300",M=u(ee,null,3,"3q_25")):(re="Pendiente",me="bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300",M=u(ee,null,3,"3q_26")),e("div",null,{class:"flex items-center gap-2 bg-slate-50 dark:bg-slate-900/50 rounded-lg px-2 py-1.5"},[e("span",{class:`px-2 py-0.5 rounded text-xs font-semibold text-center min-w-[90px] inline-flex items-center justify-center gap-1 ${me}`},null,[M," ",re],1,null),e("span",{title:`Emitida: ${D.issue_date}${D.paid_date?" | Pagada: "+D.paid_date:""}`},{class:"text-xs text-slate-700 dark:text-slate-200 font-mono"},[L(D,"amount")," ",L(D,"currency")],1,null),e("div",null,{class:"ml-auto flex items-center gap-1"},[D.invoice_url?e("a",{href:`/api/invoices/view/${D.invoice_url}`},{target:"_blank",rel:"noopener noreferrer",class:"text-teal-500 hover:text-teal-400 text-sm",title:"Ver factura"},u(ce,null,3,"3q_27"),1,"3q_28"):null,e("button",{disabled:re!=="Pendiente",onClick$:g("s_VW70ImrmQW4",[D,J])},{class:"px-2 py-1 text-xs rounded bg-teal-500 text-white hover:bg-teal-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Automatizar pago"},"Automatizar",2,null)],1,null)],1,D.id)})],1,null)],1,null)],1,k.id)),1,null),c.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},e("div",null,{class:"flex items-center justify-center min-h-screen p-4 text-center"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick$:de},null,3,null),e("div",null,{class:"inline-block bg-white dark:bg-slate-800 rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-200/50 dark:border-slate-700/50 my-8 sm:max-w-md w-full"},e("div",null,{class:"p-6 sm:p-8"},[e("div",null,{class:"flex items-center gap-4 mb-6"},[e("div",null,{class:"w-12 h-12 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center text-teal-600 dark:text-teal-300 text-2xl shrink-0"},u(Ne,null,3,"3q_29"),1,null),e("div",null,null,[e("h2",null,{class:"text-xl font-bold text-slate-800 dark:text-slate-100",id:"modal-title"},"Automatizar pago",3,null),e("p",null,{class:"text-sm text-slate-500 dark:text-slate-400"},"Programar un Timelock para esta factura.",3,null)],3,null)],1,null),e("div",null,{class:"space-y-4"},[e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Token",3,null),e("select",null,{value:y,class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-teal-500",onInput$:g("s_ELKq3QjyadY",[y])},[e("option",null,{value:"USDC"},"USDC",3,null),e("option",null,{value:"USDT"},"USDT",3,null),e("option",null,{value:"DAI"},"DAI",3,null),e("option",null,{value:"KNRT"},"KNRT",3,null)],3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Wallet del profesional",3,null),e("input",null,{type:"text",value:S,placeholder:"0x...",class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-mono focus:outline-none focus:ring-2 focus:ring-teal-500",onInput$:g("s_Se2m5CYvyNk",[S])},null,3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Monto a transferir",3,null),e("input",null,{type:"number",min:"0",step:"any",value:N,class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-teal-500",onInput$:g("s_cDv1msy1boU",[N])},null,3,null)],3,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Fecha y Hora de Liberación",3,null),e("div",null,{class:"grid grid-cols-3 gap-2"},[e("input",null,{type:"date",value:U,class:"col-span-3 block w-full border border-slate-300 dark:border-slate-600 rounded-lg py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-teal-500",onInput$:g("s_jHJwhp2hmjg",[U])},null,3,null),e("select",null,{value:F,class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200",onInput$:g("s_odul3p2keAc",[F])},[e("option",null,{value:""},"Hora",3,null),Array.from({length:24},(k,D)=>e("option",{value:D},null,D.toString().padStart(2,"0"),1,D))],1,null),e("select",null,{value:$,class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200",onInput$:g("s_wKPTp48jC2g",[$])},[e("option",null,{value:""},"Min",3,null),e("option",null,{value:"0"},"00",3,null),e("option",null,{value:"15"},"15",3,null),e("option",null,{value:"30"},"30",3,null),e("option",null,{value:"45"},"45",3,null)],3,null)],1,null)],1,null),e("div",null,null,[e("label",null,{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},"Zona Horaria",3,null),e("select",null,{value:v,class:"block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-2 px-3 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-teal-500",onInput$:g("s_oi2aRktV3SQ",[v])},[e("option",null,{value:"UTC"},"UTC",3,null),e("option",null,{value:"America/Mexico_City"},"America/Mexico_City",3,null),e("option",null,{value:"America/Caracas"},"America/Caracas",3,null),e("option",null,{value:"America/New_York"},"America/New_York",3,null),e("option",null,{value:"Europe/Madrid"},"Europe/Madrid",3,null),e("option",null,{value:"America/Argentina/Buenos_Aires"},"America/Argentina/Buenos_Aires",3,null),e("option",null,{value:"America/Bogota"},"America/Bogota",3,null),e("option",null,{value:"America/Lima"},"America/Lima",3,null),e("option",null,{value:"America/Santiago"},"America/Santiago",3,null)],3,null)],3,null),e("div",null,{class:"mt-2 p-2 bg-slate-100 dark:bg-slate-700/50 rounded-lg text-xs space-y-1"},[e("p",null,{class:"text-slate-600 dark:text-slate-400"},[e("b",null,null,"Actual (UTC):",3,null)," ",z.value.toLocaleString("en-GB",{timeZone:"UTC"})],1,null),e("p",null,{class:"text-slate-600 dark:text-slate-400"},[e("b",null,null,["Liberación (",b(k=>k.value,[v],"p0.value"),"):"],3,null)," ",E.value.toLocaleString("en-GB",{timeZone:v.value})],1,null),e("p",null,{class:"text-slate-600 dark:text-slate-400"},[e("b",null,null,"Liberación (UTC):",3,null)," ",T.value.toLocaleString("en-GB",{timeZone:"UTC"})],1,null)],1,null)],1,null),e("div",null,{class:"mt-8 flex justify-end gap-3"},[e("button",null,{class:"px-5 py-2.5 rounded-lg bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-100 font-medium hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors",onClick$:de},"Cancelar",3,null),e("button",null,{class:"px-5 py-2.5 rounded-lg bg-gradient-to-r from-teal-500 to-teal-600 text-white font-semibold hover:from-teal-600 hover:to-teal-700 transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:b((k,D)=>!!k.value||D.status.value==="loading",[h,w],'!!p0.value||p1.status.value==="loading"'),onClick$:B},b(k=>k.status.value==="loading"?"Procesando...":"Automatizar",[w],'p0.status.value==="loading"?"Procesando...":"Automatizar"'),3,null)],3,null),w.status.value&&e("div",null,{class:"mt-4 text-green-700 dark:text-green-300 text-sm font-medium bg-green-50 dark:bg-green-900/30 rounded-lg p-3 text-center"},b(k=>k.status.value,[w],"p0.status.value"),3,"3q_30"),w.error.value&&e("div",null,{class:"mt-4 text-red-700 dark:text-red-300 text-sm font-medium bg-red-50 dark:bg-red-900/30 rounded-lg p-3 text-center"},b(k=>k.error.value,[w],"p0.error.value"),3,"3q_31"),h.value&&e("div",null,{class:"mt-4 text-red-700 dark:text-red-300 text-sm font-medium bg-red-50 dark:bg-red-900/30 rounded-lg p-3 text-center"},[u(ee,{class:"inline-block mr-2",[a]:{class:a}},3,"3q_32")," ",b(k=>k.value,[h],"p0.value")],1,"3q_33")],1,null),1,null)],1,null),1,"3q_34")],1,null),1,"3q_35")},Ha=Q(p(Ya,"s_0ONN1Cu1fDg")),Ga=Object.freeze(Object.defineProperty({__proto__:null,_auto_getTokenAddress:Ft,_auto_getYears:Ht,_auto_months:Yt,default:Ha,useAddSettlement:Ca,useAuthLoader:Ea,useAutomateInvoicePayment:qt,useDeleteSettlement:Ua,useLocksLoader:jt,usePaymentsLoader:Bt,useSettlementsLoader:$t,useUpdateSettlementStatus:Ma},Symbol.toStringTag,{value:"Module"})),za=async t=>{const l=await j(t);if(!(l!=null&&l.isAuthenticated)&&!(l!=null&&l.is_admin))throw t.redirect(302,"/auth");return l},Gt=Y(p(za,"s_BLJtw2HBn0Y")),Wa=async t=>{const l=O(t);try{return(await l.execute("SELECT id, username, name, role, email, active FROM users ORDER BY name ASC")).rows.map(n=>({...n,active:!!n.active}))}catch(s){return console.error("Error loading users:",s),[]}},zt=Y(p(Wa,"s_iX0RZbkDTAw")),Va=async(t,l)=>{var x;const s=await j(l);if(!s.isAuthenticated||!s.is_admin)return{success:!1,error:"Unauthorized"};const n=O(l),{id:r,username:i,name:o,role:d,email:m,password:c}=t;try{if(r){const h=[{key:"username",value:i},{key:"name",value:o},{key:"role",value:d},{key:"email",value:m}];c&&h.push({key:"password_hash",value:c});const w=h.map(v=>`${v.key} = ?`).join(", "),y=h.map(v=>v.value);y.push(String(r)),await n.execute({sql:`UPDATE users SET ${w} WHERE id = ?`,args:y})}else{const h=c;await n.execute({sql:"INSERT INTO users (username, name, role, email, password_hash, active) VALUES (?, ?, ?, ?, ?, ?)",args:[i??"",o??"",d??"viewer",m??"",h??"",!0]})}return{success:!0}}catch(h){return(x=h.message)!=null&&x.includes("UNIQUE constraint failed: users.username")?{success:!1,error:"Username already exists."}:(console.error(h),{success:!1,error:"Failed to save user."})}},Xa={id:I.coerce.number().optional(),username:I.string().min(3,"Username must be at least 3 characters."),name:I.string().min(2,"Name is required."),role:I.enum(["admin","manager","viewer"]),email:I.string().email("Invalid email address."),password:I.string().min(8,"Password must be at least 8 characters.").optional().or(I.literal(""))},Wt=q(p(Va,"s_a0o72IlKDPU"),te(p(Xa,"s_oYjGP9s7ZYM"))),Ka=async({id:t,active:l},s)=>{const n=await j(s);if(!(n!=null&&n.is_admin))return{success:!1,error:"Unauthorized"};const r=O(s);try{return await r.execute({sql:"UPDATE users SET active = ? WHERE id = ?",args:[!l,String(t)]}),{success:!0}}catch{return{success:!1,error:"Failed to update status."}}},Vt=q(p(Ka,"s_6EomhBuNxNI")),Qa=async({id:t},l)=>{const s=await j(l);if(!(s!=null&&s.is_admin))return{success:!1,error:"Unauthorized"};const n=O(l);try{return await n.execute({sql:"DELETE FROM users WHERE id = ?",args:[String(t)]}),{success:!0}}catch{return{success:!1,error:"Failed to delete user."}}},Xt=q(p(Qa,"s_1r9Y6zzr2R0")),Ja=t=>{const[l,s,n,r,i,o,d]=C();t?(s.value=t.id,n.value=t.name,o.value=t.username,l.value=t.email,i.value=t.role,r.value=""):(s.value=void 0,n.value="",o.value="",l.value="",i.value="viewer",r.value=""),d.value=!0},Za=()=>{var s;const[t,l]=C();(s=t.value)!=null&&s.success&&(l.value=!1)},en=()=>{var y,v,S,N,U,F,$,P,z;X(),Gt();const t=zt(),l=Wt(),s=Vt(),n=Xt(),r=f(!1),i=f(void 0),o=f(""),d=f(""),m=f(""),c=f("viewer"),x=f(""),h=p(Ja,"s_22z0CwgGRjQ",[m,i,o,x,c,d,r]),w=[{value:"admin",label:"Administrator"},{value:"manager",label:"Manager"},{value:"viewer",label:"Viewer"}];return e("main",null,{class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900"},[e("div",null,{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},[e("header",null,{class:"mb-8 bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700 rounded-xl shadow-sm p-6"},e("div",null,{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[e("div",null,{class:"flex items-center"},[u(ge,{class:"h-8 w-8 text-teal-600 dark:text-teal-500 mr-3",[a]:{class:a}},3,"pv_0"),e("div",null,null,[e("h1",null,{class:"text-2xl sm:text-3xl font-bold text-slate-800 dark:text-slate-100"},"User Administration",3,null),e("p",null,{class:"text-slate-500 dark:text-slate-400 mt-1"},"Manage users and their permissions",3,null)],3,null)],1,null),e("button",null,{class:"mt-4 sm:mt-0 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200",onClick$:g("s_97298IyYAwg",[h])},[u(Ce,{class:"mr-2 h-4 w-4",[a]:{class:a}},3,"pv_1"),"Add User"],1,null)],1,null),1,null),e("div",null,{class:"bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700"},e("div",null,{class:"overflow-x-auto"},e("table",null,{class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},[e("thead",null,{class:"bg-gradient-to-r from-slate-100 to-slate-50 dark:from-slate-800 dark:to-slate-700"},e("tr",null,null,[e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"User",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Role",3,null),e("th",null,{class:"px-6 py-4 text-left text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Status",3,null),e("th",null,{class:"px-6 py-4 text-right text-xs font-medium text-slate-600 dark:text-slate-300 uppercase tracking-wider"},"Actions",3,null)],3,null),3,null),e("tbody",null,{class:"bg-white dark:bg-slate-800 divide-y divide-slate-200 dark:divide-slate-700"},t.value.map(E=>X(e("tr",null,{class:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-all duration-200 group"},[e("td",null,{class:"px-6 py-4 whitespace-nowrap"},[e("div",null,{class:"text-sm font-medium text-slate-800 dark:text-slate-100"},L(E,"name"),1,null),e("div",null,{class:"text-sm text-slate-500 dark:text-slate-400"},L(E,"email"),1,null)],1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-sm text-slate-600 dark:text-slate-300"},L(E,"role"),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap"},e("span",{class:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${E.active?"bg-gradient-to-r from-emerald-50 to-emerald-100 text-emerald-700 dark:from-emerald-900/30 dark:to-emerald-800/30 dark:text-emerald-400":"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-600 dark:from-slate-700 dark:to-slate-600 dark:text-slate-300"}`},null,E.active?"Active":"Inactive",1,null),1,null),e("td",null,{class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},e("div",null,{class:"flex justify-end space-x-2"},[e("button",{onClick$:g("s_O4CvBodU74s",[h,E])},{class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 rounded-full transition-all",title:"Edit User"},u(Pe,{class:"h-5 w-5",[a]:{class:a}},3,"pv_2"),0,null),u(K,{action:s,children:[e("input",{value:L(E,"id")},{type:"hidden",name:"id"},null,3,null),e("input",{value:E.active?"true":"false"},{type:"hidden",name:"active"},null,3,null),e("button",{class:`p-1.5 rounded-full transition-all ${E.active?"text-slate-600 dark:text-slate-400 hover:text-yellow-600 hover:bg-yellow-50 dark:hover:text-yellow-400 dark:hover:bg-yellow-900/20":"text-slate-600 dark:text-slate-400 hover:text-green-600 hover:bg-green-50 dark:hover:text-green-400 dark:hover:bg-green-900/20"}`,title:E.active?"Deactivate":"Activate"},{type:"submit"},E.active?u(hl,{class:"h-5 w-5",[a]:{class:a}},3,"pv_3"):u(gl,{class:"h-5 w-5",[a]:{class:a}},3,"pv_4"),1,null)],[a]:{action:a}},1,"pv_5"),u(K,{action:n,children:[e("input",{value:L(E,"id")},{type:"hidden",name:"id"},null,3,null),e("button",null,{type:"submit",class:"p-1.5 text-slate-600 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:text-red-400 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Delete User"},u(ve,{class:"h-5 w-5",[a]:{class:a}},3,"pv_6"),1,null)],[a]:{action:a}},1,"pv_7")],1,null),1,null)],1,E.id))),1,null)],1,null),1,null),1,null)],1,null),r.value&&e("div",null,{class:"fixed inset-0 z-50 overflow-y-auto"},e("div",null,{class:"flex items-end sm:items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},[e("div",null,{class:"fixed inset-0 bg-slate-700/70 dark:bg-slate-900/80 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick$:g("s_0VJKs3Cj51k",[r])},null,3,null),e("div",null,{class:"inline-block align-bottom bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-xl text-left overflow-hidden shadow-2xl transform transition-all border border-slate-100/50 dark:border-slate-700/50 sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},u(K,{action:l,onSubmitCompleted$:p(Za,"s_uctbYNgi4OY",[l,r]),children:[e("div",null,{class:"px-6 pt-5 pb-4 sm:p-6 sm:pb-4"},[e("h3",null,{class:"text-xl leading-6 font-medium text-slate-800 dark:text-slate-100"},[b(E=>E.value?"Edit":"Add",[i],'p0.value?"Edit":"Add"')," User"],3,null),e("input",null,{type:"hidden",name:"id",value:b(E=>E.value,[i],"p0.value")},null,3,null),e("div",null,{class:"mt-4 space-y-4"},[e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Full Name",3,null),e("input",null,{type:"text",name:"name",id:"name",value:o,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:g("s_oN0ORdmSBQk",[o])},null,3,null),((v=(y=l.value)==null?void 0:y.fieldErrors)==null?void 0:v.name)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(E=>E.value.fieldErrors.name,[l],"p0.value.fieldErrors.name"),3,"pv_8")],1,null),e("div",null,null,[e("label",null,{for:"username",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Username",3,null),e("input",null,{type:"text",name:"username",id:"username",value:d,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:g("s_s0IUkW8ve40",[d])},null,3,null),((N=(S=l.value)==null?void 0:S.fieldErrors)==null?void 0:N.username)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(E=>E.value.fieldErrors.username,[l],"p0.value.fieldErrors.username"),3,"pv_9")],1,null)],1,null),e("div",null,null,[e("label",null,{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Email",3,null),e("input",null,{type:"email",name:"email",id:"email",value:m,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:g("s_n0pakWINAc8",[m])},null,3,null),((F=(U=l.value)==null?void 0:U.fieldErrors)==null?void 0:F.email)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(E=>E.value.fieldErrors.email,[l],"p0.value.fieldErrors.email"),3,"pv_10")],1,null),e("div",null,{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},[e("div",null,null,[e("label",null,{for:"role",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Role",3,null),e("select",null,{name:"role",id:"role",value:c,class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:g("s_dia70tVBw94",[c])},w.map(E=>e("option",{value:L(E,"value")},null,E.label,1,E.value)),1,null)],1,null),e("div",null,null,[e("label",null,{for:"password",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},"Password",3,null),e("input",null,{type:"password",name:"password",id:"password",value:x,placeholder:b(E=>E.value?"Leave blank to keep current":"",[i],'p0.value?"Leave blank to keep current":""'),class:"mt-1 block w-full border border-slate-300 dark:border-slate-600 rounded-lg shadow-sm py-3 px-3 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm",onInput$:g("s_Xj20SVtNgHs",[x])},null,3,null),((P=($=l.value)==null?void 0:$.fieldErrors)==null?void 0:P.password)&&e("p",null,{class:"text-red-500 text-sm mt-1"},b(E=>E.value.fieldErrors.password,[l],"p0.value.fieldErrors.password"),3,"pv_11")],1,null)],1,null)],1,null)],1,null),e("div",null,{class:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-700 dark:to-slate-800 px-6 py-4 sm:flex sm:flex-row-reverse"},[e("button",null,{type:"submit",disabled:b(E=>E.isRunning,[l],"p0.isRunning"),class:"w-full inline-flex justify-center items-center rounded-lg border border-transparent shadow-sm px-5 py-2.5 bg-gradient-to-r from-teal-500 to-teal-600 text-base font-medium text-white hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200 disabled:opacity-50"},[l.isRunning?u(se,{class:"animate-spin h-5 w-5 mr-2",[a]:{class:a}},3,"pv_12"):u(ke,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"pv_13"),"Save User"],1,null),e("button",null,{type:"button",class:"mt-3 w-full inline-flex justify-center items-center rounded-lg border border-slate-200 dark:border-slate-600 shadow-sm px-5 py-2.5 bg-white dark:bg-slate-800 text-base font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-all duration-200",onClick$:g("s_iD3Bt7nAzVc",[r])},[u(fe,{class:"h-5 w-5 mr-2",[a]:{class:a}},3,"pv_14"),"Cancel"],1,null)],1,null),((z=l.value)==null?void 0:z.success)===!1&&e("div",null,{class:"p-4 bg-red-100 text-red-800 rounded-b-lg"},[u(ee,{class:"inline h-5 w-5 mr-2",[a]:{class:a}},3,"pv_15"),b(E=>E.value.error,[l],"p0.value.error")],1,"pv_16")],[a]:{action:a,onSubmitCompleted$:a}},1,"pv_17"),1,null)],1,null),1,"pv_18")],1,"pv_19")},tn=Q(p(en,"s_bCkyk2JlVAo")),ln=Object.freeze(Object.defineProperty({__proto__:null,default:tn,useAuthLoader:Gt,useDeleteUser:Xt,useSaveUser:Wt,useToggleUserStatus:Vt,useUsersLoader:zt},Symbol.toStringTag,{value:"Module"})),sn=[],Qe=()=>sl,V=()=>Nl,an=[["/",[V,()=>jl],"/",["q-BRbL6PPm.js","q-BiTp0c6_.js"]],["api/contracts/view/[fileName]/",[V,()=>$l],"/api/contracts/view/[fileName]/",["q-BRbL6PPm.js"]],["api/invoices/view/[fileName]/",[V,()=>Hl],"/api/invoices/view/[fileName]/",["q-BRbL6PPm.js"]],["api/upload-contract/",[V,()=>zl],"/api/upload-contract/",["q-BRbL6PPm.js"]],["api/upload-image/",[V,()=>Vl],"/api/upload-image/",["q-BRbL6PPm.js"]],["api/upload-invoice/",[V,()=>Kl],"/api/upload-invoice/",["q-BRbL6PPm.js"]],["auth/logout/",[V,Qe,()=>ts],"/auth/logout/",["q-BRbL6PPm.js","q-DlnsQqOJ.js","q-CCLTOtK3.js"]],["auth/",[V,Qe,()=>ps],"/auth/",["q-BRbL6PPm.js","q-DlnsQqOJ.js","q-B7W7Yrvq.js"]],["contracts/",[V,()=>Es],"/contracts/",["q-BRbL6PPm.js","q-CUguUPhS.js"]],["invoices/",[V,()=>$s],"/invoices/",["q-BRbL6PPm.js","q-EE_-yS2O.js"]],["planner/",[V,()=>zs],"/planner/",["q-BRbL6PPm.js","q-BOY12so0.js"]],["professionals/",[V,()=>ua],"/professionals/",["q-BRbL6PPm.js","q-bnxEqV-g.js"]],["settings/",[V,()=>ga],"/settings/",["q-BRbL6PPm.js","q-Oz6lY45s.js"]],["settlements/",[V,()=>Ga],"/settlements/",["q-BRbL6PPm.js","q-BshC3787.js"]],["user-admin/",[V,()=>ln],"/user-admin/",["q-BRbL6PPm.js","q-B1XK0WNJ.js"]]],nn=[],rn=!0,on="/",un=!0,kn={routes:an,serverPlugins:sn,menus:nn,trailingSlash:rn,basePathname:on,cacheModules:un};export{on as basePathname,un as cacheModules,kn as default,nn as menus,an as routes,sn as serverPlugins,rn as trailingSlash};
